[{"_path":"/posts/wire-hole","_dir":"posts","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"Wireguard, pihole, unbound | предотвращаем утечку dns","description":"Смотри видео с детальной настройкой youtube.com.","date":"2022-12-17T00:00:00.000Z","type":"post","tags":["vpn","network"],"body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Смотри видео с детальной настройкой "},{"type":"element","tag":"a","props":{"href":"https://www.youtube.com/watch?v=iTozi7KE904","rel":["nofollow"]},"children":[{"type":"text","value":"youtube.com"}]},{"type":"text","value":"."}]},{"type":"element","tag":"code","props":{"code":"45.138.72.135\nroot\n747AuBOZ7WNt\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"45.138.72.135\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"root\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"747AuBOZ7WNt"}]}]}]}]}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"unbound"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"wireguard"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"pihole"}]}]},{"type":"element","tag":"code","props":{"code":"apt install wg...\n\n\nwget https://raw.githubusercontent.com/burghardt/easy-wg-quick/master/easy-wg-quick\nchmod +x easy-wg-quick\n./easy-wg-quick\n\nsudo cp wghub.conf /etc/wireguard/wghub.conf\nsudo systemctl enable --now wg-quick@wghub\n\n# new client\n./easy-wg-quick bla\nsudo cp -r wghub.conf /etc/wireguard/wghub.conf\nsudo systemctl restart wg-quick@wghub\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"apt"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"install"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"wg...\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"wget"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"https://raw.githubusercontent.com/burghardt/easy-wg-quick/master/easy-wg-quick\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"chmod"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"+x"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"easy-wg-quick\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"/easy-wg-quick\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"cp"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"wghub.conf"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"/etc/wireguard/wghub.conf\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"systemctl"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"enable"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"--now"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"wg-quick@wghub\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# new client\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"/easy-wg-quick"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"bla\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"cp"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"-r"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"wghub.conf"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"/etc/wireguard/wghub.conf\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"systemctl"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"restart"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"wg-quick@wghub"}]}]}]}]}]},{"type":"element","tag":"code","props":{"code":"sudo wg-quick down ./wghub.conf # if already configured\nsudo wg-quick up ./wghub.conf\nsudo wg show\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"wg-quick"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"down"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"./wghub.conf"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# if already configured\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"wg-quick"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"up"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"./wghub.conf\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"wg"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"show"}]}]}]}]}]},{"type":"element","tag":"code","props":{"code":"# sudo nano /etc/sysctl.conf\n\nnet.core.default_qdisc = fq\nnet.ipv4.tcp_congestion_control = bbr\nnet.ipv4.ip_forward = 1\nnet.ipv4.conf.default.rp_filter = 1\nnet.ipv4.conf.all.rp_filter = 1\nnet.ipv4.tcp_syncookies = 1\n\n# sudo sysctl -p\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# sudo nano /etc/sysctl.conf\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"net.core.default_qdisc"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"fq\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"net.ipv4.tcp_congestion_control"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"bbr\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"net.ipv4.ip_forward"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"1\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"net.ipv4.conf.default.rp_filter"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"1\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"net.ipv4.conf.all.rp_filter"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"1\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"net.ipv4.tcp_syncookies"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"1\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# sudo sysctl -p"}]}]}]}]}]},{"type":"element","tag":"code","props":{"code":"sudo cat /etc/wireguard/wghub.conf\n# open port\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"cat"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"/etc/wireguard/wghub.conf\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# open port"}]}]}]}]}]},{"type":"element","tag":"code","props":{"code":"curl -o /var/lib/unbound/root.hints https://www.internic.net/domain/named.cache\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"curl"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"-o"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"/var/lib/unbound/root.hints"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"https://www.internic.net/domain/named.cache"}]}]}]}]}]},{"type":"element","tag":"code","props":{"code":"# mv access-control: 10.134.99.0/24 > wg network | ip a\n# sudo nano /etc/unbound/unbound.conf.d/pi-hole.conf\n\nserver:\n    # if no logfile is specified, syslog is used\n    # logfile: \"/var/log/unbound/unbound.log\"\n    verbosity: 1\n    port: 5353\n\n    do-ip4: yes\n    do-udp: yes\n    do-tcp: yes\n\n    # may be set to yes if you have IPv6 connectivity\n    do-ip6: no\n\n    # use this only when you downloaded the list of primary root servers\n    root-hints: \"/var/lib/unbound/root.hints\"\n\n    # respond to DNS requests on all interfaces\n    interface: 0.0.0.0\n    max-udp-size: 3072\n\n    # IPs authorised to access the DNS Server\n    access-control: 0.0.0.0/0                 refuse\n    access-control: 127.0.0.1                 allow\n    access-control: 10.134.99.0/24            allow\n\n    # hide DNS Server info\n    hide-identity: yes\n    hide-version: yes\n\n    # limit DNS fraud and use DNSSEC\n    harden-glue: yes\n    harden-dnssec-stripped: yes\n    harden-referral-path: yes\n\n    # add an unwanted reply threshold to clean the cache and avoid, when possible, DNS poisoning\n    unwanted-reply-threshold: 10000000\n\n    # have the validator print validation failures to the log val-log-level: 1\n    # don't use Capitalisation randomisation as it known to cause DNSSEC issues sometimes\n    # see https://discourse.pi-hole.net/t/unbound-stubby-or-dnscrypt-proxy/9378 for further details\n    use-caps-for-id: no\n\n    # reduce EDNS reassembly buffer size\n    # suggested by the unbound man page to reduce fragmentation reassembly problems\n    edns-buffer-size: 1472\n\n    # TTL bounds for cache\n    cache-min-ttl: 3600\n    cache-max-ttl: 86400\n\n    # perform prefetching of close to expired message cache entries\n    # this only applies to domains that have been frequently queried\n    prefetch: yes\n    prefetch-key: yes\n    # one thread should be sufficient, can be increased on beefy machines\n    num-threads: 1\n    # ensure kernel buffer is large enough to not lose messages in traffic spikes\n    so-rcvbuf: 1m\n\n    # ensure privacy of local IP ranges\n    private-address: 192.168.0.0/16\n    private-address: 169.254.0.0/16\n    private-address: 172.16.0.0/12\n    private-address: 10.0.0.0/8\n    private-address: fd00::/8\n    private-address: fe80::/10\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# mv access-control: 10.134.99.0/24 > wg network | ip a\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# sudo nano /etc/unbound/unbound.conf.d/pi-hole.conf\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"server:\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# if no logfile is specified, syslog is used\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# logfile: \"/var/log/unbound/unbound.log\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"verbosity:"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"1\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"port:"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"5353\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    do-ip4: yes\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    do-udp: yes\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    do-tcp: yes\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# may be set to yes if you have IPv6 connectivity\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    do-ip6: no\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# use this only when you downloaded the list of primary root servers\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"root-hints:"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"\"/var/lib/unbound/root.hints\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# respond to DNS requests on all interfaces\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"interface:"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"0.0.0.0\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"max-udp-size:"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"3072\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":24},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# IPs authorised to access the DNS Server\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":25},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"access-control:"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"0.0.0.0/"}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"                 "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"refuse\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":26},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"access-control:"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"127.0.0.1"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"                 "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"allow\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":27},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"access-control:"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"10.134.99.0/"}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"24"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"allow\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":28},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":29},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# hide DNS Server info\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":30},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"hide-identity:"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"yes\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":31},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"hide-version:"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"yes\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":32},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":33},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# limit DNS fraud and use DNSSEC\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":34},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"harden-glue:"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"yes\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":35},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"harden-dnssec-stripped:"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"yes\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":36},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"harden-referral-path:"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"yes\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":37},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":38},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# add an unwanted reply threshold to clean the cache and avoid, when possible, DNS poisoning\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":39},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"unwanted-reply-threshold:"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"10000000\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":40},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":41},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# have the validator print validation failures to the log val-log-level: 1\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":42},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# don't use Capitalisation randomisation as it known to cause DNSSEC issues sometimes\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":43},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# see https://discourse.pi-hole.net/t/unbound-stubby-or-dnscrypt-proxy/9378 for further details\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":44},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"use-caps-for-id:"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"no\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":45},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":46},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# reduce EDNS reassembly buffer size\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":47},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# suggested by the unbound man page to reduce fragmentation reassembly problems\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":48},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"edns-buffer-size:"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"1472\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":49},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":50},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# TTL bounds for cache\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":51},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"cache-min-ttl:"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"3600\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":52},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"cache-max-ttl:"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"86400\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":53},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":54},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# perform prefetching of close to expired message cache entries\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":55},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# this only applies to domains that have been frequently queried\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":56},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"prefetch:"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"yes\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":57},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"prefetch-key:"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"yes\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":58},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# one thread should be sufficient, can be increased on beefy machines\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":59},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"num-threads:"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"1\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":60},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# ensure kernel buffer is large enough to not lose messages in traffic spikes\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":61},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"so-rcvbuf:"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"1m\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":62},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":63},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# ensure privacy of local IP ranges\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":64},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"private-address:"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"192.168.0.0/"}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"16\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":65},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"private-address:"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"169.254.0.0/"}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"16\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":66},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"private-address:"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"172.16.0.0/"}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"12\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":67},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"private-address:"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"10.0.0.0/"}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"8\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":68},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"private-address:"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"fd00::/"}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"8\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":69},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"private-address:"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"fe80::/"}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"10"}]}]}]}]}]},{"type":"element","tag":"code","props":{"code":"sudo systemctl enable --now unbound\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"systemctl"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"enable"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"--now"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"unbound"}]}]}]}]}]},{"type":"element","tag":"code","props":{"code":"# intfs  wghub\ncurl -sSL https://install.pi-hole.net | bash\n\nhttp://ip/admin\n\n# Settings - DNS наш Unbound 127.0.0.1#5353\n\n# open port 5353\ndig pi-hole.net @127.0.0.1 -p 5353  # NOERROR\ndig sigok.verteiltesysteme.net @127.0.0.1 -p 5353\ndig sigfail.verteiltesysteme.net @127.0.0.1 -p 5353  # SERFAIL\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# intfs  wghub\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"curl"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"-sSL"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"https://install.pi-hole.net"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-fdd1fa"},"children":[{"type":"text","value":"|"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"bash\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"http://ip/admin\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# Settings - DNS наш Unbound 127.0.0.1#5353\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# open port 5353\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"dig"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"pi-hole.net"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"@127.0.0.1"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"-p"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"5353"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# NOERROR\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"dig"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"sigok.verteiltesysteme.net"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"@127.0.0.1"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"-p"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"5353\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"dig"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"sigfail.verteiltesysteme.net"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"@127.0.0.1"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"-p"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"5353"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# SERFAIL"}]}]}]}]}]},{"type":"element","tag":"code","props":{"code":"# wg client conf dns > wghub | ip a\n# wg\nnano intnetdns.txt\n\n# replace ip 1.1.1.1 default > wghub ip : 10.148.135.1\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# wg client conf dns > wghub | ip a\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# wg\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"nano"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"intnetdns.txt\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# replace ip 1.1.1.1 default > wghub ip : 10.148.135.1"}]}]}]}]}]},{"type":"element","tag":"code","props":{"code":"# dns wghub ip : 10.148.135.1\n\n# 10: 10 > wgclient_10.conf\n[Interface]\nAddress = 10.148.135.10/24\nDNS = 10.148.135.1\nPrivateKey = oBj9b47cvZaGaCdHQUl1tu6in6L4yoL8hXxUd1EpU1c=\nMTU = 1280\n\n[Peer]\nPublicKey = G7VcOHBqXYFPppKNUZ25RJLjEXEDq+Gsn/jmczX5HB0=\nPresharedKey = LDgByqF8J/TgBI9vE+17aRNWnlJwQoD6i6xZCbwbdBk=\nAllowedIPs = 0.0.0.0/0, ::/0\nEndpoint = 45.138.72.135:44828\nPersistentKeepalive = 25\n\n# open ports\nufw allow ssh\nufw allow 44828/udp\n\n# net\nufw allow 80/tcp\nufw allow 53/udp\n\n# wg\nsudo ufw allow from 10.134.99.0/24 to any port 80\nsudo ufw allow from 10.134.99.0/24 to any port 53\nsudo ufw reject https\n\nss -tulpn\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# dns wghub ip : 10.148.135.1\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# 10: 10 > wgclient_10.conf\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"[Interface]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"Address"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"10.148.135.10/"}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"24\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"DNS"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"10.148.135.1\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"PrivateKey"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"oBj9b47cvZaGaCdHQUl1tu6in6L4yoL8hXxUd1EpU1c=\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"MTU"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"1280\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":"[Peer]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"PublicKey"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"G7VcOHBqXYFPppKNUZ25RJLjEXEDq+Gsn/jmczX5HB0=\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"PresharedKey"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"LDgByqF8J/TgBI9vE+17aRNWnlJwQoD6i6xZCbwbdBk=\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"AllowedIPs"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"0.0.0.0/"}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"::/"}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"0\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"Endpoint"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"45.138.72.135:"}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"44828\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"PersistentKeepalive"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"25\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# open ports\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"ufw"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"allow"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"ssh\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"ufw"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"allow"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"44828"}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"/udp\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# net\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"ufw"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"allow"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"80"}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"/tcp\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"ufw"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"allow"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"53"}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"/udp\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":24},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":25},"children":[{"type":"element","tag":"span","props":{"class":"ct-311923"},"children":[{"type":"text","value":"# wg\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":26},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"ufw"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"allow"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"10.134.99.0/"}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"24"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"to"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"any"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"port"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"80\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":27},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"ufw"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"allow"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"10.134.99.0/"}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"24"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"to"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"any"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"port"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"53\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":28},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"ufw"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"reject"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22dbaa"},"children":[{"type":"text","value":"https\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":29},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":30},"children":[{"type":"element","tag":"span","props":{"class":"ct-a3d0ba"},"children":[{"type":"text","value":"ss"}]},{"type":"element","tag":"span","props":{"class":"ct-e09d45"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ca528e"},"children":[{"type":"text","value":"-tulpn"}]}]}]}]}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"45.138.72.135/admin"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"http://pi.hole/admin","rel":["nofollow"]},"children":[{"type":"text","value":"http://pi.hole/admin"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://dnsleak.com","rel":["nofollow"]},"children":[{"type":"text","value":"https://dnsleak.com"}]}]}]},{"type":"element","tag":"style","children":[{"type":"text","value":".ct-fdd1fa{color:#FF7B72}\n.ct-311923{color:#8B949E}\n.ct-ca528e{color:#79C0FF}\n.ct-22dbaa{color:#A5D6FF}\n.ct-a3d0ba{color:#FFA657}\n.ct-e09d45{color:#C9D1D9}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[]}},"_type":"markdown","_id":"content:posts:wire-hole.md","_source":"content","_file":"posts/wire-hole.md","_extension":"md"},{"_path":"/posts/tor","_dir":"posts","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"Tor проксирование","description":"Задача заставить локально обрабатывать все запросы к onion, через тор, а все остальное в обычном режиме. В этом деле поможет dnsmasq, но заставить его работать я смог только с dhcpcd, не знаю возможно ли это сделать через networkmanager, не пользуюсь им. Выключаем и удаляем все сетевое, ставим dnsmasq и dhcpcd.","date":"2022-05-26T00:00:00.000Z","type":"post","tags":["network"],"body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Задача заставить локально обрабатывать все запросы к onion, через тор, а все остальное в обычном режиме. В этом деле поможет dnsmasq, но заставить его работать я смог только с dhcpcd, не знаю возможно ли это сделать через networkmanager, не пользуюсь им. Выключаем и удаляем все сетевое, ставим dnsmasq и dhcpcd."}]},{"type":"element","tag":"code","props":{"code":"sudo pacman -S dnsmasq dhcpcd tor\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-8ad5c6"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"pacman"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"-S"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"dnsmasq"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"dhcpcd"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"tor"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Конфиг dnsmasq."}]},{"type":"element","tag":"code","props":{"code":"# /etc/dnsmasq.conf\n\nno-resolv\nno-hosts\nport=53\nserver=127.0.0.1#9053\nlisten-address=::1,127.0.0.1\nserver=/onion/127.0.0.1#9053\nserver=/.exit/127.0.0.1#9053\nserver=8.8.8.8\nserver=8.8.4.4\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-aac03b"},"children":[{"type":"text","value":"# /etc/dnsmasq.conf\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-8ad5c6"},"children":[{"type":"text","value":"no-resolv\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-8ad5c6"},"children":[{"type":"text","value":"no-hosts\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":"port"}]},{"type":"element","tag":"span","props":{"class":"ct-135aba"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"53\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":"server"}]},{"type":"element","tag":"span","props":{"class":"ct-135aba"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"127.0.0.1#"}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"9053\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"class":"ct-8ad5c6"},"children":[{"type":"text","value":"listen-address="}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-8ad5c6"},"children":[{"type":"text","value":":1,127.0.0.1\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":"server"}]},{"type":"element","tag":"span","props":{"class":"ct-135aba"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"/onion/127.0.0.1#"}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"9053\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":"server"}]},{"type":"element","tag":"span","props":{"class":"ct-135aba"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"/.exit/127.0.0.1#"}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"9053\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":"server"}]},{"type":"element","tag":"span","props":{"class":"ct-135aba"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"8.8.8.8\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":"server"}]},{"type":"element","tag":"span","props":{"class":"ct-135aba"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"8.8.4.4"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Конфиг dhcpcd."}]},{"type":"element","tag":"code","props":{"code":"# /etc/dhcpcd.conf\n\nnohook resolv.conf\nnoarp\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-aac03b"},"children":[{"type":"text","value":"# /etc/dhcpcd.conf\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-8ad5c6"},"children":[{"type":"text","value":"nohook"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"resolv.conf\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-8ad5c6"},"children":[{"type":"text","value":"noarp"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Конфиг tor. tor_resolv походу не обязательно."}]},{"type":"element","tag":"code","props":{"code":"# /etc/tor/torrc\n\nVirtualAddrNetwork 10.254.0.0/16\nAutomapHostsOnResolve 1\nAutomapHostsSuffixes .exit,.onion\nTransPort 127.0.0.1:9040 NoIsolateClientAddr SessionGroup=1\nDNSPort 127.0.0.1:9053\nServerDNSResolvConfFile /etc/tor_resolv.conf\n\n# /etc/tor_resolv.conf\n\nnameserver 8.8.8.8\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-aac03b"},"children":[{"type":"text","value":"# /etc/tor/torrc\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-8ad5c6"},"children":[{"type":"text","value":"VirtualAddrNetwork"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"10.254.0.0/"}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"16\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-8ad5c6"},"children":[{"type":"text","value":"AutomapHostsOnResolve"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"1\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-8ad5c6"},"children":[{"type":"text","value":"AutomapHostsSuffixes"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":".exit,.onion\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-8ad5c6"},"children":[{"type":"text","value":"TransPort"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"127.0.0.1:"}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"9040"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"NoIsolateClientAddr"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"SessionGroup="}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"1\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"class":"ct-8ad5c6"},"children":[{"type":"text","value":"DNSPort"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"127.0.0.1:"}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"9053\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"class":"ct-8ad5c6"},"children":[{"type":"text","value":"ServerDNSResolvConfFile"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"/etc/tor_resolv.conf\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"class":"ct-aac03b"},"children":[{"type":"text","value":"# /etc/tor_resolv.conf\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"class":"ct-8ad5c6"},"children":[{"type":"text","value":"nameserver"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"8.8.8.8"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Выключам, включаем и стартуем службы."}]},{"type":"element","tag":"code","props":{"code":"sudo systemctl disable --now systemd-networkd.socket\nsudo systemctl disable --now systemd-networkd\nsudo systemctl disable --now systemd-resolved\n\nsudo systemctl enable --now dhcpcd\nsudo systemctl enable --now dnsmasq\nsudo systemctl start tor\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-8ad5c6"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"systemctl"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"disable"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"--now"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"systemd-networkd.socket\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-8ad5c6"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"systemctl"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"disable"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"--now"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"systemd-networkd\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-8ad5c6"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"systemctl"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"disable"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"--now"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"systemd-resolved\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-8ad5c6"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"systemctl"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"enable"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"--now"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"dhcpcd\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-8ad5c6"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"systemctl"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"enable"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"--now"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"dnsmasq\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"class":"ct-8ad5c6"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"systemctl"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"start"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"tor"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Правила перенаправления запросов onion в тор мост."}]},{"type":"element","tag":"code","props":{"code":"# ip route show default | awk '/default/ {print $5}'\n\nsudo iptables -t nat -A PREROUTING -d 10.254.0.0/16 -i enp5s0 -p tcp -j REDIRECT --to-ports 9040\nsudo iptables -t nat -A OUTPUT -d 10.254.0.0/16 -p tcp -j REDIRECT --to-ports 9040\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-aac03b"},"children":[{"type":"text","value":"# ip route show default | awk '/default/ {print $5}'\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-8ad5c6"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"iptables"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"-t"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"nat"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"-A"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"PREROUTING"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"-d"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"10.254.0.0/"}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"16"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"-i"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"enp5s0"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"-p"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"tcp"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"-j"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"REDIRECT"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"--to-ports"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"9040\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-8ad5c6"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"iptables"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"-t"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"nat"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"-A"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"OUTPUT"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"-d"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"10.254.0.0/"}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"16"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"-p"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"tcp"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"-j"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"REDIRECT"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"--to-ports"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"9040"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Выключить запрет в firefox. В адресной строке откройте адрес about:config и выключить значение."}]},{"type":"element","tag":"code","props":{"code":"network.dns.blockDotOnion     false\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-8ad5c6"},"children":[{"type":"text","value":"network.dns.blockDotOnion"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":"     "}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"false"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Для теста onion keybase."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"http://keybase5wmilwokqirssclfnsqrjdsi7jdir5wy7y7iu3tanwmtp6oid.onion","rel":["nofollow"]},"children":[{"type":"text","value":"keybase5wmilwo"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Если все нормально, то можно выгрузить правила iptables в любое удобное место, я сохраню рядом с дефолтом."}]},{"type":"element","tag":"code","props":{"code":"# /etc/iptables/iptables.rules\n\nsudo iptables-save -f /etc/iptables/iptables.rules.tor\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-aac03b"},"children":[{"type":"text","value":"# /etc/iptables/iptables.rules\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-8ad5c6"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"iptables-save"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"-f"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"/etc/iptables/iptables.rules.tor"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Если нужны эти правила постоянно, то просто перетрите /etc/iptables/iptables.rules, но перед этим создайте копию."}]},{"type":"element","tag":"code","props":{"code":"sudo cp /etc/iptables/iptables.rules /etc/iptables/iptables.rules.bak\nsudo iptables-save -f /etc/iptables/iptables.rules\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-8ad5c6"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"cp"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"/etc/iptables/iptables.rules"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"/etc/iptables/iptables.rules.bak\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-8ad5c6"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"iptables-save"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"-f"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"/etc/iptables/iptables.rules"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Считывание правил с файла."}]},{"type":"element","tag":"code","props":{"code":"sudo iptables-restore /etc/iptables/iptables.rules.bak\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-8ad5c6"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"iptables-restore"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"/etc/iptables/iptables.rules.bak"}]}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"заворачивание-всего-трафика-в-tor"},"children":[{"type":"text","value":"Заворачивание всего трафика в tor"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"В сети наткнулся на простой пайтон скрипт, немного подправил под Arch."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://github.com/creio/dots/blob/master/.bin/toriptables3.py","rel":["nofollow"]},"children":[{"type":"text","value":"toriptables3.py"}]}]},{"type":"element","tag":"code","props":{"code":"sudo toriptables3.py -l\n\n# сброс правил\nsudo toriptables3.py -f\n\n# лучше откатите через iptables\nsudo iptables-restore /etc/iptables/iptables.rules.bak\n\n# help\nsudo toriptables3.py -h\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-8ad5c6"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"toriptables3.py"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"-l\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-aac03b"},"children":[{"type":"text","value":"# сброс правил\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-8ad5c6"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"toriptables3.py"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"-f\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-aac03b"},"children":[{"type":"text","value":"# лучше откатите через iptables\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"class":"ct-8ad5c6"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"iptables-restore"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"/etc/iptables/iptables.rules.bak\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"class":"ct-aac03b"},"children":[{"type":"text","value":"# help\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"class":"ct-8ad5c6"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ae3163"},"children":[{"type":"text","value":"toriptables3.py"}]},{"type":"element","tag":"span","props":{"class":"ct-e5e29c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-f565df"},"children":[{"type":"text","value":"-h"}]}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"ссылки"},"children":[{"type":"text","value":"Ссылки"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://gitlab.torproject.org/legacy/trac/-/wikis/doc/TransparentProxy","rel":["nofollow"]},"children":[{"type":"text","value":"TransparentProxy"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://wiki.archlinux.org/title/iptables","rel":["nofollow"]},"children":[{"type":"text","value":"iptables"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://wiki.archlinux.org/title/Dhcpcd","rel":["nofollow"]},"children":[{"type":"text","value":"Dhcpcd"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://wiki.archlinux.org/title/Tor#Using_TorDNS_for_all_DNS_queries","rel":["nofollow"]},"children":[{"type":"text","value":"Using_TorDNS_for_all_DNS_queries"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://wiki.archlinux.org/title/Dnsmasq","rel":["nofollow"]},"children":[{"type":"text","value":"Dnsmasq"}]}]}]},{"type":"element","tag":"style","children":[{"type":"text","value":".ct-135aba{color:#FF7B72}\n.ct-aac03b{color:#8B949E}\n.ct-f565df{color:#79C0FF}\n.ct-ae3163{color:#A5D6FF}\n.ct-e5e29c{color:#C9D1D9}\n.ct-8ad5c6{color:#FFA657}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"заворачивание-всего-трафика-в-tor","depth":2,"text":"Заворачивание всего трафика в tor"},{"id":"ссылки","depth":2,"text":"Ссылки"}]}},"_type":"markdown","_id":"content:posts:tor.md","_source":"content","_file":"posts/tor.md","_extension":"md"}]