{"_path":"/posts/fluxbb-discourse","_dir":"posts","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"Перенос форума fluxbb на discourse","description":"","date":"2021-06-19T00:00:00.000Z","type":"post","tags":["dev","fluxbb"],"body":{"type":"root","children":[{"type":"element","tag":"h2","props":{"id":"перенос-mysql"},"children":[{"type":"text","value":"Перенос mysql"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Для переноса нужно получить базу данных форума fluxbb, наверняка вы знаете как это сделать, но если нет, то вот. Данные для подключение к базе, которые вы создавали, или то, что предоставил хостер, при создании."}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"host_ip - ip или домен mysql."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"user_db - имя пользователя базы"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"PASS_WORD_DB - пароль к базе"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"db_name - имя базы"}]}]},{"type":"element","tag":"code","props":{"code":"# получение через ssh\nssh creio@125.120.10.54 \"mysqldump -h host_ip -u user_db -pPASS_WORD_DB db_name\" > ~/forum.sql\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d9b454"},"children":[{"type":"text","value":"# получение через ssh"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6b34f8"},"children":[{"type":"text","value":"ssh"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"creio@125.120.10.54"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"\"mysqldump -h host_ip -u user_db -pPASS_WORD_DB db_name\""}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-d368cb"},"children":[{"type":"text","value":">"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"~/forum.sql"}]}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"login-в-docker"},"children":[{"type":"text","value":"Login в docker"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Копируем mysql дамп базы в докер контейнер и логинемся в него."}]},{"type":"element","tag":"code","props":{"code":"docker cp ~/forum.sql app:/var/www/discourse\n\n# docker exec -it app /bin/bash --login\nsudo ./launcher enter app\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6b34f8"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"cp"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"~/forum.sql"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"app:/var/www/discourse"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d9b454"},"children":[{"type":"text","value":"# docker exec -it app /bin/bash --login"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6b34f8"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"./launcher"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"enter"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"app"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Установка mysql и запуск."}]},{"type":"element","tag":"code","props":{"code":"apt install -y mariadb-server mariadb-client libmariadb-dev\nservice mysql start\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6b34f8"},"children":[{"type":"text","value":"apt"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"install"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-01d23a"},"children":[{"type":"text","value":"-y"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"mariadb-server"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"mariadb-client"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"libmariadb-dev"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6b34f8"},"children":[{"type":"text","value":"service"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"mysql"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"start"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Создаем mysql базу, в которую выгрузим старые данные."}]},{"type":"element","tag":"code","props":{"code":"mysql -u root -p mysql\nmysql> CREATE USER 'fluxbb'@'localhost' IDENTIFIED BY 'fluxbb';\nmysql> CREATE DATABASE fluxbb;\nmysql> GRANT ALL PRIVILEGES ON fluxbb.* TO 'fluxbb'@'localhost';\nmysql> FLUSH PRIVILEGES;\nmysql> exit\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6b34f8"},"children":[{"type":"text","value":"mysql"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-01d23a"},"children":[{"type":"text","value":"-u"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"root"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-01d23a"},"children":[{"type":"text","value":"-p"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"mysql"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6b34f8"},"children":[{"type":"text","value":"mysql>"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"CREATE"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"USER"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"'fluxbb'@'localhost'"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"IDENTIFIED"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"BY"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"'fluxbb'"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":";"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6b34f8"},"children":[{"type":"text","value":"mysql>"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"CREATE"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"DATABASE"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"fluxbb"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":";"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6b34f8"},"children":[{"type":"text","value":"mysql>"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"GRANT"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"ALL"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"PRIVILEGES"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"ON"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"fluxbb."}]},{"type":"element","tag":"span","props":{"class":"ct-01d23a"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"TO"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"'fluxbb'@'localhost'"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":";"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6b34f8"},"children":[{"type":"text","value":"mysql>"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"FLUSH"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"PRIVILEGES"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":";"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6b34f8"},"children":[{"type":"text","value":"mysql>"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"exit"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Логинимся под юзера discourse."}]},{"type":"element","tag":"code","props":{"code":"su discourse\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6b34f8"},"children":[{"type":"text","value":"su"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"discourse"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Экспортируем базу данных fluxbb."}]},{"type":"element","tag":"code","props":{"code":"mysql -u fluxbb -p fluxbb < forum.sql\n# pass\nfluxbb\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6b34f8"},"children":[{"type":"text","value":"mysql"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-01d23a"},"children":[{"type":"text","value":"-u"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"fluxbb"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-01d23a"},"children":[{"type":"text","value":"-p"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"fluxbb"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-d368cb"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"forum.sql"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d9b454"},"children":[{"type":"text","value":"# pass"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6b34f8"},"children":[{"type":"text","value":"fluxbb"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Добавляем зависимости в Gemfile."}]},{"type":"element","tag":"code","props":{"code":"echo \"gem 'mysql2'\" >> Gemfile\necho \"gem 'redcarpet'\" >> Gemfile\necho \"gem 'ruby-bbcode-to-md', git: 'https://github.com/nlalonde/ruby-bbcode-to-md'\" >> Gemfile\necho \"gem 'reverse_markdown'\" >> Gemfile\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-01d23a"},"children":[{"type":"text","value":"echo"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"\"gem 'mysql2'\""}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-d368cb"},"children":[{"type":"text","value":">>"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"Gemfile"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-01d23a"},"children":[{"type":"text","value":"echo"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"\"gem 'redcarpet'\""}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-d368cb"},"children":[{"type":"text","value":">>"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"Gemfile"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-01d23a"},"children":[{"type":"text","value":"echo"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"\"gem 'ruby-bbcode-to-md', git: 'https://github.com/nlalonde/ruby-bbcode-to-md'\""}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-d368cb"},"children":[{"type":"text","value":">>"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"Gemfile"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-01d23a"},"children":[{"type":"text","value":"echo"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"\"gem 'reverse_markdown'\""}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-d368cb"},"children":[{"type":"text","value":">>"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"Gemfile"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Установка зависимостей для корректной конвертации."}]},{"type":"element","tag":"code","props":{"code":"bundle config unset deployment\nbundle install --no-deployment --path vendor/bundle --jobs 4 --without test development\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6b34f8"},"children":[{"type":"text","value":"bundle"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"config"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"unset"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"deployment"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6b34f8"},"children":[{"type":"text","value":"bundle"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"install"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-01d23a"},"children":[{"type":"text","value":"--no-deployment"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-01d23a"},"children":[{"type":"text","value":"--path"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"vendor/bundle"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-01d23a"},"children":[{"type":"text","value":"--jobs"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-01d23a"},"children":[{"type":"text","value":"4"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-01d23a"},"children":[{"type":"text","value":"--without"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"test"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"development"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Данные для подключение к mysql, возможно у вас нет FLUXBB_PREFIX в базе и будет ошибка, попробуйте убрать это значение."}]},{"type":"element","tag":"code","props":{"code":"FLUXBB_HOST=\"localhost\" FLUXBB_DB=\"fluxbb\" FLUXBB_USER=\"fluxbb\" FLUXBB_PW=\"fluxbb\" FLUXBB_PREFIX=\"bb_\" bundle exec ruby script/import_scripts/fluxbb.rb\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":"FLUXBB_HOST"}]},{"type":"element","tag":"span","props":{"class":"ct-d368cb"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"\"localhost\""}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" FLUXBB_DB"}]},{"type":"element","tag":"span","props":{"class":"ct-d368cb"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"\"fluxbb\""}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" FLUXBB_USER"}]},{"type":"element","tag":"span","props":{"class":"ct-d368cb"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"\"fluxbb\""}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" FLUXBB_PW"}]},{"type":"element","tag":"span","props":{"class":"ct-d368cb"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"\"fluxbb\""}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" FLUXBB_PREFIX"}]},{"type":"element","tag":"span","props":{"class":"ct-d368cb"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"\"bb_\""}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" bundle exec ruby script/import_scripts/fluxbb.rb"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Изменение домена, полезно выполнить на тестовом домене, а когда все готово изменить на основной, "},{"type":"element","tag":"a","props":{"href":"https://meta.discourse.org/t/change-the-domain-name-or-rename-my-discourse/16098","rel":["nofollow"]},"children":[{"type":"text","value":"meta.discourse.org"}]},{"type":"text","value":"."}]},{"type":"element","tag":"h2","props":{"id":"обновление-discourse"},"children":[{"type":"text","value":"Обновление discourse"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Первым делом стоит обновить сам сервер(ubuntu/debian)."}]},{"type":"element","tag":"code","props":{"code":"apt-get update\napt-get dist-upgrade\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6b34f8"},"children":[{"type":"text","value":"apt-get"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"update"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6b34f8"},"children":[{"type":"text","value":"apt-get"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"dist-upgrade"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Включить автообновления(не обязательно) и не везде это возможно, для убунту."}]},{"type":"element","tag":"code","props":{"code":"sudo dpkg-reconfigure -plow unattended-upgrades\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6b34f8"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"dpkg-reconfigure"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-01d23a"},"children":[{"type":"text","value":"-plow"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"unattended-upgrades"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Discourse работает в докере и используются скрипты для упрощения."}]},{"type":"element","tag":"code","props":{"code":"sudo su\ncd /var/discourse\ngit pull\n./launcher rebuild app\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6b34f8"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"su"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-01d23a"},"children":[{"type":"text","value":"cd"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"/var/discourse"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6b34f8"},"children":[{"type":"text","value":"git"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"pull"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-01d23a"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-6b34f8"},"children":[{"type":"text","value":"/launcher"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"rebuild"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"app"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"После обновления и запусков rebuild будут плодится контейнеры и images, которые забивают диск, но не используются."}]},{"type":"element","tag":"code","props":{"code":"# размер диска\ndf -h /\n# размеры директорий\ndu -sh /var/lib/*\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d9b454"},"children":[{"type":"text","value":"# размер диска"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6b34f8"},"children":[{"type":"text","value":"df"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-01d23a"},"children":[{"type":"text","value":"-h"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"/"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d9b454"},"children":[{"type":"text","value":"# размеры директорий"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6b34f8"},"children":[{"type":"text","value":"du"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-01d23a"},"children":[{"type":"text","value":"-sh"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"/var/lib/"}]},{"type":"element","tag":"span","props":{"class":"ct-01d23a"},"children":[{"type":"text","value":"*"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Удалить не нужные образы можно через docker, или через скрипт, имейте ввиду скрипт снесет все остановленные контейнеры и удалит все неиспользуемые образы. Дело в том, что если у вас работает, что-то еще кроме discourse в докере, то лучше работать именно самим docker-ом и удалять по id(7281bf55ce46)."}]},{"type":"element","tag":"code","props":{"code":"# листинг контейнеров\ndocker ps -a\n# удаление контейнеров(CONTAINER ID)\ndocker rm 8ee579ceabf7\n\n# листинг образов\ndocker images\n# удаление образов(IMAGE ID)\ndocker rmi 7281bf55ce46\n\n# удаление всего скриптом\n./launcher cleanup\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d9b454"},"children":[{"type":"text","value":"# листинг контейнеров"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6b34f8"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"ps"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-01d23a"},"children":[{"type":"text","value":"-a"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d9b454"},"children":[{"type":"text","value":"# удаление контейнеров(CONTAINER ID)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6b34f8"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"rm"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"8ee579ceabf7"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d9b454"},"children":[{"type":"text","value":"# листинг образов"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6b34f8"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"images"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d9b454"},"children":[{"type":"text","value":"# удаление образов(IMAGE ID)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6b34f8"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"rmi"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"7281bf55ce46"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d9b454"},"children":[{"type":"text","value":"# удаление всего скриптом"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-01d23a"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-6b34f8"},"children":[{"type":"text","value":"/launcher"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"cleanup"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Очистка системы apt."}]},{"type":"element","tag":"code","props":{"code":"apt-get autoclean\napt-get autoremove\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6b34f8"},"children":[{"type":"text","value":"apt-get"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"autoclean"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6b34f8"},"children":[{"type":"text","value":"apt-get"}]},{"type":"element","tag":"span","props":{"class":"ct-ab4a36"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-ad45fe"},"children":[{"type":"text","value":"autoremove"}]}]}]}]}]},{"type":"element","tag":"style","children":[{"type":"text","value":".ct-01d23a{color:#79C0FF}\n.ct-d368cb{color:#FF7B72}\n.ct-ad45fe{color:#A5D6FF}\n.ct-ab4a36{color:#C9D1D9}\n.ct-6b34f8{color:#FFA657}\n.ct-d9b454{color:#8B949E}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"перенос-mysql","depth":2,"text":"Перенос mysql"},{"id":"login-в-docker","depth":2,"text":"Login в docker"},{"id":"обновление-discourse","depth":2,"text":"Обновление discourse"}]}},"_type":"markdown","_id":"content:posts:fluxbb-discourse.md","_source":"content","_file":"posts/fluxbb-discourse.md","_extension":"md"}