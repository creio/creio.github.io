export default (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_,$,aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al,am,an,ao,ap,aq,ar,as,at,au,av,aw,ax,ay,az,aA,aB,aC,aD,aE,aF,aG,aH,aI,aJ,aK,aL,aM,aN,aO,aP,aQ,aR,aS,aT,aU,aV,aW,aX,aY,aZ,a_,a$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw){return {data:{posts:[{_path:"\u002Fposts\u002Fnginx-onion",_dir:ap,_draft:K,_partial:K,_locale:m,_empty:K,title:"Доступность веб сервера в tor и создание onion домена | Nginx tor onion",description:aq,date:"2021-09-13T00:00:00.000Z",type:ar,tags:[as,"webserver"],body:{type:L,children:[{type:a,tag:p,props:{},children:[{type:b,value:aq}]},{type:a,tag:O,props:{},children:[{type:a,tag:C,props:{},children:[{type:a,tag:F,props:{href:"https:\u002F\u002Fwww.youtube.com\u002Fwatch?v=1ioGn-2JaiM",rel:[M]},children:[{type:b,value:"Video"}]}]}]},{type:a,tag:p,props:{},children:[{type:b,value:"Все действия выполняются на Arch Linux, но суть везде одинакова, разница только в пакетном менеджере."}]},{type:a,tag:O,props:{},children:[{type:a,tag:C,props:{},children:[{type:a,tag:F,props:{href:"https:\u002F\u002Fwww.cloudflare.com\u002F",rel:[M]},children:[{type:b,value:"www.cloudflare.com\u002F"}]}]}]},{type:a,tag:D,props:{id:at},children:[{type:b,value:au}]},{type:a,tag:p,props:{},children:[{type:b,value:"Локально нужен только tor или tor браузер для доступа к будущему сервису, я буду использовать chromium с прокси портом тора 9050."}]},{type:a,tag:l,props:{code:"yay -S tor chromium\n",language:r,meta:s},children:[{type:a,tag:t,props:{},children:[{type:a,tag:l,props:{__ignoreMap:m},children:[{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:k},children:[{type:b,value:av}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:n},children:[{type:b,value:aw}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:X}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"chromium"}]}]}]}]}]},{type:a,tag:p,props:{},children:[{type:b,value:"На сервере нужен tor и nginx."}]},{type:a,tag:l,props:{code:"yay -S tor nginx\n",language:r,meta:s},children:[{type:a,tag:t,props:{},children:[{type:a,tag:l,props:{__ignoreMap:m},children:[{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:k},children:[{type:b,value:av}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:n},children:[{type:b,value:aw}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:X}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:ae}]}]}]}]}]},{type:a,tag:D,props:{id:ax},children:[{type:b,value:ay}]},{type:a,tag:p,props:{},children:[{type:b,value:"Отредактировать конфиг на сервере \u002Fetc\u002Ftor\u002Ftorrc, раскомментировать 2 строки."}]},{type:a,tag:l,props:{code:"sudo nano \u002Fetc\u002Ftor\u002Ftorrc\n\nHiddenServiceDir \u002Fvar\u002Flib\u002Ftor\u002Fhidden_service\u002F\nHiddenServicePort 80 127.0.0.1:80\n",language:r,meta:s},children:[{type:a,tag:t,props:{},children:[{type:a,tag:l,props:{__ignoreMap:m},children:[{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:k},children:[{type:b,value:x}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:af}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"\u002Fetc\u002Ftor\u002Ftorrc"}]}]},{type:a,tag:f,props:{class:g},children:[]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:k},children:[{type:b,value:"HiddenServiceDir"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:ag}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:k},children:[{type:b,value:"HiddenServicePort"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:n},children:[{type:b,value:P}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"127.0.0.1:"}]},{type:a,tag:c,props:{class:n},children:[{type:b,value:P}]}]}]}]}]},{type:a,tag:D,props:{id:az},children:[{type:b,value:aA}]},{type:a,tag:ah,props:{},children:[{type:a,tag:p,props:{},children:[{type:b,value:"Генерировать не обязательно, по умолчанию tor сам создает нужные файлы в hidden_service при рестарте, но их можно удалить и создать имя с кастомным началом в hostname. Чем длиннее имя, тем дольше генерация."}]}]},{type:a,tag:O,props:{},children:[{type:a,tag:C,props:{},children:[{type:a,tag:F,props:{href:aB,rel:[M]},children:[{type:b,value:"github.com\u002Fcathugger\u002Fmkp224o"}]}]}]},{type:a,tag:l,props:{code:"git clone https:\u002F\u002Fgithub.com\u002Fcathugger\u002Fmkp224o\ncd mkp224o\n.\u002Fautogen.sh\n.\u002Fconfigure\nmake\n# -t 2  потоки cpu, -n кол-во имен, имя topor\n.\u002Fmkp224o filter topor -t 2 -v -n 1 -d ~\u002Fhs-keys\n#\nscp -r ~\u002Fhs-keys user@123.123.123.123:~\u002F\n",language:r,meta:s},children:[{type:a,tag:t,props:{},children:[{type:a,tag:l,props:{__ignoreMap:m},children:[{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:k},children:[{type:b,value:aC}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"clone"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:aB}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:n},children:[{type:b,value:aD}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"mkp224o"}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:n},children:[{type:b,value:E}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:"\u002Fautogen.sh"}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:n},children:[{type:b,value:E}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:"\u002Fconfigure"}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:k},children:[{type:b,value:"make"}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:z},children:[{type:b,value:"# -t 2  потоки cpu, -n кол-во имен, имя topor"}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:n},children:[{type:b,value:E}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:"\u002Fmkp224o"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"filter"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"topor"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:n},children:[{type:b,value:aE}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:n},children:[{type:b,value:"2"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:n},children:[{type:b,value:"-v"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:n},children:[{type:b,value:"-n"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:n},children:[{type:b,value:"1"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:n},children:[{type:b,value:"-d"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:aF}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:z},children:[{type:b,value:"#"}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:k},children:[{type:b,value:"scp"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:n},children:[{type:b,value:aG}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:aF}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"user@123.123.123.123:~\u002F"}]}]}]}]}]},{type:a,tag:ah,props:{},children:[{type:a,tag:p,props:{},children:[{type:b,value:"Рекомендую сохранить ключи и hostname."}]}]},{type:a,tag:D,props:{id:aH},children:[{type:b,value:aI}]},{type:a,tag:p,props:{},children:[{type:b,value:"На сервере после переноса файлов."}]},{type:a,tag:l,props:{code:"ssh user@123.123.123.123\nsudo cp -r ~\u002Fhs-keys\u002F*\u002F* \u002Fvar\u002Flib\u002Ftor\u002Fhidden_service\u002F\nsudo chmod 700 \u002Fvar\u002Flib\u002Ftor\u002Fhidden_service\nsudo chown -R tor:tor \u002Fvar\u002Flib\u002Ftor\u002Fhidden_service\u002F\nsudo systemctl restart tor\nsudo systemctl status tor\nsudo cat \u002Fvar\u002Flib\u002Ftor\u002Fhidden_service\u002Fhostname\n",language:r,meta:s},children:[{type:a,tag:t,props:{},children:[{type:a,tag:l,props:{__ignoreMap:m},children:[{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:k},children:[{type:b,value:aJ}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"user@123.123.123.123"}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:k},children:[{type:b,value:x}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:aK}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:n},children:[{type:b,value:aG}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"~\u002Fhs-keys\u002F"}]},{type:a,tag:c,props:{class:n},children:[{type:b,value:Y}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:G}]},{type:a,tag:c,props:{class:n},children:[{type:b,value:Y}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:ag}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:k},children:[{type:b,value:x}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"chmod"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:n},children:[{type:b,value:"700"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"\u002Fvar\u002Flib\u002Ftor\u002Fhidden_service"}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:k},children:[{type:b,value:x}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"chown"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:n},children:[{type:b,value:"-R"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"tor:tor"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:ag}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:k},children:[{type:b,value:x}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:ai}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:aL}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:X}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:k},children:[{type:b,value:x}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:ai}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"status"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:X}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:k},children:[{type:b,value:x}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"cat"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"\u002Fvar\u002Flib\u002Ftor\u002Fhidden_service\u002Fhostname"}]}]}]}]}]},{type:a,tag:D,props:{id:aM},children:[{type:b,value:aN}]},{type:a,tag:ah,props:{},children:[{type:a,tag:p,props:{},children:[{type:b,value:"Важный момент, onion работает по http поэтому не нужно использовать редиректы на 443 порт https "},{type:a,tag:F,props:{href:"\u002Fposts\u002Fweb-server"},children:[{type:b,value:"О первоначальной настройке nginx смотри тут"}]},{type:b,value:E}]}]},{type:a,tag:p,props:{},children:[{type:b,value:"Дефолтный конфиг "},{type:a,tag:aj,props:{},children:[{type:b,value:"\u002Fetc\u002Fnginx\u002Fnginx.conf"}]},{type:b,value:", можно в секцию server добавить созданный onion домен и он будет выдавать содержимое по умолчанию из "},{type:a,tag:aj,props:{},children:[{type:b,value:aO}]},{type:b,value:", в данном случае "},{type:a,tag:aj,props:{},children:[{type:b,value:"index.hmtl"}]},{type:b,value:E}]},{type:a,tag:l,props:{code:"# вырезка \u002Fetc\u002Fnginx\u002Fnginx.conf\nserver {\n        listen 80 default_server;\n        listen [::]:80 default_server;\n        server_name ctlos5lhe2vc3giixr.onion;\n\n        root \u002Fusr\u002Fshare\u002Fnginx\u002Fhtml;\n        index index.htm index.html;\n...\n",language:r,meta:s},children:[{type:a,tag:t,props:{},children:[{type:a,tag:l,props:{__ignoreMap:m},children:[{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:z},children:[{type:b,value:"# вырезка \u002Fetc\u002Fnginx\u002Fnginx.conf"}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:k},children:[{type:b,value:Z}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:H}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:Q}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:I}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:n},children:[{type:b,value:P}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:aP}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:q}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:Q}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:I}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:" [::]:80 "}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:aP}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:q}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:Q}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:R}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:_}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:q}]}]},{type:a,tag:f,props:{class:g},children:[]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:Q}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:L}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:aO}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:q}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:Q}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:"index"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"index.htm"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"index.html"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:q}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:n},children:[{type:b,value:"..."}]}]}]}]}]},{type:a,tag:p,props:{},children:[{type:b,value:"Простой конфиг, Nginx выводит содержимое директории."}]},{type:a,tag:l,props:{code:"sudo nano \u002Fetc\u002Fnginx\u002Fsites-available\u002Fonion.conf\nsudo ln -s \u002Fetc\u002Fnginx\u002Fsites-available\u002Fonion.conf \u002Fetc\u002Fnginx\u002Fsites-enabled\n",language:r,meta:s},children:[{type:a,tag:t,props:{},children:[{type:a,tag:l,props:{__ignoreMap:m},children:[{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:k},children:[{type:b,value:x}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:af}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:aQ}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:k},children:[{type:b,value:x}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"ln"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:n},children:[{type:b,value:"-s"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:aQ}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"\u002Fetc\u002Fnginx\u002Fsites-enabled"}]}]}]}]}]},{type:a,tag:l,props:{code:"server {\n  # директория со статикой сайта\n  server_name ctlos5lhe2vc3giixr.onion;\n  root \u002Fhome\u002Fcretm\u002Fapp\u002Fcloud.ctlos.ru;\n  listen 80;\n  listen [::]:80;\n\n  location \u002F {\n    autoindex on;\n    try_files $uri $uri\u002F =404;\n  }\n}\n",language:r,meta:s},children:[{type:a,tag:t,props:{},children:[{type:a,tag:l,props:{__ignoreMap:m},children:[{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:k},children:[{type:b,value:Z}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:H}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:v}]},{type:a,tag:c,props:{class:z},children:[{type:b,value:"# директория со статикой сайта"}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:v}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:R}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:_}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:q}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:v}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:L}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:aR}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:q}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:v}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:I}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:n},children:[{type:b,value:P}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:q}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:v}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:I}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:aS}]}]},{type:a,tag:f,props:{class:g},children:[]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:v}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:ak}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:G}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:H}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:w}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:aT}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:al}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:q}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:w}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:aU}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:aV}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:G}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:J}]},{type:a,tag:c,props:{class:n},children:[{type:b,value:aW}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:q}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:am}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:an}]}]}]}]}]},{type:a,tag:p,props:{},children:[{type:b,value:"Проверка и рестарт web сервера."}]},{type:a,tag:l,props:{code:"sudo nginx -t\nsudo systemctl restart nginx\n",language:r,meta:s},children:[{type:a,tag:t,props:{},children:[{type:a,tag:l,props:{__ignoreMap:m},children:[{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:k},children:[{type:b,value:x}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:ae}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:n},children:[{type:b,value:aE}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:k},children:[{type:b,value:x}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:ai}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:aL}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:ae}]}]}]}]}]},{type:a,tag:p,props:{},children:[{type:b,value:"Конфиг с 2 доменами и ssl. С указанием Onion-Location, добавляет фиолетовый знак в тор браузере, сайт обязательно должен иметь ssl на основном домене."}]},{type:a,tag:l,props:{code:"sudo nano \u002Fetc\u002Fnginx\u002Fsites-enabled\u002Fonion.conf\n",language:r,meta:s},children:[{type:a,tag:t,props:{},children:[{type:a,tag:l,props:{__ignoreMap:m},children:[{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:k},children:[{type:b,value:x}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:af}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"\u002Fetc\u002Fnginx\u002Fsites-enabled\u002Fonion.conf"}]}]}]}]}]},{type:a,tag:l,props:{code:"server {\n  server_name dev.ctlos.ru;\n  server_name ctlos5lhe2vc3giixr.onion;\n  root \u002Fhome\u002Fcretm\u002Fapp\u002Fcloud.ctlos.ru;\n\n  listen 80;\n  listen [::]:80;\n\n  listen 443 ssl; # managed by Certbot\n  ssl_certificate \u002Fetc\u002Fletsencrypt\u002Flive\u002Fdev.ctlos.ru\u002Ffullchain.pem; # managed by Certbot\n  ssl_certificate_key \u002Fetc\u002Fletsencrypt\u002Flive\u002Fdev.ctlos.ru\u002Fprivkey.pem; # managed by Certbot\n  include \u002Fetc\u002Fletsencrypt\u002Foptions-ssl-nginx.conf; # managed by Certbot\n  ssl_dhparam \u002Fetc\u002Fletsencrypt\u002Fssl-dhparams.pem; # managed by Certbot\n\n  location \u002F {\n    autoindex on;\n    try_files $uri $uri\u002F =404;\n    add_header Onion-Location \"http:\u002F\u002Fctlos5lhe2vc3giixr.onion$request_uri\" always;\n  }\n}\n",language:r,meta:s},children:[{type:a,tag:t,props:{},children:[{type:a,tag:l,props:{__ignoreMap:m},children:[{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:k},children:[{type:b,value:Z}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:H}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:v}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:R}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"dev.ctlos.ru"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:q}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:v}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:R}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:_}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:q}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:v}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:L}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:aR}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:q}]}]},{type:a,tag:f,props:{class:g},children:[]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:v}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:I}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:n},children:[{type:b,value:P}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:q}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:v}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:I}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:aS}]}]},{type:a,tag:f,props:{class:g},children:[]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:v}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:I}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:n},children:[{type:b,value:"443"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"ssl"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:S}]},{type:a,tag:c,props:{class:z},children:[{type:b,value:T}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:v}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:"ssl_certificate"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"\u002Fetc\u002Fletsencrypt\u002Flive\u002Fdev.ctlos.ru\u002Ffullchain.pem"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:S}]},{type:a,tag:c,props:{class:z},children:[{type:b,value:T}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:v}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:"ssl_certificate_key"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"\u002Fetc\u002Fletsencrypt\u002Flive\u002Fdev.ctlos.ru\u002Fprivkey.pem"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:S}]},{type:a,tag:c,props:{class:z},children:[{type:b,value:T}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:v}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:"include"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"\u002Fetc\u002Fletsencrypt\u002Foptions-ssl-nginx.conf"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:S}]},{type:a,tag:c,props:{class:z},children:[{type:b,value:T}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:v}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:"ssl_dhparam"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"\u002Fetc\u002Fletsencrypt\u002Fssl-dhparams.pem"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:S}]},{type:a,tag:c,props:{class:z},children:[{type:b,value:T}]}]},{type:a,tag:f,props:{class:g},children:[]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:v}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:ak}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:G}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:H}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:w}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:aT}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:al}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:q}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:w}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:aU}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:aV}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:G}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:J}]},{type:a,tag:c,props:{class:n},children:[{type:b,value:aW}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:q}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:w}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:aX}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:aY}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:aZ}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:a_}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:a$}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:ba}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:q}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:am}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:an}]}]}]}]}]},{type:a,tag:p,props:{},children:[{type:b,value:"Реверс прокси nginx. Пример направления домена на порт 5000 на котором работает не важно какой веб сервис, в данном случае Whoogle."}]},{type:a,tag:l,props:{code:"server {\n  server_name ctlos5lhe2vc3giixr.onion;\n  # reverse proxy\n  location \u002F {\n    proxy_pass http:\u002F\u002Flocalhost:5000;  # Whoogle\n    proxy_redirect off;\n    add_header Onion-Location \"http:\u002F\u002Fctlos5lhe2vc3giixr.onion$request_uri\" always;\n\n    proxy_set_header Host $http_host;\n    proxy_set_header X-Real-IP $remote_addr;\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    proxy_set_header X-Forwarded-Proto $scheme;\n    proxy_set_header Proxy \"Cloud-LB\";\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_pass_header Server;\n\n    proxy_buffering off;\n    proxy_http_version 1.1;\n    tcp_nodelay on;\n  }\n}\n",language:r,meta:s},children:[{type:a,tag:t,props:{},children:[{type:a,tag:l,props:{__ignoreMap:m},children:[{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:k},children:[{type:b,value:Z}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:H}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:v}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:R}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:_}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:q}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:v}]},{type:a,tag:c,props:{class:z},children:[{type:b,value:"# reverse proxy"}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:v}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:ak}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:G}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:H}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:w}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:"proxy_pass"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"http:\u002F\u002Flocalhost:"}]},{type:a,tag:c,props:{class:n},children:[{type:b,value:"5000"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:";  "}]},{type:a,tag:c,props:{class:z},children:[{type:b,value:"# Whoogle"}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:w}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:"proxy_redirect"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:bb}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:q}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:w}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:aX}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:aY}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:aZ}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:a_}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:a$}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:ba}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:q}]}]},{type:a,tag:f,props:{class:g},children:[]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:w}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:N}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"Host"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:" $http_host;"}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:w}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:N}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"X-Real-IP"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:" $remote_addr;"}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:w}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:N}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"X-Forwarded-For"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:" $proxy_add_x_forwarded_for;"}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:w}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:N}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"X-Forwarded-Proto"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:" $scheme;"}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:w}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:N}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"Proxy"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"\"Cloud-LB\""}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:q}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:w}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:N}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"Upgrade"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:" $http_upgrade;"}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:w}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:"proxy_pass_header"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"Server"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:q}]}]},{type:a,tag:f,props:{class:g},children:[]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:w}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:"proxy_buffering"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:bb}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:q}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:w}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:"proxy_http_version"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:n},children:[{type:b,value:"1.1"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:q}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:w}]},{type:a,tag:c,props:{class:k},children:[{type:b,value:"tcp_nodelay"}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:al}]},{type:a,tag:c,props:{class:e},children:[{type:b,value:q}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:am}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:e},children:[{type:b,value:an}]}]}]}]}]},{type:a,tag:O,props:{},children:[{type:a,tag:C,props:{},children:[{type:a,tag:F,props:{href:"https:\u002F\u002Fctlos.github.io\u002Fdonat\u002F",rel:[M]},children:[{type:b,value:"Поблагодарить меня можно тут"}]}]},{type:a,tag:C,props:{},children:[{type:b,value:"Вопросы и предложения можно оставить в чате "},{type:a,tag:F,props:{href:"https:\u002F\u002Ftelegram.me\u002Fctlos",rel:[M]},children:[{type:b,value:"@ctlos"}]}]}]},{type:a,tag:bc,children:[{type:b,value:".ct-ef48ff{color:#8B949E}\n.ct-562b78{color:#A5D6FF}\n.ct-2fdb93{color:#79C0FF}\n.ct-09e790{color:#C9D1D9}\n.ct-e3a178{color:#FFA657}"}]}],toc:{title:m,searchDepth:y,depth:y,links:[{id:at,depth:y,text:au},{id:ax,depth:y,text:ay},{id:az,depth:y,text:aA},{id:aH,depth:y,text:aI},{id:aM,depth:y,text:aN}]}},_type:bd,_id:"content:posts:nginx-onion.md",_source:be,_file:"posts\u002Fnginx-onion.md",_extension:bf},{_path:"\u002Fposts\u002Ffluxbb-discourse",_dir:ap,_draft:K,_partial:K,_locale:m,_empty:K,title:"Перенос форума fluxbb на discourse",description:m,date:"2021-06-19T00:00:00.000Z",type:ar,tags:[as,U],body:{type:L,children:[{type:a,tag:D,props:{id:bg},children:[{type:b,value:bh}]},{type:a,tag:p,props:{},children:[{type:b,value:"Для переноса нужно получить базу данных форума fluxbb, наверняка вы знаете как это сделать, но если нет, то вот. Данные для подключение к базе, которые вы создавали, или то, что предоставил хостер, при создании."}]},{type:a,tag:O,props:{},children:[{type:a,tag:C,props:{},children:[{type:b,value:"host_ip - ip или домен mysql."}]},{type:a,tag:C,props:{},children:[{type:b,value:"user_db - имя пользователя базы"}]},{type:a,tag:C,props:{},children:[{type:b,value:"PASS_WORD_DB - пароль к базе"}]},{type:a,tag:C,props:{},children:[{type:b,value:"db_name - имя базы"}]}]},{type:a,tag:l,props:{code:"# получение через ssh\nssh creio@125.120.10.54 \"mysqldump -h host_ip -u user_db -pPASS_WORD_DB db_name\" \u003E ~\u002Fforum.sql\n",language:r,meta:s},children:[{type:a,tag:t,props:{},children:[{type:a,tag:l,props:{__ignoreMap:m},children:[{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:B},children:[{type:b,value:"# получение через ssh"}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:o},children:[{type:b,value:aJ}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"creio@125.120.10.54"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"\"mysqldump -h host_ip -u user_db -pPASS_WORD_DB db_name\""}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:A},children:[{type:b,value:"\u003E"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:bi}]}]}]}]}]},{type:a,tag:D,props:{id:bj},children:[{type:b,value:bk}]},{type:a,tag:p,props:{},children:[{type:b,value:"Копируем mysql дамп базы в докер контейнер и логинемся в него."}]},{type:a,tag:l,props:{code:"docker cp ~\u002Fforum.sql app:\u002Fvar\u002Fwww\u002Fdiscourse\n\n# docker exec -it app \u002Fbin\u002Fbash --login\nsudo .\u002Flauncher enter app\n",language:r,meta:s},children:[{type:a,tag:t,props:{},children:[{type:a,tag:l,props:{__ignoreMap:m},children:[{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:o},children:[{type:b,value:V}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:aK}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:bi}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"app:\u002Fvar\u002Fwww\u002Fdiscourse"}]}]},{type:a,tag:f,props:{class:g},children:[]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:B},children:[{type:b,value:"# docker exec -it app \u002Fbin\u002Fbash --login"}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:o},children:[{type:b,value:x}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:".\u002Flauncher"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"enter"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:bl}]}]}]}]}]},{type:a,tag:p,props:{},children:[{type:b,value:"Установка mysql и запуск."}]},{type:a,tag:l,props:{code:"apt install -y mariadb-server mariadb-client libmariadb-dev\nservice mysql start\n",language:r,meta:s},children:[{type:a,tag:t,props:{},children:[{type:a,tag:l,props:{__ignoreMap:m},children:[{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:o},children:[{type:b,value:"apt"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:bm}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:u},children:[{type:b,value:"-y"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"mariadb-server"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"mariadb-client"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"libmariadb-dev"}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:o},children:[{type:b,value:"service"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:$}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"start"}]}]}]}]}]},{type:a,tag:p,props:{},children:[{type:b,value:"Создаем mysql базу, в которую выгрузим старые данные."}]},{type:a,tag:l,props:{code:"mysql -u root -p mysql\nmysql\u003E CREATE USER 'fluxbb'@'localhost' IDENTIFIED BY 'fluxbb';\nmysql\u003E CREATE DATABASE fluxbb;\nmysql\u003E GRANT ALL PRIVILEGES ON fluxbb.* TO 'fluxbb'@'localhost';\nmysql\u003E FLUSH PRIVILEGES;\nmysql\u003E exit\n",language:r,meta:s},children:[{type:a,tag:t,props:{},children:[{type:a,tag:l,props:{__ignoreMap:m},children:[{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:o},children:[{type:b,value:$}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:u},children:[{type:b,value:bn}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:L}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:u},children:[{type:b,value:bo}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:$}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:o},children:[{type:b,value:W}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:bp}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"USER"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:bq}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"IDENTIFIED"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"BY"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"'fluxbb'"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:q}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:o},children:[{type:b,value:W}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:bp}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"DATABASE"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:U}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:q}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:o},children:[{type:b,value:W}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"GRANT"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"ALL"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:br}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"ON"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"fluxbb."}]},{type:a,tag:c,props:{class:u},children:[{type:b,value:Y}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"TO"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:bq}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:q}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:o},children:[{type:b,value:W}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"FLUSH"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:br}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:q}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:o},children:[{type:b,value:W}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"exit"}]}]}]}]}]},{type:a,tag:p,props:{},children:[{type:b,value:"Логинимся под юзера discourse."}]},{type:a,tag:l,props:{code:"su discourse\n",language:r,meta:s},children:[{type:a,tag:t,props:{},children:[{type:a,tag:l,props:{__ignoreMap:m},children:[{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:o},children:[{type:b,value:bs}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"discourse"}]}]}]}]}]},{type:a,tag:p,props:{},children:[{type:b,value:"Экспортируем базу данных fluxbb."}]},{type:a,tag:l,props:{code:"mysql -u fluxbb -p fluxbb \u003C forum.sql\n# pass\nfluxbb\n",language:r,meta:s},children:[{type:a,tag:t,props:{},children:[{type:a,tag:l,props:{__ignoreMap:m},children:[{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:o},children:[{type:b,value:$}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:u},children:[{type:b,value:bn}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:U}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:u},children:[{type:b,value:bo}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:U}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:A},children:[{type:b,value:"\u003C"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"forum.sql"}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:B},children:[{type:b,value:"# pass"}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:o},children:[{type:b,value:U}]}]}]}]}]},{type:a,tag:p,props:{},children:[{type:b,value:"Добавляем зависимости в Gemfile."}]},{type:a,tag:l,props:{code:"echo \"gem 'mysql2'\" \u003E\u003E Gemfile\necho \"gem 'redcarpet'\" \u003E\u003E Gemfile\necho \"gem 'ruby-bbcode-to-md', git: 'https:\u002F\u002Fgithub.com\u002Fnlalonde\u002Fruby-bbcode-to-md'\" \u003E\u003E Gemfile\necho \"gem 'reverse_markdown'\" \u003E\u003E Gemfile\n",language:r,meta:s},children:[{type:a,tag:t,props:{},children:[{type:a,tag:l,props:{__ignoreMap:m},children:[{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:u},children:[{type:b,value:aa}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"\"gem 'mysql2'\""}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:A},children:[{type:b,value:ab}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:ac}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:u},children:[{type:b,value:aa}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"\"gem 'redcarpet'\""}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:A},children:[{type:b,value:ab}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:ac}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:u},children:[{type:b,value:aa}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"\"gem 'ruby-bbcode-to-md', git: 'https:\u002F\u002Fgithub.com\u002Fnlalonde\u002Fruby-bbcode-to-md'\""}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:A},children:[{type:b,value:ab}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:ac}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:u},children:[{type:b,value:aa}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"\"gem 'reverse_markdown'\""}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:A},children:[{type:b,value:ab}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:ac}]}]}]}]}]},{type:a,tag:p,props:{},children:[{type:b,value:"Установка зависимостей для корректной конвертации."}]},{type:a,tag:l,props:{code:"bundle config unset deployment\nbundle install --no-deployment --path vendor\u002Fbundle --jobs 4 --without test development\n",language:r,meta:s},children:[{type:a,tag:t,props:{},children:[{type:a,tag:l,props:{__ignoreMap:m},children:[{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:o},children:[{type:b,value:bt}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"config"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"unset"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"deployment"}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:o},children:[{type:b,value:bt}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:bm}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:u},children:[{type:b,value:"--no-deployment"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:u},children:[{type:b,value:"--path"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"vendor\u002Fbundle"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:u},children:[{type:b,value:"--jobs"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:u},children:[{type:b,value:"4"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:u},children:[{type:b,value:"--without"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"test"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"development"}]}]}]}]}]},{type:a,tag:p,props:{},children:[{type:b,value:"Данные для подключение к mysql, возможно у вас нет FLUXBB_PREFIX в базе и будет ошибка, попробуйте убрать это значение."}]},{type:a,tag:l,props:{code:"FLUXBB_HOST=\"localhost\" FLUXBB_DB=\"fluxbb\" FLUXBB_USER=\"fluxbb\" FLUXBB_PW=\"fluxbb\" FLUXBB_PREFIX=\"bb_\" bundle exec ruby script\u002Fimport_scripts\u002Ffluxbb.rb\n",language:r,meta:s},children:[{type:a,tag:t,props:{},children:[{type:a,tag:l,props:{__ignoreMap:m},children:[{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:h},children:[{type:b,value:"FLUXBB_HOST"}]},{type:a,tag:c,props:{class:A},children:[{type:b,value:J}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"\"localhost\""}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:" FLUXBB_DB"}]},{type:a,tag:c,props:{class:A},children:[{type:b,value:J}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:ao}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:" FLUXBB_USER"}]},{type:a,tag:c,props:{class:A},children:[{type:b,value:J}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:ao}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:" FLUXBB_PW"}]},{type:a,tag:c,props:{class:A},children:[{type:b,value:J}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:ao}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:" FLUXBB_PREFIX"}]},{type:a,tag:c,props:{class:A},children:[{type:b,value:J}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"\"bb_\""}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:" bundle exec ruby script\u002Fimport_scripts\u002Ffluxbb.rb"}]}]}]}]}]},{type:a,tag:p,props:{},children:[{type:b,value:"Изменение домена, полезно выполнить на тестовом домене, а когда все готово изменить на основной, "},{type:a,tag:F,props:{href:"https:\u002F\u002Fmeta.discourse.org\u002Ft\u002Fchange-the-domain-name-or-rename-my-discourse\u002F16098",rel:[M]},children:[{type:b,value:"meta.discourse.org"}]},{type:b,value:E}]},{type:a,tag:D,props:{id:bu},children:[{type:b,value:bv}]},{type:a,tag:p,props:{},children:[{type:b,value:"Первым делом стоит обновить сам сервер(ubuntu\u002Fdebian)."}]},{type:a,tag:l,props:{code:"apt-get update\napt-get dist-upgrade\n",language:r,meta:s},children:[{type:a,tag:t,props:{},children:[{type:a,tag:l,props:{__ignoreMap:m},children:[{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:o},children:[{type:b,value:ad}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"update"}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:o},children:[{type:b,value:ad}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"dist-upgrade"}]}]}]}]}]},{type:a,tag:p,props:{},children:[{type:b,value:"Включить автообновления(не обязательно) и не везде это возможно, для убунту."}]},{type:a,tag:l,props:{code:"sudo dpkg-reconfigure -plow unattended-upgrades\n",language:r,meta:s},children:[{type:a,tag:t,props:{},children:[{type:a,tag:l,props:{__ignoreMap:m},children:[{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:o},children:[{type:b,value:x}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"dpkg-reconfigure"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:u},children:[{type:b,value:"-plow"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"unattended-upgrades"}]}]}]}]}]},{type:a,tag:p,props:{},children:[{type:b,value:"Discourse работает в докере и используются скрипты для упрощения."}]},{type:a,tag:l,props:{code:"sudo su\ncd \u002Fvar\u002Fdiscourse\ngit pull\n.\u002Flauncher rebuild app\n",language:r,meta:s},children:[{type:a,tag:t,props:{},children:[{type:a,tag:l,props:{__ignoreMap:m},children:[{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:o},children:[{type:b,value:x}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:bs}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:u},children:[{type:b,value:aD}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"\u002Fvar\u002Fdiscourse"}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:o},children:[{type:b,value:aC}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"pull"}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:u},children:[{type:b,value:E}]},{type:a,tag:c,props:{class:o},children:[{type:b,value:bw}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"rebuild"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:bl}]}]}]}]}]},{type:a,tag:p,props:{},children:[{type:b,value:"После обновления и запусков rebuild будут плодится контейнеры и images, которые забивают диск, но не используются."}]},{type:a,tag:l,props:{code:"# размер диска\ndf -h \u002F\n# размеры директорий\ndu -sh \u002Fvar\u002Flib\u002F*\n",language:r,meta:s},children:[{type:a,tag:t,props:{},children:[{type:a,tag:l,props:{__ignoreMap:m},children:[{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:B},children:[{type:b,value:"# размер диска"}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:o},children:[{type:b,value:"df"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:u},children:[{type:b,value:"-h"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:G}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:B},children:[{type:b,value:"# размеры директорий"}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:o},children:[{type:b,value:"du"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:u},children:[{type:b,value:"-sh"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"\u002Fvar\u002Flib\u002F"}]},{type:a,tag:c,props:{class:u},children:[{type:b,value:Y}]}]}]}]}]},{type:a,tag:p,props:{},children:[{type:b,value:"Удалить не нужные образы можно через docker, или через скрипт, имейте ввиду скрипт снесет все остановленные контейнеры и удалит все неиспользуемые образы. Дело в том, что если у вас работает, что-то еще кроме discourse в докере, то лучше работать именно самим docker-ом и удалять по id(7281bf55ce46)."}]},{type:a,tag:l,props:{code:"# листинг контейнеров\ndocker ps -a\n# удаление контейнеров(CONTAINER ID)\ndocker rm 8ee579ceabf7\n\n# листинг образов\ndocker images\n# удаление образов(IMAGE ID)\ndocker rmi 7281bf55ce46\n\n# удаление всего скриптом\n.\u002Flauncher cleanup\n",language:r,meta:s},children:[{type:a,tag:t,props:{},children:[{type:a,tag:l,props:{__ignoreMap:m},children:[{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:B},children:[{type:b,value:"# листинг контейнеров"}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:o},children:[{type:b,value:V}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"ps"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:u},children:[{type:b,value:"-a"}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:B},children:[{type:b,value:"# удаление контейнеров(CONTAINER ID)"}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:o},children:[{type:b,value:V}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"rm"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"8ee579ceabf7"}]}]},{type:a,tag:f,props:{class:g},children:[]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:B},children:[{type:b,value:"# листинг образов"}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:o},children:[{type:b,value:V}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"images"}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:B},children:[{type:b,value:"# удаление образов(IMAGE ID)"}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:o},children:[{type:b,value:V}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"rmi"}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"7281bf55ce46"}]}]},{type:a,tag:f,props:{class:g},children:[]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:B},children:[{type:b,value:"# удаление всего скриптом"}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:u},children:[{type:b,value:E}]},{type:a,tag:c,props:{class:o},children:[{type:b,value:bw}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"cleanup"}]}]}]}]}]},{type:a,tag:p,props:{},children:[{type:b,value:"Очистка системы apt."}]},{type:a,tag:l,props:{code:"apt-get autoclean\napt-get autoremove\n",language:r,meta:s},children:[{type:a,tag:t,props:{},children:[{type:a,tag:l,props:{__ignoreMap:m},children:[{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:o},children:[{type:b,value:ad}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"autoclean"}]}]},{type:a,tag:f,props:{class:g},children:[{type:a,tag:c,props:{class:o},children:[{type:b,value:ad}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:d}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"autoremove"}]}]}]}]}]},{type:a,tag:bc,children:[{type:b,value:".ct-a38fa3{color:#79C0FF}\n.ct-266b94{color:#FF7B72}\n.ct-7e5019{color:#A5D6FF}\n.ct-5fa0a6{color:#C9D1D9}\n.ct-942a8d{color:#FFA657}\n.ct-bced08{color:#8B949E}"}]}],toc:{title:m,searchDepth:y,depth:y,links:[{id:bg,depth:y,text:bh},{id:bj,depth:y,text:bk},{id:bu,depth:y,text:bv}]}},_type:bd,_id:"content:posts:fluxbb-discourse.md",_source:be,_file:"posts\u002Ffluxbb-discourse.md",_extension:bf}]},prerenderedAt:1682084467924}}("element","text","span"," ","ct-09e790","div","line","ct-5fa0a6","ct-562b78","ct-7e5019","ct-e3a178","code","","ct-2fdb93","ct-942a8d","p",";","bash",null,"pre","ct-a38fa3","  ","    ","sudo",2,"ct-ef48ff","ct-266b94","ct-bced08","li","h2",".","a","\u002F","{","listen","=",false,"root","nofollow","proxy_set_header","ul","80","        ","server_name","; ","# managed by Certbot","fluxbb","docker","mysql\u003E","tor","*","server","ctlos5lhe2vc3giixr.onion","mysql","echo","\u003E\u003E","Gemfile","apt-get","nginx","nano","\u002Fvar\u002Flib\u002Ftor\u002Fhidden_service\u002F","blockquote","systemctl","code-inline","location","on","  }","}","\"fluxbb\"","posts","Как запустить веб приложение и открыть доступность через tor в доменной зоне onion.","post","dev","установка-софта","Установка софта","yay","-S","настройка-tor","Настройка tor","генерация-onion-домена-v3","Генерация onion домена v3","https:\u002F\u002Fgithub.com\u002Fcathugger\u002Fmkp224o","git","cd","-t","~\u002Fhs-keys","-r","права-на-hidden_service","Права на hidden_service","ssh","cp","restart","настройка-nginx","Настройка nginx","\u002Fusr\u002Fshare\u002Fnginx\u002Fhtml","default_server","\u002Fetc\u002Fnginx\u002Fsites-available\u002Fonion.conf","\u002Fhome\u002Fcretm\u002Fapp\u002Fcloud.ctlos.ru"," [::]:80;","autoindex","try_files"," $uri $uri","404","add_header","Onion-Location","\"http:\u002F\u002Fctlos5lhe2vc3giixr.onion","$request_uri","\"","always","off","style","markdown","content","md","перенос-mysql","Перенос mysql","~\u002Fforum.sql","login-в-docker","Login в docker","app","install","-u","-p","CREATE","'fluxbb'@'localhost'","PRIVILEGES","su","bundle","обновление-discourse","Обновление discourse","\u002Flauncher"))