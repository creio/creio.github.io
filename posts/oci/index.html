<!DOCTYPE html>
<html lang="ru">
<head><meta charset="utf-8">
<title>Установка Arch Linux в Oracle Cloud | Alex Creio</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="icon" type="image/png" href="/favicon.png">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=JetBrains+Mono&display=swap">
<script async="" src="/js/main.js" defer="" type="text/javascript"></script>
<meta name="description" content="Personal website & blog. Web developer & linux enthusiast.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://creio.github.io/posts/oci">
<meta property="og:title" content="Установка Arch Linux в Oracle Cloud | Alex Creio">
<meta property="og:description" content="Personal website & blog. Web developer & linux enthusiast.">
<meta property="og:image" content="/cover.png"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/entry.2032ada5.js"><link rel="preload" as="style" href="/_nuxt/entry.a3f39547.css"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/default.76ee4dca.js"><link rel="preload" as="style" href="/_nuxt/BaseNavigation.9cfb5ece.css"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/nuxt-link.833a5c99.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/Icon.09c4b1dc.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/config.78e63470.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/Icon.vue.6a5092fe.js"><link rel="preload" as="style" href="/_nuxt/Icon.1086b57f.css"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/index.7a8ef3c7.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/_...slug_.6f95474a.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/Toc.af515f9e.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ContentRendererMarkdown.23f80420.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/index.a6ef77ff.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ContentRenderer.6ab3d427.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/BaseButton.vue.b4dcb821.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/query.9e3fe919.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/utils.ae9137e3.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/asyncData.17245931.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/formatDate.d39962da.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseP.5674067a.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseA.86b1a6bb.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseH2.5ae5c91a.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseCode.0957f641.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseUl.ecf274fc.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseLi.ad5fadd0.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseCodeInline.c349811c.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseH3.ed323a3b.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseBlockquote.0ac6ffe3.js"><link rel="prefetch" as="style" href="/_nuxt/error-component.e7f477b1.css"><link rel="prefetch" as="style" href="/_nuxt/BaseButton.958b4ab1.css"><link rel="prefetch" as="script" crossorigin href="/_nuxt/error-component.51f15d86.js"><link rel="stylesheet" href="/_nuxt/entry.a3f39547.css"><link rel="stylesheet" href="/_nuxt/BaseNavigation.9cfb5ece.css"><link rel="stylesheet" href="/_nuxt/Icon.1086b57f.css"><style>.page-enter-active,.page-leave-active{transition:all .125s}.page-enter-from,.page-leave-to{filter:blur(1rem);opacity:0}</style><style>.base-navigation[data-v-635f3ebf]{align-items:center;border-bottom:1px solid var(--border-color);display:flex;grid-area:"app-header";justify-content:flex-start;padding:1.5rem 2rem}@media (max-width:715px){.base-navigation[data-v-635f3ebf]{padding:1rem}}@media (max-width:510px){.base-navigation[data-v-635f3ebf]{flex-direction:column;gap:var(--sizing-xl);justify-content:center}}.base-navigation .brand-link[data-v-635f3ebf]{align-items:center;display:flex;line-height:1;text-decoration:none;text-underline-offset:0}.base-navigation__main[data-v-635f3ebf]{font-size:var(--size-step--1);font-variation-settings:"wdth" 90;letter-spacing:.1em;text-transform:uppercase}@media (min-width:511px){.base-navigation__main[data-v-635f3ebf]{font-size:var(--size-step--2);margin-left:auto}}.base-navigation__main .navigation-list[data-v-635f3ebf]{display:grid;gap:.75rem;grid-auto-columns:minmax(65px,1fr);grid-auto-flow:column;list-style:none;margin:0;padding:0}.base-navigation__main .navigation-list__item[data-v-635f3ebf]{align-items:center;display:flex;justify-content:center;margin:0;padding:0}.base-navigation__main .navigation-list__item-link[data-v-635f3ebf]{color:var(--font-color)}.base-navigation__main .active-path[data-v-635f3ebf],.base-navigation__main .router-link-active[data-v-635f3ebf]{color:var(--headline-font-color);font-weight:700;text-decoration-thickness:.4ex}.base-navigation__main.nav-fixed[data-v-635f3ebf]{background-color:var(--color-primary-hover-t);border-radius:var(--sizing-xl);left:50%;padding:var(--sizing-md) var(--sizing-xxl);position:fixed;top:var(--sizing-md);transform:translate(-50%);z-index:2}.base-navigation__main.nav-fixed .navigation-list[data-v-635f3ebf]{gap:var(--sizing-xxl);grid-auto-columns:auto}.base-navigation__main.nav-fixed .nav-switcher[data-v-635f3ebf]{display:none!important}</style><style>.brand-logo{align-items:center;display:inline-flex;gap:.5rem;justify-content:flex-start;overflow:hidden;padding:0;transition:var(--transition)}.brand-logo__image{background-color:var(--color-dark);border:1px solid var(--color-dark);border-radius:50%;flex:0 0 2rem;height:2rem;padding:0;transition:var(--transition-cubic-slow);width:2rem;z-index:10}@media (max-width:768px){.brand-logo__image{flex:0 0 1.5rem;height:1.5rem;width:1.5rem}}.brand-logo__image .circle-shape{fill:var(--color-primary);transition:var(--transition-cubic-slow)}.brand-logo__image .logo-shape{fill:var(--color-light);transition:var(--transition-cubic-slow)}.brand-logo__type{font-size:var(--size-step--1);font-variation-settings:"wdth" 90;letter-spacing:.1em;line-height:1;text-shadow:0 0 6px var(--color-primary,.6);text-transform:uppercase;transition:all .125s ease-in-out}@media (min-width:769px){.brand-logo:hover .brand-logo__image{background-color:var(--color-primary-hover);border:1px solid var(--color-primary-hover);transform:rotate(2turn)}.brand-logo:hover .brand-logo__image .circle-shape{fill:var(--color-primary)}.brand-logo:hover .brand-logo__image .logo-shape{fill:var(--color-dark)}}</style><style>.theme-switcher[data-v-95532616]{align-items:center;background-color:var(--color-middle-gray-t);border:none;border-radius:16px;color:var(--font-color);display:flex;flex-shrink:0;height:22px;justify-content:flex-start;margin:5px 0 0;overflow:hidden;padding:0;position:relative;transition:var(--transition);width:42px}.theme-switcher[data-v-95532616]:hover{background-color:var(--color-middle-gray)}.theme-switcher__toggle[data-v-95532616]{align-items:center;background-color:var(--background-color);border-radius:50%;box-shadow:0 0 3px rgba(0,0,0,.25);display:flex;height:20px;justify-content:center;transform:translate(1px);transition:var(--transition);width:20px}.theme-switcher__toggle .icon[data-v-95532616]{height:.75rem;width:.75rem}.light .theme-switcher .theme-switcher__toggle[data-v-95532616]{transform:translate(21px)}</style><style>.icon[data-v-cf1ec82f]{display:inline-block;vertical-align:middle}</style><style>.article-page[data-v-0191091b]{padding-left:0;padding-right:0}@media (min-width:1324px){.article-layout[data-v-0191091b]{display:grid;gap:var(--sizing-xl);grid-template-columns:calc(50vw - var(--max-width)/2) repeat(6,1fr) calc(50vw - var(--max-width)/2)}}@media (max-width:1323px){.article-layout[data-v-0191091b]{display:grid;gap:var(--sizing-xl);grid-template-columns:var(--sizing-xl) repeat(6,1fr) var(--sizing-xl)}}@media (max-width:881px){.article-layout[data-v-0191091b]{display:grid;gap:var(--sizing-md);grid-template-columns:var(--sizing-lg) repeat(6,1fr) var(--sizing-lg)}}.article-layout .article-header[data-v-0191091b]{display:flex;flex-direction:column;grid-column:3/span 5;grid-row:1;justify-content:center;padding-top:4rem}@media (max-width:988px){.article-layout .article-header[data-v-0191091b]{grid-column:2/span 6;grid-row:1}}.article-layout .article-body[data-v-0191091b]{font-size:var(--size-step-0);grid-column:3/span 4;grid-row:2;line-height:1.65}@media (max-width:1200px){.article-layout .article-body[data-v-0191091b]{grid-column:3/span 4;grid-row:2}}@media (max-width:988px){.article-layout .article-body[data-v-0191091b]{grid-column:2/span 6;grid-row:3}}.article-layout .article-meta[data-v-0191091b]{border-top:1px solid var(--border-color);font-size:var(--size-step--1);font-weight:400;grid-column:2/span 1;grid-row:2;padding:var(--sizing-md) 0}@media (min-width:989px){.article-layout .article-meta-block[data-v-0191091b]{-webkit-margin-after:1.5rem;margin-block-end:1.5rem}}.article-layout .article-meta .tag-list[data-v-0191091b]{list-style:none;margin:0;padding:0}@media (min-width:989px){.article-layout .article-meta[data-v-0191091b]{margin-top:.5rem}}@media (max-width:988px){.article-layout .article-meta[data-v-0191091b]{border-bottom:1px solid var(--border-color);display:grid;gap:var(--sizing-xl);grid-column:2/span 6;grid-row:2;grid-template-columns:1fr 1fr}}.article-layout .prev-next[data-v-0191091b]{grid-column:3/span 4}@media (max-width:1200px){.article-layout .prev-next[data-v-0191091b]{grid-column:3/span 4;grid-row:3}}@media (max-width:988px){.article-layout .prev-next[data-v-0191091b]{grid-column:2/span 6;grid-row:4}}[data-v-0191091b] .footnotes{border-top:1px solid var(--border-color);font-size:var(--size-step--1);margin-top:var(--sizing-xxxl)}[data-v-0191091b] sup a{background-color:var(--color-middle-gray);border-radius:2px;color:var(--color-dark);display:inline-block;font-weight:700;line-height:1;margin-left:2px;padding:3px;text-decoration:none;transition:var(--transition)}[data-v-0191091b] sup a:hover{background-color:var(--color-primary)}</style><style>.base-footer[data-v-b26cc15c]{border-top:1px solid var(--border-color);font-weight:100;grid-area:"app-footer";padding:2rem 0}@media (max-width:1052px){.base-footer[data-v-b26cc15c]{padding:2rem}}@media (max-width:715px){.base-footer[data-v-b26cc15c]{padding:1rem}}.base-footer__layout[data-v-b26cc15c]{display:flex;flex-direction:column-reverse;margin-inline:auto;max-width:var(--max-width)}@media (min-width:767px){.base-footer__layout[data-v-b26cc15c]{display:grid;gap:var(--sizing-xxl);grid-template-columns:1fr 1fr}}@media (min-width:1053px){.base-footer__layout[data-v-b26cc15c]{gap:0;grid-template-columns:repeat(28,1fr)}}@media (max-width:766px){.base-footer__layout .meta-area[data-v-b26cc15c]{-webkit-margin-after:1.5rem;margin-block-end:1.5rem}}.base-footer__layout .copyright-area[data-v-b26cc15c]{max-width:85ch}@media (min-width:767px){.base-footer__layout .copyright-area[data-v-b26cc15c]{display:flex;flex-direction:column;grid-column:1;justify-content:center}}@media (min-width:1053px){.base-footer__layout .copyright-area[data-v-b26cc15c]{grid-column:2/span 14}}.base-footer__layout .copyright-area .copyright-line[data-v-b26cc15c]{font-size:var(--size-step--1)}@media (min-width:767px){.base-footer__layout .meta-area[data-v-b26cc15c]{grid-column:2}}@media (min-width:1053px){.base-footer__layout .meta-area[data-v-b26cc15c]{grid-column:18/-2}}.base-footer .social-icons[data-v-b26cc15c]{align-items:center;display:flex;gap:.5rem;list-style:none;margin:0;padding:0}@media (min-width:767px){.base-footer .social-icons[data-v-b26cc15c]{justify-content:flex-end}}.base-footer a.footer-icon[data-v-b26cc15c]{font-size:var(--size-step--1);line-height:1}.base-footer a.footer-icon .icon[data-v-b26cc15c]{color:var(--color-middle-gray);font-size:var(--size-step-1)}.base-footer a.footer-icon:hover .icon[data-v-b26cc15c]{color:var(--color-primary)}</style><style>.toc-content[data-v-d5367bf6]{background-color:hsla(0,0%,100%,.05);border-radius:var(--sizing-sm);font-size:.9rem;max-height:80vh;overflow-y:auto;padding:var(--sizing-sm);position:sticky;top:1rem}.toc-content .toc-link[data-v-d5367bf6]{text-shadow:none}@media (max-width:988px){.toc-content .top-toc[data-v-d5367bf6]{display:none}}</style><style>.article-navigation[data-v-f1cf9aa5]{align-items:center;display:flex;display:grid;gap:var(--sizing-md);grid-template-columns:1fr 1fr 1fr;justify-content:space-between;padding:var(--sizing-xxl) 0}.prev-button[data-v-f1cf9aa5]{grid-column:1}.next-button[data-v-f1cf9aa5]{align-self:self-end;grid-column:3}</style><style>.code-container[data-v-2dc29a73]{-webkit-margin-before:1.5rem;-webkit-margin-after:1.5rem;background-color:var(--color-dark-bg-border);border-radius:var(--sizing-sm);font-size:1rem;margin-block-end:1.5rem;margin-block-start:1.5rem;margin-left:calc(var(--sizing-xl)*-1);margin-right:calc(var(--sizing-xl)*-1);overflow-x:auto;padding:0;position:relative}.code-container-header[data-v-2dc29a73]{align-items:center;border-bottom:1px solid hsla(0,0%,100%,.125);color:hsla(0,0%,100%,.5);display:flex;font-size:var(--size-step--1);justify-content:space-between;padding:var(--sizing-md) var(--sizing-lg)}.copy-container[data-v-2dc29a73]{align-items:center;display:flex;gap:var(--sizing-md)}.copy-container .copy-button[data-v-2dc29a73]{color:var(--color-light);font-size:var(--size-step-0)}pre[data-v-2dc29a73-s]{counter-reset:lines;display:flex;flex:1 1 0%;line-height:1.625;margin-bottom:0;margin-top:0;overflow-x:auto;padding:var(--sizing-xl)}pre code[data-v-2dc29a73-s]{display:flex;flex-direction:column;width:100%}pre code .line[data-v-2dc29a73-s]{display:inline-table;min-height:1rem}pre code .line[data-v-2dc29a73-s]:before{color:rgba(115,138,148,.4);content:counter(lines);counter-increment:lines;display:inline-block;font-family:var(--sans-font-family);font-size:var(--size-step--1);font-weight:400;margin-right:1.5rem;text-align:left;width:1rem}pre code .highlight[data-v-2dc29a73-s]{background-color:#363b46;border-left:.25em solid red;display:block;margin-left:-1em;margin-right:-1em;padding-left:.75em;padding-right:1em}</style></head>
<body ><div id="__nuxt"><!--[--><div class="app-layout"><header class="base-navigation" data-v-635f3ebf><a href="/" class="brand-link" data-v-635f3ebf><div class="brand-logo large" data-v-635f3ebf><svg xmlns="http://www.w3.org/2000/svg" class="brand-logo__image" viewBox="0 0 50 50"><path d="M24.984 2.986A1 1 0 0 0 24.84 3h-1.473c-.118 0-.261 0-.42.012-6.527.19-12.054 4.891-13.302 11.254l-1.588.646c-.052.021-.105.05-.153.078-.98.61-1.649 1.599-1.832 2.684a3.478 3.478 0 0 0-.068.847l.16 5.08c.044 1.099.682 2.084 1.604 2.542l.78.459c-.135 3.077-.164 5.865-.06 7.968a1 1 0 0 0 0 .002c.016.295.076.57.16.824.217.65.661 1.191 1.229 1.555a1 1 0 0 0 .016.01c.803.496 1.958 1.075 3.224 1.66.14.868.543 1.725 1.11 2.596.701 1.078 1.663 2.166 2.787 3.158C19.26 46.358 22.15 48 25.05 48c2.9 0 5.787-1.642 8.035-3.625 1.124-.992 2.085-2.08 2.787-3.158.568-.873.972-1.73 1.111-2.6 1.264-.584 2.418-1.161 3.22-1.656a1 1 0 0 0 .003-.004 2.987 2.987 0 0 0 1.398-2.387c.105-2.117.077-4.925-.06-8.025l.63-.371a3.019 3.019 0 0 0 1.663-2.584l.158-5.055a3.581 3.581 0 0 0-.062-.832 3.988 3.988 0 0 0-1.838-2.713 1.072 1.072 0 0 0-.15-.078l-1.49-.605c-1.233-6.383-6.769-11.105-13.31-11.295a5.97 5.97 0 0 0-.42-.012h-1.572a1 1 0 0 0-.17-.014zM23.367 5H24v10a1 1 0 1 0 2 0V5h.727l.085.002 1.122 12.787c-1.176.14-2.187.211-2.887.211-.718 0-1.766-.077-2.98-.225l1.12-12.771c.057-.001.101-.004.18-.004zm5.47.201c4.89.866 8.812 4.686 9.69 9.674-.003.023-.01.046-.011.068-2.496 1.264-5.777 2.085-8.6 2.557L28.838 5.201zm-7.675.016-1.076 12.267c-2.811-.475-6.058-1.296-8.53-2.552.854-4.985 4.742-8.814 9.606-9.715zm-9.844 11.726C16.054 19.176 22.19 20 25.047 20c2.857 0 8.993-.825 13.728-3.057.169 1.505.32 3.01.438 4.496-6.345 1.815-10.644 8.507-11.045 18.127-.625.136-1.247.265-1.803.33l.922-11.646a5.025 5.025 0 0 1 3.33-4.33l5.46-1.91c.92-.32 1.63-1.07 1.9-2l.57-2.01c-6.5 3-11.5 3-13.5 3-.99 0-2.72 0-5-.37-.92-.14-1.92-.35-3-.64-.33-.08-.66-.17-1-.28-.64-.19-1.31-.41-2-.67-.8-.3-1.64-.64-2.5-1.04l.57 2.01c.27.93.98 1.68 1.9 2l.03.01 2 .7 1 .35 2.43.85c.2.07.39.15.57.24 1.55.78 2.62 2.32 2.76 4.09l.922 11.646c-.556-.065-1.178-.194-1.803-.33-.401-9.62-4.7-16.312-11.045-18.127.117-1.486.269-2.99.437-4.496zm-.59 6.479c5.084 1.654 8.776 7.113 9.252 15.672-3.53-1.04-7.29-2.76-9.023-3.826a.97.97 0 0 1-.47-.797v-.004c-.134-2.704-.046-6.707.242-11.045zm28.637 0c.057.86.112 1.715.153 2.539a.963.963 0 0 0 .01.225c.154 3.245.184 6.166.08 8.285a1 1 0 0 0 0 .004.952.952 0 0 1-.462.787c-1.729 1.066-5.497 2.791-9.033 3.832.476-8.559 4.169-14.018 9.252-15.672zM34.43 39.725c-.076.133-.145.264-.235.402-.58.89-1.43 1.865-2.431 2.748C29.76 44.642 27.15 46 25.05 46c-2.1 0-4.713-1.358-6.715-3.125-1.001-.883-1.852-1.857-2.432-2.748-.088-.136-.156-.267-.23-.398 1.645.644 3.405 1.236 5.111 1.658a1 1 0 0 0 .012.004c.996.246 1.98.434 2.902.521.479.066.93.088 1.348.088.417 0 .87-.023 1.348-.088.923-.087 1.906-.275 2.902-.521 1.713-.423 3.48-1.019 5.133-1.666z" class="logo-shape"></path></svg><div class="brand-logo__type">Alex Creio</div></div></a><nav class="base-navigation__main" data-v-635f3ebf><ul class="navigation-list" data-v-635f3ebf><li class="navigation-list__item nav-switcher" data-v-635f3ebf><button class="theme-switcher" title="Toggle theme" data-v-635f3ebf data-v-95532616><div class="theme-switcher__toggle" data-v-95532616><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-95532616 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-cf1ec82f><path fill="currentColor" d="M9.822 2.238a9 9 0 0 0 11.94 11.94C20.768 18.654 16.775 22 12 22C6.477 22 2 17.523 2 12c0-4.775 3.346-8.768 7.822-9.762Zm8.342.053L19 2.5v1l-.836.209a2 2 0 0 0-1.455 1.455L16.5 6h-1l-.209-.836a2 2 0 0 0-1.455-1.455L13 3.5v-1l.836-.209A2 2 0 0 0 15.29.836L15.5 0h1l.209.836a2 2 0 0 0 1.455 1.455Zm5 5L24 7.5v1l-.836.209a2 2 0 0 0-1.455 1.455L21.5 11h-1l-.209-.836a2 2 0 0 0-1.455-1.455L18 8.5v-1l.836-.209a2 2 0 0 0 1.455-1.455L20.5 5h1l.209.836a2 2 0 0 0 1.455 1.455Z"/></svg><span class="sr-only" data-v-95532616>Dark Theme</span><!--]--><!----></div></button></li><li class="navigation-list__item" data-v-635f3ebf><a href="/" class="navigation-list__item-link" data-v-635f3ebf>Home</a></li><li class="navigation-list__item" data-v-635f3ebf><a href="/posts" class="navigation-list__item-link" data-v-635f3ebf>Blog</a></li><li class="navigation-list__item" data-v-635f3ebf><a href="/wow" class="navigation-list__item-link" data-v-635f3ebf>Полезно</a></li></ul></nav></header><!--[--><main class="article-page" data-v-0191091b><article class="article-layout" data-v-0191091b><aside class="article-meta" data-v-0191091b><div class="article-meta-block" data-v-0191091b><h4 class="eyebrow" data-v-0191091b>Опубликовано</h4><p data-v-0191091b>22 марта 2021 г.</p></div><div class="article-meta-block" data-v-0191091b><h4 class="eyebrow" data-v-0191091b>Tags</h4><ul class="tag-list" data-v-0191091b><!--[--><li data-v-0191091b><a href="/tags/archlinux" class="hover:underline" data-v-0191091b>#archlinux</a></li><!--]--></ul></div><div class="toc-content" data-v-0191091b data-v-d5367bf6><h4 class="eyebrow" data-v-d5367bf6>Содержание</h4><ul class="" data-v-d5367bf6><!--[--><li class="" data-v-d5367bf6><a class="toc-link" href="#генерация-ключей" data-v-d5367bf6>Генерация ключей</a></li><li class="" data-v-d5367bf6><a class="toc-link" href="#oracle-cloud" data-v-d5367bf6>Oracle Cloud</a></li><li class="" data-v-d5367bf6><a class="toc-link" href="#arch-bootstrap" data-v-d5367bf6>Arch bootstrap</a></li><li class="" data-v-d5367bf6><a class="toc-link" href="#монтирование-pacstrap" data-v-d5367bf6>Монтирование pacstrap</a></li><li class="" data-v-d5367bf6><a class="toc-link" href="#init-pacman" data-v-d5367bf6>Init pacman</a></li><li class="" data-v-d5367bf6><a class="toc-link" href="#добавление-пользователя" data-v-d5367bf6>Добавление пользователя</a></li><li class="" data-v-d5367bf6><a class="toc-link" href="#системные-настройки" data-v-d5367bf6>Системные настройки</a></li><li class="" data-v-d5367bf6><a class="toc-link" href="#mkinitcpio" data-v-d5367bf6>Mkinitcpio</a></li><li class="" data-v-d5367bf6><a class="toc-link" href="#создаем-hosts" data-v-d5367bf6>Создаем hosts</a></li><li class="" data-v-d5367bf6><a class="toc-link" href="#включаем-интернет" data-v-d5367bf6>Включаем интернет</a></li><li class="" data-v-d5367bf6><a class="toc-link" href="#устанавливаем-grub" data-v-d5367bf6>Устанавливаем grub</a></li><li class="" data-v-d5367bf6><a class="toc-link" href="#ssh" data-v-d5367bf6>Ssh</a></li><li class="" data-v-d5367bf6><a class="toc-link" href="#авторизация" data-v-d5367bf6>Авторизация</a></li><li class="" data-v-d5367bf6><a class="toc-link" href="#перенос" data-v-d5367bf6>Перенос</a></li><li class="" data-v-d5367bf6><a class="toc-link" href="#fstab" data-v-d5367bf6>Fstab</a></li><li class="" data-v-d5367bf6><a class="toc-link" href="#chroot" data-v-d5367bf6>Chroot</a></li><li class="" data-v-d5367bf6><a class="toc-link" href="#дополнительный-диск" data-v-d5367bf6>Дополнительный диск</a></li><li class="" data-v-d5367bf6><a class="toc-link" href="#рекомендации" data-v-d5367bf6>Рекомендации</a></li><li class="" data-v-d5367bf6><a class="toc-link" href="#итог" data-v-d5367bf6>Итог</a></li><!--]--></ul><a class="top-toc" href="#" data-v-d5367bf6>Вверх <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-d5367bf6 style="" width="1em" height="1em" viewBox="0 0 256 256" data-v-cf1ec82f><path fill="currentColor" d="M205.66 117.66a8 8 0 0 1-11.32 0L136 59.31V216a8 8 0 0 1-16 0V59.31l-58.34 58.35a8 8 0 0 1-11.32-11.32l72-72a8 8 0 0 1 11.32 0l72 72a8 8 0 0 1 0 11.32Z"/></svg></a></div></aside><header class="article-header" data-v-0191091b><h1 data-v-0191091b>Установка Arch Linux в Oracle Cloud</h1></header><!--[--><div class="article-body flow" data-v-0191091b><blockquote><!--[--><p><!--[-->PS: У меня забанили аккаунт без предупреждения :).<!--]--></p><!--]--></blockquote><p><!--[-->Существует такое предложение от Oracle Cloud, можно получить 2 сервера в минимальной комплектации навсегда и первые 30 дней тестирования более широкого функционала, нужно привязать карту с которой спишут примерно 1 евро(мне вернули практически сразу) и телефон. Доступные дистрибутивы на free тарифе: ubuntu, centos, oracle linux <a href="https://www.oracle.com/cloud/free/" rel="nofollow" target="_blank"><!--[-->oracle.com/cloud/free/<!--]--></a>.<!--]--></p><p><!--[-->После того, как я немного потрогал их кабинет задался целью развернуть у них Arch Linux, доступного образа у них нет, но я знаю о таком замечательном инструменте, как packer, все мои попытки запустить собранные packer-ом образы были не удачны. Образы практически на 100% уверен были в порядке, но я не знал как у них устроен efi загрузчик и не сообразил использовать Console Connection, об этом будет ниже <a href="https://www.packer.io/docs" rel="nofollow" target="_blank"><!--[-->www.packer.io/docs<!--]--></a>.<!--]--></p><p><!--[-->Для тех кому интересно, как залить туда custom image. В меню, Object storage - Bucket, создайте bucket, а в него загрузите образ. После этого в меню, Custom Images можно импортировать файл из бакета и уже из него создать Instance(машину).<!--]--></p><p><!--[-->Спустя примерно месяц я решил еще раз попробовать это провернуть, но доступ к функционалу Custom Images был закрыт, но я размотал его немного иначе.<!--]--></p><p><!--[-->Интерфейс, практически везде есть сноски на документацию, которую можно перевести и детальней узнать о работе. Собственно так я и знакомился с функционалом кабинета, методом тыка. На данный момент он мне даже кажется весьма удобным.<!--]--></p><blockquote><!--[--><p><!--[-->После создания машины(не важно какой), если в ней присутствует Файрвол, то открыть порты в нем мало, нужно еще открыть их в Default Security List. В меню, Networking - Virtual Cloud Networks - vcn-id - Security Lists - Default Security List vor vcn-id, иначе порты не будут доступны. Простыми словами их нужно открыть, как в Default Security List, так и на самой машине, при наличии Файрвола.<!--]--></p><!--]--></blockquote><ul><!--[--><li><!--[--><a href="https://stackoverflow.com/questions/54794217/opening-port-80-on-oracle-cloud-infrastructure-compute-node" rel="nofollow" target="_blank"><!--[-->stackoverflow.com<!--]--></a><!--]--></li><!--]--></ul><h2 id="генерация-ключей"><!--[-->Генерация ключей<!--]--></h2><p><!--[-->Локально создайте ssh ключи, если еще не сделали этого.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>ssh-keygen</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-t</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>rsa</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-b</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>4096</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-C</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>&quot;ctlos@protonmail.com&quot;</span></div></code></pre><!--]--></div><p><!--[-->Ключи упадут в <code><!--[-->~/.ssh<!--]--></code>. При создании instance(машины), импортируйте публичный ключ <code><!--[-->id_rsa.pub<!--]--></code>.<!--]--></p><h2 id="oracle-cloud"><!--[-->Oracle Cloud<!--]--></h2><p><!--[-->Создать минимальную машинку free, oracle linux 7.9, именно в ней будет swap раздел на 8G, который мы будем использовать для трансфера. Я не трогал настройки по умолчанию при создании. Авторизуемся на машине по ssh.<!--]--></p><h2 id="arch-bootstrap"><!--[-->Arch bootstrap<!--]--></h2><p><!--[-->Методы описаны в вики archlinux <a href="https://wiki.archlinux.org/index.php/Install_Arch_Linux_from_existing_Linux#Method_A:_Using_the_bootstrap_image_(recommended)" rel="nofollow" target="_blank"><!--[-->wiki.archlinux.org<!--]--></a>.<!--]--></p><p><!--[-->Копируем ссылку на bootstrap .tar.gz. Скачиваем и раскрываем архив в корень <a href="http://mirrors.evowise.com/archlinux/iso/latest/" rel="nofollow" target="_blank"><!--[-->http://mirrors.evowise.com/<!--]--></a>.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-667c91" data-v-2dc29a73-s># под root</span></div><div class="line" data-v-2dc29a73-s><span class="ct-4ee302" data-v-2dc29a73-s>cd</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>wget</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>http://mirrors.evowise.com/archlinux/iso/latest/archlinux-bootstrap-2021.03.01-x86_64.tar.gz</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>tar</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>xzf</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/archlinux-bootstrap-</span><span class="ct-4ee302" data-v-2dc29a73-s>*</span><span class="ct-8a2173" data-v-2dc29a73-s>-x86_64.tar.gz</span></div></code></pre><!--]--></div><p><!--[-->Отмонтировать swap он 8G, форматировать его в нужную фс(btrfs/ext4). В моем случае структура разделов.<!--]--></p><ul><!--[--><li><!--[-->/dev/sda1 boot, точка монтирования /boot/efi.<!--]--></li><li><!--[-->/dev/sda2 swap(8G), его использую для трансфера.<!--]--></li><li><!--[-->/dev/sda3 root(39G). На данный момент я тут с Oracle linux, в конце тут будет Arch с lts ядром.<!--]--></li><!--]--></ul><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>lsblk</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-f</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>swapoff</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-a</span></div></code></pre><!--]--></div><p><!--[-->Теперь выполняем chroot в bootstrap, в нем выполняем дальнейшие действия. Его разворачиваем для доступа к pacstrap и arch-chroot, основная и единственная задача. Он сам смонтирует нужные бинды, но нужно еще выполнить pacman init и раскомментировать зеркала(первые 3 Worldwide <a href="https://wiki.archlinux.org/index.php/Install_Arch_Linux_from_existing_Linux#Using_a_chroot_environment" rel="nofollow" target="_blank"><!--[-->Using_a_chroot_environment<!--]--></a>.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>nano</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/root.x86_64/etc/pacman.d/mirrorlist</span></div></code></pre><!--]--></div><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>ls</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/</span></div><div class="line" data-v-2dc29a73-s></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>/root.x86_64/bin/arch-chroot</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/root.x86_64</span></div><div class="line" data-v-2dc29a73-s></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>pacman-key</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>--init</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>pacman-key</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>--populate</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>pacman</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-Syy</span></div></code></pre><!--]--></div><h2 id="монтирование-pacstrap"><!--[-->Монтирование pacstrap<!--]--></h2><p><!--[-->Форматируем, создаем нужные директории, снапшоты, монтируем. Обратите внимание boot я не форматирую, а просто перемонтирую и удалю из него загрузчик /boot/efi/EFI/redhat.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>mkfs.btrfs</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-f</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-L</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>&quot;root&quot;</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/dev/sda2</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>mount</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/dev/sda2</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/mnt</span></div><div class="line" data-v-2dc29a73-s></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>btrfs</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>subvolume</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>create</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/mnt/@</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>btrfs</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>subvolume</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>create</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/mnt/@home</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>btrfs</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>subvolume</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>create</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/mnt/@snapshots</span></div><div class="line" data-v-2dc29a73-s></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>umount</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/mnt</span></div><div class="line" data-v-2dc29a73-s></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>mount</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-o</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>subvol=@,compress=lzo,relatime,space_cache,autodefrag</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/dev/sda2</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/mnt</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>mkdir</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-p</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/mnt/{boot/efi,home,snapshots}</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>mount</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-o</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>subvol=@home,compress=lzo,relatime,space_cache,autodefrag</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/dev/sda2</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/mnt/home</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>mount</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-o</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>subvol=@snapshots,compress=lzo,relatime,space_cache,autodefrag</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/dev/sda2</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/mnt/snapshots</span></div><div class="line" data-v-2dc29a73-s></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>umount</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/dev/sda1</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>mount</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/dev/sda1</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/mnt/boot/efi</span></div></code></pre><!--]--></div><p><!--[-->Разворачиваем будущую систему с нужными пакетами, некоторые из них очень важны. Генерируем fstab и выполняем еще один chroot(да-да).<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>pacstrap</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/mnt</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>base</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>base-devel</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>linux-lts</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>linux-lts-headers</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>btrfs-progs</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>nano</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>grub</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>efibootmgr</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>iproute2</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>iputils</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>rng-tools</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>open-iscsi</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>arch-install-scripts</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>pacman-contrib</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>reflector</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>openssh</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>wget</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>git</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>rsync</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>gnu-netcat</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>pv</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>unzip</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>unrar</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>p7zip</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>zsh</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>htop</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>tmux</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>psmisc</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>procps-ng</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>genfstab</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-pU</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/mnt</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-3d5b48" data-v-2dc29a73-s>&gt;&gt;</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/mnt/etc/fstab</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>arch-chroot</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/mnt</span></div></code></pre><!--]--></div><h2 id="init-pacman"><!--[-->Init pacman<!--]--></h2><p><!--[-->Проинициализируем pacman, отсортируем зеркала и включаем mitilib репозиторий.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>reflector</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-a</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>12</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-l</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>30</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-f</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>30</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-p</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>https,http</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>--sort</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>rate</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>--save</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/etc/pacman.d/mirrorlist</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>pacman-key</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>--init</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>pacman-key</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>--populate</span></div><div class="line" data-v-2dc29a73-s></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>sed</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-i</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>&quot;/[multilib]/,/Include/&quot;&#39;s/^#//&#39;</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/etc/pacman.conf</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>pacman</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-Syy</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>--noconfirm</span></div></code></pre><!--]--></div><h2 id="добавление-пользователя"><!--[-->Добавление пользователя<!--]--></h2><p><!--[-->Назначим рут пароль, добавляем пользователя с нужными группами, включаем ему zsh. Назначаем пароль пользователю и включаем sudo.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>usermod</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-p</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>123</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>root</span></div><div class="line" data-v-2dc29a73-s></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>useradd</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-m</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-g</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>users</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-G</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>&quot;log,network,storage,power,wheel&quot;</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-s</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/bin/zsh</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>creio</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>usermod</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-p</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>123</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>creio</span></div><div class="line" data-v-2dc29a73-s><span class="ct-4ee302" data-v-2dc29a73-s>echo</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>&quot;%wheel ALL=(ALL) ALL&quot;</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-3d5b48" data-v-2dc29a73-s>&gt;&gt;</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/etc/sudoers</span></div></code></pre><!--]--></div><h2 id="системные-настройки"><!--[-->Системные настройки<!--]--></h2><p><!--[-->Назначаем имя машины, часовой пояс, локали и русский шрифт в консоли.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-4ee302" data-v-2dc29a73-s>echo</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>cloud</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-3d5b48" data-v-2dc29a73-s>&gt;</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/etc/hostname</span></div><div class="line" data-v-2dc29a73-s></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>ln</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-svf</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/usr/share/zoneinfo/Europe/Moscow</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/etc/localtime</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>hwclock</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>--systohc</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>--utc</span></div><div class="line" data-v-2dc29a73-s></div><div class="line" data-v-2dc29a73-s><span class="ct-4ee302" data-v-2dc29a73-s>echo</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>&quot;en_US.UTF-8 UTF-8&quot;</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-3d5b48" data-v-2dc29a73-s>&gt;</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/etc/locale.gen</span></div><div class="line" data-v-2dc29a73-s><span class="ct-4ee302" data-v-2dc29a73-s>echo</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>&quot;ru_RU.UTF-8 UTF-8&quot;</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-3d5b48" data-v-2dc29a73-s>&gt;&gt;</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/etc/locale.gen</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>locale-gen</span></div><div class="line" data-v-2dc29a73-s></div><div class="line" data-v-2dc29a73-s><span class="ct-4ee302" data-v-2dc29a73-s>echo</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>&quot;LANG=ru_RU.UTF-8&quot;</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-3d5b48" data-v-2dc29a73-s>&gt;</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/etc/locale.conf</span></div><div class="line" data-v-2dc29a73-s><span class="ct-4ee302" data-v-2dc29a73-s>echo</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>&quot;KEYMAP=ru&quot;</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-3d5b48" data-v-2dc29a73-s>&gt;</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/etc/vconsole.conf</span></div><div class="line" data-v-2dc29a73-s><span class="ct-4ee302" data-v-2dc29a73-s>echo</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>&quot;FONT=cyr-sun16&quot;</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-3d5b48" data-v-2dc29a73-s>&gt;&gt;</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/etc/vconsole.conf</span></div></code></pre><!--]--></div><h2 id="mkinitcpio"><!--[-->Mkinitcpio<!--]--></h2><p><!--[-->Изменить строку HOOKS в файле /etc/mkinitcpio.conf, должно быть так. Важно! Не знаю почему, но с хуком udev отказывается стартовать init, поэтому обязательно замените его на systemd и удаляю fsck, так как btrfs.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-402795" data-v-2dc29a73-s>HOOKS</span><span class="ct-3d5b48" data-v-2dc29a73-s>=</span><span class="ct-402795" data-v-2dc29a73-s>(</span><span class="ct-8a2173" data-v-2dc29a73-s>base</span><span class="ct-402795" data-v-2dc29a73-s> systemd autodetect modconf block filesystems keyboard keymap)</span></div></code></pre><!--]--></div><p><!--[-->Обновить initramfs.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>mkinitcpio</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-P</span></div></code></pre><!--]--></div><p><!--[-->Если проебали с хуком, то попадете в rootfs и можно принудительно назначить инит и включить его.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>ln</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-s</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/lib/systemd/systemd</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/new_root/bin/init</span></div><div class="line" data-v-2dc29a73-s></div><div class="line" data-v-2dc29a73-s><span class="ct-4ee302" data-v-2dc29a73-s>exec</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>switch_root</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/new_root</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/bin/init</span></div></code></pre><!--]--></div><h2 id="создаем-hosts"><!--[-->Создаем hosts<!--]--></h2><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>cat</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-3d5b48" data-v-2dc29a73-s>&lt;&lt;</span><span class="ct-8a2173" data-v-2dc29a73-s>EOF &gt;/etc/hosts</span></div><div class="line" data-v-2dc29a73-s><span class="ct-8a2173" data-v-2dc29a73-s>127.0.0.1       localhost</span></div><div class="line" data-v-2dc29a73-s><span class="ct-8a2173" data-v-2dc29a73-s>::1             localhost</span></div><div class="line" data-v-2dc29a73-s><span class="ct-8a2173" data-v-2dc29a73-s>127.0.1.1       cloud.localdomain cloud</span></div><div class="line" data-v-2dc29a73-s><span class="ct-8a2173" data-v-2dc29a73-s>EOF</span></div></code></pre><!--]--></div><h2 id="включаем-интернет"><!--[-->Включаем интернет<!--]--></h2><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>cat</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-3d5b48" data-v-2dc29a73-s>&lt;&lt;</span><span class="ct-8a2173" data-v-2dc29a73-s>EOF &gt;/etc/systemd/network/20-ethernet.network</span></div><div class="line" data-v-2dc29a73-s><span class="ct-8a2173" data-v-2dc29a73-s>[Match]</span></div><div class="line" data-v-2dc29a73-s><span class="ct-8a2173" data-v-2dc29a73-s>Name=en*</span></div><div class="line" data-v-2dc29a73-s><span class="ct-8a2173" data-v-2dc29a73-s>Name=eth*</span></div><div class="line" data-v-2dc29a73-s></div><div class="line" data-v-2dc29a73-s><span class="ct-8a2173" data-v-2dc29a73-s>[Network]</span></div><div class="line" data-v-2dc29a73-s><span class="ct-8a2173" data-v-2dc29a73-s>DHCP=yes</span></div><div class="line" data-v-2dc29a73-s><span class="ct-8a2173" data-v-2dc29a73-s>EOF</span></div><div class="line" data-v-2dc29a73-s></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>systemctl</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>enable</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>systemd-networkd</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>systemctl</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>enable</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>systemd-resolved</span></div><div class="line" data-v-2dc29a73-s><span class="ct-667c91" data-v-2dc29a73-s># Workaround for https://bugs.archlinux.org/task/58355</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>systemctl</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>enable</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>rngd</span></div></code></pre><!--]--></div><h2 id="устанавливаем-grub"><!--[-->Устанавливаем grub<!--]--></h2><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>grub-install</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>--target=x86_64-efi</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>--efi-directory=/boot/efi</span></div></code></pre><!--]--></div><p><!--[-->Grub.cfg приводим к такому виду, все остальное закомментировано(#)<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>nano</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/etc/default/grub</span></div><div class="line" data-v-2dc29a73-s></div><div class="line" data-v-2dc29a73-s><span class="ct-402795" data-v-2dc29a73-s>GRUB_DEFAULT</span><span class="ct-3d5b48" data-v-2dc29a73-s>=</span><span class="ct-4ee302" data-v-2dc29a73-s>0</span></div><div class="line" data-v-2dc29a73-s><span class="ct-402795" data-v-2dc29a73-s>GRUB_TIMEOUT</span><span class="ct-3d5b48" data-v-2dc29a73-s>=</span><span class="ct-4ee302" data-v-2dc29a73-s>0</span></div><div class="line" data-v-2dc29a73-s><span class="ct-402795" data-v-2dc29a73-s>GRUB_DISTRIBUTOR</span><span class="ct-3d5b48" data-v-2dc29a73-s>=</span><span class="ct-8a2173" data-v-2dc29a73-s>&quot;Arch&quot;</span></div><div class="line" data-v-2dc29a73-s><span class="ct-402795" data-v-2dc29a73-s>GRUB_CMDLINE_LINUX_DEFAULT</span><span class="ct-3d5b48" data-v-2dc29a73-s>=</span><span class="ct-8a2173" data-v-2dc29a73-s>&quot;console=tty1 console=ttyS0 nvme.shutdown_timeout=10 libiscsi.debug_libiscsi_eh=1 quiet&quot;</span></div><div class="line" data-v-2dc29a73-s><span class="ct-402795" data-v-2dc29a73-s>GRUB_CMDLINE_LINUX</span><span class="ct-3d5b48" data-v-2dc29a73-s>=</span><span class="ct-8a2173" data-v-2dc29a73-s>&quot;&quot;</span></div><div class="line" data-v-2dc29a73-s><span class="ct-402795" data-v-2dc29a73-s>GRUB_PRELOAD_MODULES</span><span class="ct-3d5b48" data-v-2dc29a73-s>=</span><span class="ct-8a2173" data-v-2dc29a73-s>&quot;part_gpt part_msdos&quot;</span></div></code></pre><!--]--></div><p><!--[-->Генерируем конфиг grub.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>grub-mkconfig</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-o</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/boot/grub/grub.cfg</span></div></code></pre><!--]--></div><p><!--[-->Удаляем дефолт загрузчик.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>rm</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-rf</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/mnt/boot/efi/EFI/redhat</span></div></code></pre><!--]--></div><p><!--[-->Так как мы снесли дефолтный загрузчик, нужно подсунуть нужный файл efi для автоматической загрузки.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-4ee302" data-v-2dc29a73-s>echo</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>&quot;EFIarchgrubx64.efi&quot;</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-3d5b48" data-v-2dc29a73-s>&gt;</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/boot/efi/startup.nsh</span></div></code></pre><!--]--></div><h2 id="ssh"><!--[-->Ssh<!--]--></h2><p><!--[-->Раскомментируем строки и приведем их к такому виду.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>nano</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/etc/ssh/sshd_config</span></div></code></pre><!--]--></div><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>PermitRootLogin</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>yes</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>PubkeyAuthentication</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>yes</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>PasswordAuthentication</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>yes</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>UseDNS</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>no</span></div></code></pre><!--]--></div><p><!--[-->Включаем сервис.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>systemctl</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>enable</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>sshd</span></div></code></pre><!--]--></div><p><!--[-->Выходим из chroot раздела(sda2) <code><!--[-->exit<!--]--></code>. Отмантируем разделы.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>umount</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-R</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/mnt</span></div></code></pre><!--]--></div><p><!--[-->И еще раз exit выходим из archlinux-bootstrap(/root.x86_64).<!--]--></p><blockquote><!--[--><p><!--[-->Следующий шаг важен, он мне сильно помог в отладке, так как доступ получаем выше самой машины, очень удобно.<!--]--></p><!--]--></blockquote><p><!--[-->Перейдите в нужный instance и создайте на вкладке Console Connection подключение ssh, импортируйте открытый ключid_rsa.pub. После активации подключения в меню(3 точки справа) скопируйте Copy Serial Console Connection for Linux/Mac данные, вставьте данные из буфера в новый терминал.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>ssh</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-o</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>ProxyCommand=&#39;ssh -W %h:%p -p 443 ocid1.instnection.oc1.eu-frankfurt-1.antheljtuhavnyqwertyrey@instance-console.eu-frankfurt-1.oraclecloud.com&#39;</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>ocid1.instance.oc1.eu-frankfurt-1.qwretfhjczsdfetrydfgdfsfd</span></div><div class="line" data-v-2dc29a73-s></div><div class="line" data-v-2dc29a73-s><span class="ct-667c91" data-v-2dc29a73-s># прожать Enter</span></div></code></pre><!--]--></div><p><!--[-->В исходном терминале, перезагружаем машину.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>systemctl</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>reboot</span></div></code></pre><!--]--></div><p><!--[-->В терминале с <code><!--[-->ssh -o ProxyCommand<!--]--></code> должны увидеть efi меню, которое выполнит скрипт <code><!--[-->/boot/efi/startup.nsh<!--]--></code>(5 секунд) и запустит grub, grub не увидим, так как он выставлен в 0.<!--]--></p><h3 id="efishell"><!--[-->Efishell<!--]--></h3><p><!--[-->Если что-то выполнили не так увидите <code><!--[-->efishell&gt;<!--]--></code>, некоторые команды.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-667c91" data-v-2dc29a73-s># карта</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>map</span></div><div class="line" data-v-2dc29a73-s><span class="ct-667c91" data-v-2dc29a73-s># меню</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>bcfg</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>boot</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>dump</span></div><div class="line" data-v-2dc29a73-s><span class="ct-667c91" data-v-2dc29a73-s># переход в раздел</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>FS0:</span></div><div class="line" data-v-2dc29a73-s><span class="ct-667c91" data-v-2dc29a73-s># посмотреть созданный efi файл</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>ls</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>EFIarch</span></div><div class="line" data-v-2dc29a73-s><span class="ct-667c91" data-v-2dc29a73-s># запустить</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>EFIarchgrubx64.efi</span></div><div class="line" data-v-2dc29a73-s><span class="ct-667c91" data-v-2dc29a73-s># выход в псевдографику</span></div><div class="line" data-v-2dc29a73-s><span class="ct-4ee302" data-v-2dc29a73-s>exit</span></div><div class="line" data-v-2dc29a73-s><span class="ct-667c91" data-v-2dc29a73-s># добавляет пунк, работает до ребута</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>bcfg</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>boot</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>add</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>0</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>FS0:EFIarchgrubx64.efi</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>&quot;Arch lts&quot;</span></div></code></pre><!--]--></div><blockquote><!--[--><p><!--[-->Именно по причине того, что загрузчик слетает и используется /boot/efi/startup.nsh, именно поэтому и не стартовал мой custom image о котором я говорил в начале.<!--]--></p><!--]--></blockquote><h2 id="авторизация"><!--[-->Авторизация<!--]--></h2><p><!--[-->Если все нормально, копируем ключ в root-а и юзера, в моем случае creio.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>cat</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>.ssh/id_rsa.pub</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-3d5b48" data-v-2dc29a73-s>|</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-068da8" data-v-2dc29a73-s>ssh</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>root@192.168.1.35</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>&#39;mkdir -p ~/.ssh &amp;&amp; cat &gt;&gt; .ssh/authorized_keys&#39;</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>cat</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>.ssh/id_rsa.pub</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-3d5b48" data-v-2dc29a73-s>|</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-068da8" data-v-2dc29a73-s>ssh</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>creio@192.168.1.35</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>&#39;mkdir -p ~/.ssh &amp;&amp; cat &gt;&gt; .ssh/authorized_keys&#39;</span></div></code></pre><!--]--></div><p><!--[-->Выполняем вход.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>ssh</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>creio@192.168.1.35</span></div></code></pre><!--]--></div><p><!--[-->Должны увидеть меню zsh, нажать 0.<!--]--></p><h2 id="перенос"><!--[-->Перенос<!--]--></h2><p><!--[-->Форматируем и монтируем sda3. Создаем снапшоты.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>lsblk</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-f</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>mkfs.btrfs</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-f</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-L</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>&quot;root&quot;</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/dev/sda3</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>mount</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/dev/sda3</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/mnt</span></div><div class="line" data-v-2dc29a73-s></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>btrfs</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>subvolume</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>create</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/mnt/@</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>btrfs</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>subvolume</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>create</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/mnt/@home</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>btrfs</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>subvolume</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>create</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/mnt/@snapshots</span></div><div class="line" data-v-2dc29a73-s></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>umount</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/mnt</span></div><div class="line" data-v-2dc29a73-s></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>mount</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-o</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>subvol=@,compress=lzo,relatime,space_cache,autodefrag</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/dev/sda3</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/mnt</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>mkdir</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-p</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/mnt/{boot/efi,home,snapshots}</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>mount</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-o</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>subvol=@home,compress=lzo,relatime,space_cache,autodefrag</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/dev/sda3</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/mnt/home</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>mount</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-o</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>subvol=@snapshots,compress=lzo,relatime,space_cache,autodefrag</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/dev/sda3</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/mnt/snapshots</span></div><div class="line" data-v-2dc29a73-s></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>umount</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/dev/sda1</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>mount</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/dev/sda1</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/mnt/boot/efi</span></div></code></pre><!--]--></div><p><!--[-->Копируем текущий корень в /mnt.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>rsync</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-cauv</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>--info=stats2</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>--exclude=</span><span class="ct-402795" data-v-2dc29a73-s>{</span><span class="ct-8a2173" data-v-2dc29a73-s>&quot;/dev/*&quot;</span><span class="ct-402795" data-v-2dc29a73-s>,</span><span class="ct-8a2173" data-v-2dc29a73-s>&quot;/proc/*&quot;</span><span class="ct-402795" data-v-2dc29a73-s>,</span><span class="ct-8a2173" data-v-2dc29a73-s>&quot;/sys/*&quot;</span><span class="ct-402795" data-v-2dc29a73-s>,</span><span class="ct-8a2173" data-v-2dc29a73-s>&quot;/tmp/*&quot;</span><span class="ct-402795" data-v-2dc29a73-s>,</span><span class="ct-8a2173" data-v-2dc29a73-s>&quot;/run/*&quot;</span><span class="ct-402795" data-v-2dc29a73-s>,</span><span class="ct-8a2173" data-v-2dc29a73-s>&quot;/mnt/*&quot;</span><span class="ct-402795" data-v-2dc29a73-s>,</span><span class="ct-8a2173" data-v-2dc29a73-s>&quot;/media/*&quot;</span><span class="ct-402795" data-v-2dc29a73-s>,</span><span class="ct-8a2173" data-v-2dc29a73-s>&quot;/lost+found&quot;</span><span class="ct-402795" data-v-2dc29a73-s>,</span><span class="ct-8a2173" data-v-2dc29a73-s>&quot;/var/lib/pacman/sync/*&quot;</span><span class="ct-402795" data-v-2dc29a73-s>,</span><span class="ct-8a2173" data-v-2dc29a73-s>&quot;/var/cache/*&quot;</span><span class="ct-402795" data-v-2dc29a73-s>,</span><span class="ct-8a2173" data-v-2dc29a73-s>&quot;/var/tmp/*&quot;</span><span class="ct-402795" data-v-2dc29a73-s>} /</span><span class="ct-3d5b48" data-v-2dc29a73-s>*</span><span class="ct-402795" data-v-2dc29a73-s> /mnt/</span></div></code></pre><!--]--></div><h2 id="fstab"><!--[-->Fstab<!--]--></h2><p><!--[-->Узнаем UUID разделов.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>lsblk</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-f</span></div></code></pre><!--]--></div><p><!--[-->Изменить fstab, nano /mnt/etc/fstab. Загрузчик не изменился, только UUID субволумов.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-667c91" data-v-2dc29a73-s># /dev/sda1</span></div><div class="line" data-v-2dc29a73-s><span class="ct-402795" data-v-2dc29a73-s>UUID</span><span class="ct-3d5b48" data-v-2dc29a73-s>=</span><span class="ct-4ee302" data-v-2dc29a73-s>2138</span><span class="ct-8a2173" data-v-2dc29a73-s>-EC84</span><span class="ct-402795" data-v-2dc29a73-s>                               /boot/efi      vfat    defaults  </span><span class="ct-4ee302" data-v-2dc29a73-s>0</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>0</span></div><div class="line" data-v-2dc29a73-s></div><div class="line" data-v-2dc29a73-s><span class="ct-667c91" data-v-2dc29a73-s># /dev/sda3</span></div><div class="line" data-v-2dc29a73-s><span class="ct-402795" data-v-2dc29a73-s>UUID</span><span class="ct-3d5b48" data-v-2dc29a73-s>=</span><span class="ct-8a2173" data-v-2dc29a73-s>39b2a28d-</span><span class="ct-4ee302" data-v-2dc29a73-s>3890</span><span class="ct-8a2173" data-v-2dc29a73-s>-425b-</span><span class="ct-4ee302" data-v-2dc29a73-s>8152</span><span class="ct-8a2173" data-v-2dc29a73-s>-fed18a73fdcd</span><span class="ct-402795" data-v-2dc29a73-s>    /              btrfs   subvol</span><span class="ct-3d5b48" data-v-2dc29a73-s>=</span><span class="ct-8a2173" data-v-2dc29a73-s>@,defaults,noatime,space_cache,autodefrag</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>0</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>0</span></div><div class="line" data-v-2dc29a73-s></div><div class="line" data-v-2dc29a73-s><span class="ct-667c91" data-v-2dc29a73-s># /dev/sda3</span></div><div class="line" data-v-2dc29a73-s><span class="ct-402795" data-v-2dc29a73-s>UUID</span><span class="ct-3d5b48" data-v-2dc29a73-s>=</span><span class="ct-8a2173" data-v-2dc29a73-s>39b2a28d-</span><span class="ct-4ee302" data-v-2dc29a73-s>3890</span><span class="ct-8a2173" data-v-2dc29a73-s>-425b-</span><span class="ct-4ee302" data-v-2dc29a73-s>8152</span><span class="ct-8a2173" data-v-2dc29a73-s>-fed18a73fdcd</span><span class="ct-402795" data-v-2dc29a73-s>    /home          btrfs   subvol</span><span class="ct-3d5b48" data-v-2dc29a73-s>=</span><span class="ct-8a2173" data-v-2dc29a73-s>@home,defaults,noatime,space_cache,autodefrag</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>0</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>0</span></div><div class="line" data-v-2dc29a73-s></div><div class="line" data-v-2dc29a73-s><span class="ct-667c91" data-v-2dc29a73-s># /dev/sda3</span></div><div class="line" data-v-2dc29a73-s><span class="ct-402795" data-v-2dc29a73-s>UUID</span><span class="ct-3d5b48" data-v-2dc29a73-s>=</span><span class="ct-8a2173" data-v-2dc29a73-s>39b2a28d-</span><span class="ct-4ee302" data-v-2dc29a73-s>3890</span><span class="ct-8a2173" data-v-2dc29a73-s>-425b-</span><span class="ct-4ee302" data-v-2dc29a73-s>8152</span><span class="ct-8a2173" data-v-2dc29a73-s>-fed18a73fdcd</span><span class="ct-402795" data-v-2dc29a73-s>    /snapshots     btrfs   subvol</span><span class="ct-3d5b48" data-v-2dc29a73-s>=</span><span class="ct-8a2173" data-v-2dc29a73-s>@snapshots,defaults,noatime,space_cache,autodefrag</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>0</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>0</span></div></code></pre><!--]--></div><h2 id="chroot"><!--[-->Chroot<!--]--></h2><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>arch-chroot</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/mnt</span></div></code></pre><!--]--></div><p><!--[-->Переустановим и сконфигурируем grub.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>grub-install</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>--target=x86_64-efi</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>--efi-directory=/boot/efi</span></div><div class="line" data-v-2dc29a73-s></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>grub-mkconfig</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-o</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/boot/grub/grub.cfg</span></div></code></pre><!--]--></div><p><!--[-->Посмотрим на правильность UUID. Везде должен быть id sda3.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>cat</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/boot/grub/grub.cfg</span></div><div class="line" data-v-2dc29a73-s></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>lsblk</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-f</span></div></code></pre><!--]--></div><p><!--[-->Выходим из chroot, отмонтируем, ребут.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-4ee302" data-v-2dc29a73-s>exit</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>umount</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-R</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/mnt</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>systemctl</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>reboot</span></div></code></pre><!--]--></div><p><!--[-->Опять, можем запустить <code><!--[-->ssh -o ProxyCommand<!--]--></code>(прожать Enter) и наблюдать за работой efi, если все ровно, выполняем вход. Теперь можно отформатировать sda2 в swap и подключить его в fstab.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>mkswap</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/dev/sda2</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>swapon</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/dev/sda2</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>swapon</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>--show</span></div></code></pre><!--]--></div><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>lsblk</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-f</span></div><div class="line" data-v-2dc29a73-s></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>nano</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/etc/fstab</span></div><div class="line" data-v-2dc29a73-s></div><div class="line" data-v-2dc29a73-s><span class="ct-667c91" data-v-2dc29a73-s># добавить в конец с новой строки</span></div><div class="line" data-v-2dc29a73-s><span class="ct-667c91" data-v-2dc29a73-s># /dev/sda2</span></div><div class="line" data-v-2dc29a73-s><span class="ct-402795" data-v-2dc29a73-s>UUID</span><span class="ct-3d5b48" data-v-2dc29a73-s>=</span><span class="ct-8a2173" data-v-2dc29a73-s>6a1059e2-6fd0-</span><span class="ct-4ee302" data-v-2dc29a73-s>4894</span><span class="ct-8a2173" data-v-2dc29a73-s>-bb14-53ff59754145</span><span class="ct-402795" data-v-2dc29a73-s>    none           swap    defaults    </span><span class="ct-4ee302" data-v-2dc29a73-s>0</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>0</span></div></code></pre><!--]--></div><h2 id="дополнительный-диск"><!--[-->Дополнительный диск<!--]--></h2><p><!--[-->Отредактируйте файл <code><!--[-->/etc/iscsi/iscsid.conf<!--]--></code>, как указано в help <a href="https://docs.oracle.com/en-us/iaas/Content/Block/Concepts/iscsiinformation.htm" rel="nofollow" target="_blank"><!--[-->iscsiinformation.htm<!--]--></a>. На вкладке boot volumes можно создать дополнительный диск, клонировать существующий. После этого добавить на машине в автостарт и запустить сервис.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>sudo</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>systemctl</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>enable</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>--now</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>iscsid</span></div><div class="line" data-v-2dc29a73-s><span class="ct-667c91" data-v-2dc29a73-s># включаем авторизацию</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>sudo</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>systemctl</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>enable</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>iscsi</span></div></code></pre><!--]--></div><p><!--[-->Зайти в свой Instances и в левом меню на вкладку Attached Block Volumes, присоединить клонированный диск, когда он перейдет в состояние Attached в правом меню открыть пункт iSCSI Commands &amp; Information. Скопировать 3 команды(iscsiadm) на подключение и выполнить их на своей машине(по строчно) от пользователя.<!--]--></p><p><!--[-->В поле ниже, соответственно команды на отключение.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>lsblk</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-f</span></div></code></pre><!--]--></div><p><!--[-->Форматируем данный диск на свое усмотрение и прописываем, если нужно в fstab.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-667c91" data-v-2dc29a73-s># создаем таблицу и раздел/разделы</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>sudo</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>cfdisk</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-z</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/dev/sdb</span></div></code></pre><!--]--></div><p><!--[-->Я выбрал gpt, затем создал раздел по умолчанию на все пространство(46,6G), enter - enter - enter, курсор вправо(записать) - yes - enter, курсор влево(выход). Форматируем в ext4 с меткой files.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>sudo</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>mkfs.ext4</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/dev/sdb1</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-L</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>files</span></div></code></pre><!--]--></div><p><!--[-->Добавляю в fstab.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>sudo</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>mkdir</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-p</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/media/files</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>lsblk</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-f</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>sudo</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>nano</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/etc/fstab</span></div><div class="line" data-v-2dc29a73-s></div><div class="line" data-v-2dc29a73-s><span class="ct-667c91" data-v-2dc29a73-s># /dev/sdb1</span></div><div class="line" data-v-2dc29a73-s><span class="ct-402795" data-v-2dc29a73-s>UUID</span><span class="ct-3d5b48" data-v-2dc29a73-s>=</span><span class="ct-8a2173" data-v-2dc29a73-s>702c830e-efb9-403d-bdfc-b3a969d44b1f</span><span class="ct-402795" data-v-2dc29a73-s>    /media/files   ext4    defaults,_netdev,x-systemd.requires</span><span class="ct-3d5b48" data-v-2dc29a73-s>=</span><span class="ct-8a2173" data-v-2dc29a73-s>iscsid.service</span><span class="ct-402795" data-v-2dc29a73-s>  </span><span class="ct-4ee302" data-v-2dc29a73-s>0</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>1</span></div></code></pre><!--]--></div><p><!--[-->Перезагружаюсь и вижу по пути <code><!--[-->/media/files<!--]--></code> чистый раздел, под любые нужды.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>sudo</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>systemctl</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>reboot</span></div></code></pre><!--]--></div><p><!--[-->Дадим полные права в директорию для юзера.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>sudo</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>chown</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-R</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>$(</span><span class="ct-068da8" data-v-2dc29a73-s>whoami</span><span class="ct-8a2173" data-v-2dc29a73-s>):users</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/media/files</span></div></code></pre><!--]--></div><blockquote><!--[--><p><!--[-->Вы наверно догадались, что можно было сразу подключить второй диск и развернуть на него, тем самым опустить момент с переносом раздела(rsync), я это специально сделал, чтобы показать больше.<!--]--></p><!--]--></blockquote><h2 id="рекомендации"><!--[-->Рекомендации<!--]--></h2><h3 id="уменьшение-журнала-systemd"><!--[-->Уменьшение журнала Systemd<!--]--></h3><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>sudo</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>nano</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/etc/systemd/journald.conf</span></div></code></pre><!--]--></div><p><!--[-->Раскомментировать и изменить строку.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-402795" data-v-2dc29a73-s>SystemMaxUse</span><span class="ct-3d5b48" data-v-2dc29a73-s>=</span><span class="ct-8a2173" data-v-2dc29a73-s>100M</span></div></code></pre><!--]--></div><p><!--[-->Перезапустите сервис.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>sudo</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>systemctl</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>restart</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>systemd-journald.service</span></div></code></pre><!--]--></div><h3 id="увеличить-tmp"><!--[-->Увеличить /tmp<!--]--></h3><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>df</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-h</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/tmp</span></div><div class="line" data-v-2dc29a73-s></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>sudo</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>mount</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-o</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>remount,size=2G</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/tmp</span></div></code></pre><!--]--></div><h3 id="kexec"><!--[-->Kexec<!--]--></h3><p><!--[-->Это полезно при обновлении ядра, можно очень быстро перезагрузить его, не дожидаясь завершения всего процесса загрузки BIOS. Наглядно видно, при доступном обновление ядра <a href="https://wiki.archlinux.org/index.php/Kexec" rel="nofollow" target="_blank"><!--[-->wiki.archlinux.org/index.php/Kexec<!--]--></a>.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>yay</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-S</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>kexec-tools</span></div><div class="line" data-v-2dc29a73-s><span class="ct-667c91" data-v-2dc29a73-s># версия ядра</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>uname</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-a</span></div><div class="line" data-v-2dc29a73-s><span class="ct-667c91" data-v-2dc29a73-s># полное обновление</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>yay</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-Syyuu</span></div><div class="line" data-v-2dc29a73-s><span class="ct-667c91" data-v-2dc29a73-s># загрузка нового ядра</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>sudo</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>kexec</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-l</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/boot/vmlinuz-linux-lts</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>--initrd=/boot/initramfs-linux-lts.img</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>--reuse-cmdline</span></div><div class="line" data-v-2dc29a73-s><span class="ct-667c91" data-v-2dc29a73-s># частичный ребут</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>sudo</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>systemctl</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>kexec</span></div><div class="line" data-v-2dc29a73-s><span class="ct-667c91" data-v-2dc29a73-s># справка</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>sudo</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>kexec</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-h</span></div></code></pre><!--]--></div><h3 id="swapfile"><!--[-->Swapfile<!--]--></h3><p><!--[-->Можно отключить раздел swap и использовать файл на 4G в btrfs.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>truncate</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-s</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>0</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/swapfile</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>chattr</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>+C</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/swapfile</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>btrfs</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>property</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>set</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/swapfile</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>compression</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>none</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>fallocate</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/swapfile</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>-l4g</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>chmod</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>600</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/swapfile</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>mkswap</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/swapfile</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>lsattr</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/swapfile</span></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>swapon</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/swapfile</span></div></code></pre><!--]--></div><p><!--[-->Закомментировать раздел swap и добавить строку с файлом.<!--]--></p><div class="code-container" data-v-2dc29a73><header class="code-container-header" data-v-2dc29a73><span class="language-text" data-v-2dc29a73>bash</span><!----><!----></header><!--[--><pre data-v-2dc29a73-s><code data-v-2dc29a73-s><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>sudo</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>nano</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-8a2173" data-v-2dc29a73-s>/etc/fstab</span></div><div class="line" data-v-2dc29a73-s></div><div class="line" data-v-2dc29a73-s><span class="ct-068da8" data-v-2dc29a73-s>/swapfile</span><span class="ct-402795" data-v-2dc29a73-s>      </span><span class="ct-8a2173" data-v-2dc29a73-s>none</span><span class="ct-402795" data-v-2dc29a73-s>      </span><span class="ct-8a2173" data-v-2dc29a73-s>swap</span><span class="ct-402795" data-v-2dc29a73-s>      </span><span class="ct-8a2173" data-v-2dc29a73-s>defaults</span><span class="ct-402795" data-v-2dc29a73-s>    </span><span class="ct-4ee302" data-v-2dc29a73-s>0</span><span class="ct-402795" data-v-2dc29a73-s> </span><span class="ct-4ee302" data-v-2dc29a73-s>0</span></div></code></pre><!--]--></div><h3 id="ссылки"><!--[-->Ссылки<!--]--></h3><ul><!--[--><li><!--[--><a href="/posts/zsh-config" class=""><!--[-->Настройка zsh<!--]--></a><!--]--></li><li><!--[--><a href="https://github.com/creio/dots" rel="nofollow" target="_blank"><!--[-->Еще некоторые конфиги и скрипты в моем репозитории<!--]--></a><!--]--></li><li><!--[--><a href="/posts/vpn" class=""><!--[-->VPN сервер в Linux<!--]--></a><!--]--></li><!--]--></ul><h2 id="итог"><!--[-->Итог<!--]--></h2><p><!--[-->Таким способом можно переделать любую систему и практически на любом облачном решении, главное знать детали загрузки и хорошо бы иметь ssh подключение выше, как тут (Console connection), или некий режим восстановления. Если Вам понравился мой бред:) по этому поводу, то поблагодарить меня можно тут.<!--]--></p><ul><!--[--><li><!--[--><a href="https://ctlos.github.io/donat/" rel="nofollow" target="_blank"><!--[-->ctlos.github.io/donat<!--]--></a><!--]--></li><li><!--[-->Вступай в чат <a href="https://telegram.me/ctlos" rel="nofollow" target="_blank"><!--[-->@ctlos<!--]--></a><!--]--></li><!--]--></ul><p><!--[-->Всем Добра.<!--]--></p><style>.ct-3d5b48{color:#FF7B72}
.ct-667c91{color:#8B949E}
.ct-8a2173{color:#A5D6FF}
.ct-4ee302{color:#79C0FF}
.ct-402795{color:#C9D1D9}
.ct-068da8{color:#FFA657}</style></div><!--]--><div class="article-navigation prev-next" data-v-0191091b data-v-f1cf9aa5><a href="/posts/vpn" class="button button--md button--outline button--primary prev-button" title="Как Создать и Настроить VPN сервер в Linux | Wireguard" data-v-f1cf9aa5><span class="button--content"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-f1cf9aa5 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-cf1ec82f><path fill="currentColor" d="M7.828 11H20v2H7.828l5.364 5.364l-1.414 1.414L4 12l7.778-7.778l1.414 1.414L7.828 11Z"/></svg> Назад <!--]--></span><!----></a><a href="/posts/web-server" class="button button--md button--outline button--primary next-button" title="Настройка и использование Nginx в Arch Linux | Docker Portainer" data-v-f1cf9aa5><span class="button--content"><!--[--> Вперед <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-f1cf9aa5 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-cf1ec82f><path fill="currentColor" d="m16.172 11l-5.364-5.364l1.414-1.414L20 12l-7.778 7.778l-1.414-1.414L16.172 13H4v-2h12.172Z"/></svg><!--]--></span><!----></a></div></article></main><!--]--><footer class="base-footer" data-v-b26cc15c><div class="base-footer__layout" data-v-b26cc15c><div class="copyright-area copyright-block flow" data-v-b26cc15c><div class="copyright-line" data-v-b26cc15c>© 2023. Gen: <a target="_blank" href="https://nuxt.com" rel="nofollow" data-v-b26cc15c>Nuxt</a></div></div><div class="meta-area flow" data-v-b26cc15c><ul class="social-icons" data-v-b26cc15c><li data-v-b26cc15c><a class="footer-icon" rel="me" target="_blank" href="https://github.com/creio" data-v-b26cc15c><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-b26cc15c style="" width="1em" height="1em" viewBox="0 0 256 256" data-v-cf1ec82f><path fill="currentColor" d="M212.62 75.17A63.7 63.7 0 0 0 206.39 26A12 12 0 0 0 196 20a63.71 63.71 0 0 0-50 24h-20a63.71 63.71 0 0 0-50-24a12 12 0 0 0-10.39 6a63.7 63.7 0 0 0-6.23 49.17A61.5 61.5 0 0 0 52 104v8a60.1 60.1 0 0 0 45.76 58.28A43.66 43.66 0 0 0 92 192v4H76a20 20 0 0 1-20-20a44.05 44.05 0 0 0-44-44a12 12 0 0 0 0 24a20 20 0 0 1 20 20a44.05 44.05 0 0 0 44 44h16v12a12 12 0 0 0 24 0v-40a20 20 0 0 1 40 0v40a12 12 0 0 0 24 0v-40a43.66 43.66 0 0 0-5.76-21.72A60.1 60.1 0 0 0 220 112v-8a61.5 61.5 0 0 0-7.38-28.83ZM196 112a36 36 0 0 1-36 36h-48a36 36 0 0 1-36-36v-8a37.87 37.87 0 0 1 6.13-20.12a11.65 11.65 0 0 0 1.58-11.49a39.9 39.9 0 0 1-.4-27.72a39.87 39.87 0 0 1 26.41 17.8a12 12 0 0 0 10.1 5.53h32.35a12 12 0 0 0 10.11-5.53a39.84 39.84 0 0 1 26.41-17.8a39.9 39.9 0 0 1-.4 27.72a12 12 0 0 0 1.61 11.53A37.85 37.85 0 0 1 196 104Z"/></svg></a></li><li data-v-b26cc15c><a class="footer-icon" rel="me" target="_blank" href="https://t.me/cretm" data-v-b26cc15c><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-b26cc15c style="" width="1em" height="1em" viewBox="0 0 256 256" data-v-cf1ec82f><path fill="currentColor" d="M239.49 23.16a13 13 0 0 0-13.23-2.26L23.6 100.21a18.22 18.22 0 0 0 3.12 34.86L76 144.74V200a20 20 0 0 0 34.4 13.88l22.67-23.51L170.35 223a20 20 0 0 0 32.7-10.54l40.62-176.55a13 13 0 0 0-4.18-12.75Zm-92.08 54.36l-62.19 44.57l-34.43-6.75ZM100 190.06v-28.71l15 13.15Zm81.16 10.52l-73.88-64.77l106.31-76.18Z"/></svg></a></li><li data-v-b26cc15c><a class="footer-icon" rel="me" target="_blank" href="https://youtube.com/creioyt" data-v-b26cc15c><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-b26cc15c style="" width="1em" height="1em" viewBox="0 0 256 256" data-v-cf1ec82f><path fill="currentColor" d="m170.49 117.91l-56-36A12 12 0 0 0 96 92v72a12 12 0 0 0 18.49 10.09l56-36a12 12 0 0 0 0-20.18ZM120 142v-28l21.81 14Zm118.21-73.5a28.05 28.05 0 0 0-16.93-19.14C186.4 35.91 131.29 36 128 36s-58.4-.09-93.28 13.38a28.05 28.05 0 0 0-16.93 19.14C15.15 78.72 12 97.32 12 128s3.15 49.28 5.79 59.48a28.05 28.05 0 0 0 16.93 19.14C68.21 219.55 120.36 220 127.37 220h1.26c7 0 59.16-.45 92.65-13.38a28.05 28.05 0 0 0 16.93-19.14c2.64-10.2 5.79-28.8 5.79-59.48s-3.15-49.28-5.79-59.48ZM215 181.46a4 4 0 0 1-2.34 2.77C182.78 195.76 132.27 196 128.32 196h-.39c-.53 0-53.64.17-84.56-11.77a4 4 0 0 1-2.37-2.77c-1.88-7.24-5-23.82-5-53.46s3.15-46.22 5-53.46a4 4 0 0 1 2.34-2.77C74.29 59.83 127.39 60 127.92 60h.15c.54 0 53.64-.17 84.56 11.77a4 4 0 0 1 2.37 2.77c1.88 7.24 5 23.82 5 53.46s-3.15 46.22-5 53.46Z"/></svg></a></li><li data-v-b26cc15c><a class="footer-icon" rel="me" target="_blank" href="https://vk.com/creio" data-v-b26cc15c><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-b26cc15c style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-cf1ec82f><path fill="currentColor" fill-rule="evenodd" d="M23.45 5.948c.166-.546 0-.948-.795-.948H20.03c-.668 0-.976.347-1.143.73c0 0-1.335 3.196-3.226 5.272c-.612.602-.89.793-1.224.793c-.167 0-.418-.191-.418-.738V5.948c0-.656-.184-.948-.74-.948H9.151c-.417 0-.668.304-.668.593c0 .621.946.765 1.043 2.513v3.798c0 .833-.153.984-.487.984c-.89 0-3.055-3.211-4.34-6.885C4.45 5.288 4.198 5 3.527 5H.9c-.75 0-.9.347-.9.73c0 .682.89 4.07 4.145 8.551C6.315 17.341 9.37 19 12.153 19c1.669 0 1.875-.368 1.875-1.003v-2.313c0-.737.158-.884.687-.884c.39 0 1.057.192 2.615 1.667C19.11 18.216 19.403 19 20.405 19h2.625c.75 0 1.126-.368.91-1.096c-.238-.724-1.088-1.775-2.215-3.022c-.612-.71-1.53-1.475-1.809-1.858c-.389-.491-.278-.71 0-1.147c0 0 3.2-4.426 3.533-5.929Z" clip-rule="evenodd"/></svg></a></li><li data-v-b26cc15c><a class="footer-icon" href="#" data-v-b26cc15c><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-b26cc15c style="" width="1em" height="1em" viewBox="0 0 256 256" data-v-cf1ec82f><path fill="currentColor" d="M205.66 117.66a8 8 0 0 1-11.32 0L136 59.31V216a8 8 0 0 1-16 0V59.31l-58.34 58.35a8 8 0 0 1-11.32-11.32l72-72a8 8 0 0 1 11.32 0l72 72a8 8 0 0 1 0 11.32Z"/></svg></a></li></ul></div></div></footer></div><!--]--></div><script>window.__NUXT__=(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_,$,aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al,am,an,ao,ap,aq,ar,as,at,au,av,aw,ax,ay,az,aA,aB,aC,aD,aE,aF,aG,aH,aI,aJ,aK,aL,aM,aN,aO,aP,aQ,aR,aS,aT,aU,aV,aW,aX,aY,aZ,a_,a$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b_,b$,ca,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr,cs,ct,cu,cv){return {data:{"content-/posts/oci":{_path:"\u002Fposts\u002Foci",_dir:"posts",_draft:t,_partial:t,_locale:m,_empty:t,title:"Установка Arch Linux в Oracle Cloud",description:m,date:"2021-03-22T00:00:00.000Z",type:"post",tags:["archlinux"],body:{type:aF,children:[{type:a,tag:$,props:{},children:[{type:a,tag:l,props:{},children:[{type:b,value:"PS: У меня забанили аккаунт без предупреждения :)."}]}]},{type:a,tag:l,props:{},children:[{type:b,value:"Существует такое предложение от Oracle Cloud, можно получить 2 сервера в минимальной комплектации навсегда и первые 30 дней тестирования более широкого функционала, нужно привязать карту с которой спишут примерно 1 евро(мне вернули практически сразу) и телефон. Доступные дистрибутивы на free тарифе: ubuntu, centos, oracle linux "},{type:a,tag:z,props:{href:"https:\u002F\u002Fwww.oracle.com\u002Fcloud\u002Ffree\u002F",rel:[B]},children:[{type:b,value:"oracle.com\u002Fcloud\u002Ffree\u002F"}]},{type:b,value:O}]},{type:a,tag:l,props:{},children:[{type:b,value:"После того, как я немного потрогал их кабинет задался целью развернуть у них Arch Linux, доступного образа у них нет, но я знаю о таком замечательном инструменте, как packer, все мои попытки запустить собранные packer-ом образы были не удачны. Образы практически на 100% уверен были в порядке, но я не знал как у них устроен efi загрузчик и не сообразил использовать Console Connection, об этом будет ниже "},{type:a,tag:z,props:{href:"https:\u002F\u002Fwww.packer.io\u002Fdocs",rel:[B]},children:[{type:b,value:"www.packer.io\u002Fdocs"}]},{type:b,value:O}]},{type:a,tag:l,props:{},children:[{type:b,value:"Для тех кому интересно, как залить туда custom image. В меню, Object storage - Bucket, создайте bucket, а в него загрузите образ. После этого в меню, Custom Images можно импортировать файл из бакета и уже из него создать Instance(машину)."}]},{type:a,tag:l,props:{},children:[{type:b,value:"Спустя примерно месяц я решил еще раз попробовать это провернуть, но доступ к функционалу Custom Images был закрыт, но я размотал его немного иначе."}]},{type:a,tag:l,props:{},children:[{type:b,value:"Интерфейс, практически везде есть сноски на документацию, которую можно перевести и детальней узнать о работе. Собственно так я и знакомился с функционалом кабинета, методом тыка. На данный момент он мне даже кажется весьма удобным."}]},{type:a,tag:$,props:{},children:[{type:a,tag:l,props:{},children:[{type:b,value:"После создания машины(не важно какой), если в ней присутствует Файрвол, то открыть порты в нем мало, нужно еще открыть их в Default Security List. В меню, Networking - Virtual Cloud Networks - vcn-id - Security Lists - Default Security List vor vcn-id, иначе порты не будут доступны. Простыми словами их нужно открыть, как в Default Security List, так и на самой машине, при наличии Файрвола."}]}]},{type:a,tag:ae,props:{},children:[{type:a,tag:H,props:{},children:[{type:a,tag:z,props:{href:"https:\u002F\u002Fstackoverflow.com\u002Fquestions\u002F54794217\u002Fopening-port-80-on-oracle-cloud-infrastructure-compute-node",rel:[B]},children:[{type:b,value:"stackoverflow.com"}]}]}]},{type:a,tag:v,props:{id:aG},children:[{type:b,value:aH}]},{type:a,tag:l,props:{},children:[{type:b,value:"Локально создайте ssh ключи, если еще не сделали этого."}]},{type:a,tag:k,props:{code:"ssh-keygen -t rsa -b 4096 -C \"ctlos@protonmail.com\"\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:"ssh-keygen"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"-t"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"rsa"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"-b"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"4096"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"-C"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\"ctlos@protonmail.com\""}]}]}]}]}]},{type:a,tag:l,props:{},children:[{type:b,value:"Ключи упадут в "},{type:a,tag:I,props:{},children:[{type:b,value:"~\u002F.ssh"}]},{type:b,value:". При создании instance(машины), импортируйте публичный ключ "},{type:a,tag:I,props:{},children:[{type:b,value:"id_rsa.pub"}]},{type:b,value:O}]},{type:a,tag:v,props:{id:aI},children:[{type:b,value:aJ}]},{type:a,tag:l,props:{},children:[{type:b,value:"Создать минимальную машинку free, oracle linux 7.9, именно в ней будет swap раздел на 8G, который мы будем использовать для трансфера. Я не трогал настройки по умолчанию при создании. Авторизуемся на машине по ssh."}]},{type:a,tag:v,props:{id:aK},children:[{type:b,value:aL}]},{type:a,tag:l,props:{},children:[{type:b,value:"Методы описаны в вики archlinux "},{type:a,tag:z,props:{href:"https:\u002F\u002Fwiki.archlinux.org\u002Findex.php\u002FInstall_Arch_Linux_from_existing_Linux#Method_A:_Using_the_bootstrap_image_(recommended)",rel:[B]},children:[{type:b,value:"wiki.archlinux.org"}]},{type:b,value:O}]},{type:a,tag:l,props:{},children:[{type:b,value:"Копируем ссылку на bootstrap .tar.gz. Скачиваем и раскрываем архив в корень "},{type:a,tag:z,props:{href:"http:\u002F\u002Fmirrors.evowise.com\u002Farchlinux\u002Fiso\u002Flatest\u002F",rel:[B]},children:[{type:b,value:"http:\u002F\u002Fmirrors.evowise.com\u002F"}]},{type:b,value:O}]},{type:a,tag:k,props:{code:"# под root\ncd \u002F\nwget http:\u002F\u002Fmirrors.evowise.com\u002Farchlinux\u002Fiso\u002Flatest\u002Farchlinux-bootstrap-2021.03.01-x86_64.tar.gz\ntar xzf \u002Farchlinux-bootstrap-*-x86_64.tar.gz\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:r},children:[{type:b,value:"# под root"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:j},children:[{type:b,value:"cd"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:aj}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:aM}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"http:\u002F\u002Fmirrors.evowise.com\u002Farchlinux\u002Fiso\u002Flatest\u002Farchlinux-bootstrap-2021.03.01-x86_64.tar.gz"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:"tar"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"xzf"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\u002Farchlinux-bootstrap-"}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:aN}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"-x86_64.tar.gz"}]}]}]}]}]},{type:a,tag:l,props:{},children:[{type:b,value:"Отмонтировать swap он 8G, форматировать его в нужную фс(btrfs\u002Fext4). В моем случае структура разделов."}]},{type:a,tag:ae,props:{},children:[{type:a,tag:H,props:{},children:[{type:b,value:"\u002Fdev\u002Fsda1 boot, точка монтирования \u002Fboot\u002Fefi."}]},{type:a,tag:H,props:{},children:[{type:b,value:"\u002Fdev\u002Fsda2 swap(8G), его использую для трансфера."}]},{type:a,tag:H,props:{},children:[{type:b,value:"\u002Fdev\u002Fsda3 root(39G). На данный момент я тут с Oracle linux, в конце тут будет Arch с lts ядром."}]}]},{type:a,tag:k,props:{code:"lsblk -f\nswapoff -a\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:P}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:E}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:"swapoff"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:ak}]}]}]}]}]},{type:a,tag:l,props:{},children:[{type:b,value:"Теперь выполняем chroot в bootstrap, в нем выполняем дальнейшие действия. Его разворачиваем для доступа к pacstrap и arch-chroot, основная и единственная задача. Он сам смонтирует нужные бинды, но нужно еще выполнить pacman init и раскомментировать зеркала(первые 3 Worldwide "},{type:a,tag:z,props:{href:"https:\u002F\u002Fwiki.archlinux.org\u002Findex.php\u002FInstall_Arch_Linux_from_existing_Linux#Using_a_chroot_environment",rel:[B]},children:[{type:b,value:"Using_a_chroot_environment"}]},{type:b,value:O}]},{type:a,tag:k,props:{code:"nano \u002Froot.x86_64\u002Fetc\u002Fpacman.d\u002Fmirrorlist\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:K}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\u002Froot.x86_64\u002Fetc\u002Fpacman.d\u002Fmirrorlist"}]}]}]}]}]},{type:a,tag:k,props:{code:"ls \u002F\n\n\u002Froot.x86_64\u002Fbin\u002Farch-chroot \u002Froot.x86_64\n\npacman-key --init\npacman-key --populate\npacman -Syy\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:aO}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:aj}]}]},{type:a,tag:g,props:{class:h},children:[]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:"\u002Froot.x86_64\u002Fbin\u002Farch-chroot"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\u002Froot.x86_64"}]}]},{type:a,tag:g,props:{class:h},children:[]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:af}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:aP}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:af}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:aQ}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:aR}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:aS}]}]}]}]}]},{type:a,tag:v,props:{id:aT},children:[{type:b,value:aU}]},{type:a,tag:l,props:{},children:[{type:b,value:"Форматируем, создаем нужные директории, снапшоты, монтируем. Обратите внимание boot я не форматирую, а просто перемонтирую и удалю из него загрузчик \u002Fboot\u002Fefi\u002FEFI\u002Fredhat."}]},{type:a,tag:k,props:{code:"mkfs.btrfs -f -L \"root\" \u002Fdev\u002Fsda2\nmount \u002Fdev\u002Fsda2 \u002Fmnt\n\nbtrfs subvolume create \u002Fmnt\u002F@\nbtrfs subvolume create \u002Fmnt\u002F@home\nbtrfs subvolume create \u002Fmnt\u002F@snapshots\n\numount \u002Fmnt\n\nmount -o subvol=@,compress=lzo,relatime,space_cache,autodefrag \u002Fdev\u002Fsda2 \u002Fmnt\nmkdir -p \u002Fmnt\u002F{boot\u002Fefi,home,snapshots}\nmount -o subvol=@home,compress=lzo,relatime,space_cache,autodefrag \u002Fdev\u002Fsda2 \u002Fmnt\u002Fhome\nmount -o subvol=@snapshots,compress=lzo,relatime,space_cache,autodefrag \u002Fdev\u002Fsda2 \u002Fmnt\u002Fsnapshots\n\numount \u002Fdev\u002Fsda1\nmount \u002Fdev\u002Fsda1 \u002Fmnt\u002Fboot\u002Fefi\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:aV}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:E}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:al}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:aW}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:Q}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:C}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:Q}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:A}]}]},{type:a,tag:g,props:{class:h},children:[]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:R}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:S}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:T}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:aX}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:R}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:S}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:T}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:aY}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:R}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:S}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:T}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:aZ}]}]},{type:a,tag:g,props:{class:h},children:[]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:U}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:A}]}]},{type:a,tag:g,props:{class:h},children:[]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:C}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:F}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:a_}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:Q}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:A}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:am}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:V}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:a$}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:C}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:F}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:ba}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:Q}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:bb}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:C}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:F}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:bc}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:Q}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:bd}]}]},{type:a,tag:g,props:{class:h},children:[]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:U}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:ag}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:C}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:ag}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:be}]}]}]}]}]},{type:a,tag:l,props:{},children:[{type:b,value:"Разворачиваем будущую систему с нужными пакетами, некоторые из них очень важны. Генерируем fstab и выполняем еще один chroot(да-да)."}]},{type:a,tag:k,props:{code:"pacstrap \u002Fmnt base base-devel linux-lts linux-lts-headers btrfs-progs nano grub efibootmgr iproute2 iputils rng-tools open-iscsi arch-install-scripts pacman-contrib reflector openssh wget git rsync gnu-netcat pv unzip unrar p7zip zsh htop tmux psmisc procps-ng\ngenfstab -pU \u002Fmnt \u003E\u003E \u002Fmnt\u002Fetc\u002Ffstab\narch-chroot \u002Fmnt\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:"pacstrap"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:A}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:bf}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"base-devel"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"linux-lts"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"linux-lts-headers"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"btrfs-progs"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:K}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"grub"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"efibootmgr"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"iproute2"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"iputils"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"rng-tools"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"open-iscsi"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"arch-install-scripts"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"pacman-contrib"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:bg}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"openssh"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:aM}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"git"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:bh}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"gnu-netcat"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"pv"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"unzip"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"unrar"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"p7zip"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"zsh"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"htop"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"tmux"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"psmisc"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"procps-ng"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:"genfstab"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"-pU"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:A}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:q},children:[{type:b,value:ah}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\u002Fmnt\u002Fetc\u002Ffstab"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:bi}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:A}]}]}]}]}]},{type:a,tag:v,props:{id:bj},children:[{type:b,value:bk}]},{type:a,tag:l,props:{},children:[{type:b,value:"Проинициализируем pacman, отсортируем зеркала и включаем mitilib репозиторий."}]},{type:a,tag:k,props:{code:"reflector -a 12 -l 30 -f 30 -p https,http --sort rate --save \u002Fetc\u002Fpacman.d\u002Fmirrorlist\npacman-key --init\npacman-key --populate\n\nsed -i \"\u002F[multilib]\u002F,\u002FInclude\u002F\"'s\u002F^#\u002F\u002F' \u002Fetc\u002Fpacman.conf\npacman -Syy --noconfirm\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:bg}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:ak}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"12"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:bl}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:bm}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:E}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:bm}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:V}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"https,http"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"--sort"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"rate"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"--save"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\u002Fetc\u002Fpacman.d\u002Fmirrorlist"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:af}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:aP}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:af}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:aQ}]}]},{type:a,tag:g,props:{class:h},children:[]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:"sed"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"-i"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\"\u002F[multilib]\u002F,\u002FInclude\u002F\"'s\u002F^#\u002F\u002F'"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\u002Fetc\u002Fpacman.conf"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:aR}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:aS}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"--noconfirm"}]}]}]}]}]},{type:a,tag:v,props:{id:bn},children:[{type:b,value:bo}]},{type:a,tag:l,props:{},children:[{type:b,value:"Назначим рут пароль, добавляем пользователя с нужными группами, включаем ему zsh. Назначаем пароль пользователю и включаем sudo."}]},{type:a,tag:k,props:{code:"usermod -p 123 root\n\nuseradd -m -g users -G \"log,network,storage,power,wheel\" -s \u002Fbin\u002Fzsh creio\nusermod -p 123 creio\necho \"%wheel ALL=(ALL) ALL\" \u003E\u003E \u002Fetc\u002Fsudoers\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:bp}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:V}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:bq}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:aF}]}]},{type:a,tag:g,props:{class:h},children:[]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:"useradd"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"-m"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"-g"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"users"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"-G"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\"log,network,storage,power,wheel\""}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:an}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\u002Fbin\u002Fzsh"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:ai}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:bp}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:V}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:bq}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:ai}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:j},children:[{type:b,value:L}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\"%wheel ALL=(ALL) ALL\""}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:q},children:[{type:b,value:ah}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\u002Fetc\u002Fsudoers"}]}]}]}]}]},{type:a,tag:v,props:{id:br},children:[{type:b,value:bs}]},{type:a,tag:l,props:{},children:[{type:b,value:"Назначаем имя машины, часовой пояс, локали и русский шрифт в консоли."}]},{type:a,tag:k,props:{code:"echo cloud \u003E \u002Fetc\u002Fhostname\n\nln -svf \u002Fusr\u002Fshare\u002Fzoneinfo\u002FEurope\u002FMoscow \u002Fetc\u002Flocaltime\nhwclock --systohc --utc\n\necho \"en_US.UTF-8 UTF-8\" \u003E \u002Fetc\u002Flocale.gen\necho \"ru_RU.UTF-8 UTF-8\" \u003E\u003E \u002Fetc\u002Flocale.gen\nlocale-gen\n\necho \"LANG=ru_RU.UTF-8\" \u003E \u002Fetc\u002Flocale.conf\necho \"KEYMAP=ru\" \u003E \u002Fetc\u002Fvconsole.conf\necho \"FONT=cyr-sun16\" \u003E\u003E \u002Fetc\u002Fvconsole.conf\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:j},children:[{type:b,value:L}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"cloud"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:q},children:[{type:b,value:aa}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\u002Fetc\u002Fhostname"}]}]},{type:a,tag:g,props:{class:h},children:[]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:bt}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"-svf"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\u002Fusr\u002Fshare\u002Fzoneinfo\u002FEurope\u002FMoscow"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\u002Fetc\u002Flocaltime"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:"hwclock"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"--systohc"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"--utc"}]}]},{type:a,tag:g,props:{class:h},children:[]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:j},children:[{type:b,value:L}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\"en_US.UTF-8 UTF-8\""}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:q},children:[{type:b,value:aa}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:bu}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:j},children:[{type:b,value:L}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\"ru_RU.UTF-8 UTF-8\""}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:q},children:[{type:b,value:ah}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:bu}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:"locale-gen"}]}]},{type:a,tag:g,props:{class:h},children:[]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:j},children:[{type:b,value:L}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\"LANG=ru_RU.UTF-8\""}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:q},children:[{type:b,value:aa}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\u002Fetc\u002Flocale.conf"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:j},children:[{type:b,value:L}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\"KEYMAP=ru\""}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:q},children:[{type:b,value:aa}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:bv}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:j},children:[{type:b,value:L}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\"FONT=cyr-sun16\""}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:q},children:[{type:b,value:ah}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:bv}]}]}]}]}]},{type:a,tag:v,props:{id:ao},children:[{type:b,value:bw}]},{type:a,tag:l,props:{},children:[{type:b,value:"Изменить строку HOOKS в файле \u002Fetc\u002Fmkinitcpio.conf, должно быть так. Важно! Не знаю почему, но с хуком udev отказывается стартовать init, поэтому обязательно замените его на systemd и удаляю fsck, так как btrfs."}]},{type:a,tag:k,props:{code:"HOOKS=(base systemd autodetect modconf block filesystems keyboard keymap)\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:"HOOKS"}]},{type:a,tag:c,props:{class:q},children:[{type:b,value:w}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:"("}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:bf}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:" systemd autodetect modconf block filesystems keyboard keymap)"}]}]}]}]}]},{type:a,tag:l,props:{},children:[{type:b,value:"Обновить initramfs."}]},{type:a,tag:k,props:{code:"mkinitcpio -P\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:ao}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"-P"}]}]}]}]}]},{type:a,tag:l,props:{},children:[{type:b,value:"Если проебали с хуком, то попадете в rootfs и можно принудительно назначить инит и включить его."}]},{type:a,tag:k,props:{code:"ln -s \u002Flib\u002Fsystemd\u002Fsystemd \u002Fnew_root\u002Fbin\u002Finit\n\nexec switch_root \u002Fnew_root \u002Fbin\u002Finit\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:bt}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:an}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\u002Flib\u002Fsystemd\u002Fsystemd"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\u002Fnew_root\u002Fbin\u002Finit"}]}]},{type:a,tag:g,props:{class:h},children:[]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:j},children:[{type:b,value:"exec"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"switch_root"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\u002Fnew_root"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\u002Fbin\u002Finit"}]}]}]}]}]},{type:a,tag:v,props:{id:bx},children:[{type:b,value:by}]},{type:a,tag:k,props:{code:"cat \u003C\u003CEOF \u003E\u002Fetc\u002Fhosts\n127.0.0.1       localhost\n::1             localhost\n127.0.1.1       cloud.localdomain cloud\nEOF\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:ab}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:q},children:[{type:b,value:bz}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"EOF \u003E\u002Fetc\u002Fhosts"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:f},children:[{type:b,value:"127.0.0.1       localhost"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:f},children:[{type:b,value:"::1             localhost"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:f},children:[{type:b,value:"127.0.1.1       cloud.localdomain cloud"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:f},children:[{type:b,value:bA}]}]}]}]}]},{type:a,tag:v,props:{id:bB},children:[{type:b,value:bC}]},{type:a,tag:k,props:{code:"cat \u003C\u003CEOF \u003E\u002Fetc\u002Fsystemd\u002Fnetwork\u002F20-ethernet.network\n[Match]\nName=en*\nName=eth*\n\n[Network]\nDHCP=yes\nEOF\n\nsystemctl enable systemd-networkd\nsystemctl enable systemd-resolved\n# Workaround for https:\u002F\u002Fbugs.archlinux.org\u002Ftask\u002F58355\nsystemctl enable rngd\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:ab}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:q},children:[{type:b,value:bz}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"EOF \u003E\u002Fetc\u002Fsystemd\u002Fnetwork\u002F20-ethernet.network"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:f},children:[{type:b,value:"[Match]"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:f},children:[{type:b,value:"Name=en*"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:f},children:[{type:b,value:"Name=eth*"}]}]},{type:a,tag:g,props:{class:h},children:[]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:f},children:[{type:b,value:"[Network]"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:f},children:[{type:b,value:"DHCP=yes"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:f},children:[{type:b,value:bA}]}]},{type:a,tag:g,props:{class:h},children:[]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:D}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:W}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"systemd-networkd"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:D}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:W}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"systemd-resolved"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:r},children:[{type:b,value:"# Workaround for https:\u002F\u002Fbugs.archlinux.org\u002Ftask\u002F58355"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:D}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:W}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"rngd"}]}]}]}]}]},{type:a,tag:v,props:{id:bD},children:[{type:b,value:bE}]},{type:a,tag:k,props:{code:"grub-install --target=x86_64-efi --efi-directory=\u002Fboot\u002Fefi\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:bF}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:bG}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:bH}]}]}]}]}]},{type:a,tag:l,props:{},children:[{type:b,value:"Grub.cfg приводим к такому виду, все остальное закомментировано(#)"}]},{type:a,tag:k,props:{code:"nano \u002Fetc\u002Fdefault\u002Fgrub\n\nGRUB_DEFAULT=0\nGRUB_TIMEOUT=0\nGRUB_DISTRIBUTOR=\"Arch\"\nGRUB_CMDLINE_LINUX_DEFAULT=\"console=tty1 console=ttyS0 nvme.shutdown_timeout=10 libiscsi.debug_libiscsi_eh=1 quiet\"\nGRUB_CMDLINE_LINUX=\"\"\nGRUB_PRELOAD_MODULES=\"part_gpt part_msdos\"\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:K}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\u002Fetc\u002Fdefault\u002Fgrub"}]}]},{type:a,tag:g,props:{class:h},children:[]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:"GRUB_DEFAULT"}]},{type:a,tag:c,props:{class:q},children:[{type:b,value:w}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:x}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:"GRUB_TIMEOUT"}]},{type:a,tag:c,props:{class:q},children:[{type:b,value:w}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:x}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:"GRUB_DISTRIBUTOR"}]},{type:a,tag:c,props:{class:q},children:[{type:b,value:w}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\"Arch\""}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:"GRUB_CMDLINE_LINUX_DEFAULT"}]},{type:a,tag:c,props:{class:q},children:[{type:b,value:w}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\"console=tty1 console=ttyS0 nvme.shutdown_timeout=10 libiscsi.debug_libiscsi_eh=1 quiet\""}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:"GRUB_CMDLINE_LINUX"}]},{type:a,tag:c,props:{class:q},children:[{type:b,value:w}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\"\""}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:"GRUB_PRELOAD_MODULES"}]},{type:a,tag:c,props:{class:q},children:[{type:b,value:w}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\"part_gpt part_msdos\""}]}]}]}]}]},{type:a,tag:l,props:{},children:[{type:b,value:"Генерируем конфиг grub."}]},{type:a,tag:k,props:{code:"grub-mkconfig -o \u002Fboot\u002Fgrub\u002Fgrub.cfg\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:bI}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:F}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:ap}]}]}]}]}]},{type:a,tag:l,props:{},children:[{type:b,value:"Удаляем дефолт загрузчик."}]},{type:a,tag:k,props:{code:"rm -rf \u002Fmnt\u002Fboot\u002Fefi\u002FEFI\u002Fredhat\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:"rm"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"-rf"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\u002Fmnt\u002Fboot\u002Fefi\u002FEFI\u002Fredhat"}]}]}]}]}]},{type:a,tag:l,props:{},children:[{type:b,value:"Так как мы снесли дефолтный загрузчик, нужно подсунуть нужный файл efi для автоматической загрузки."}]},{type:a,tag:k,props:{code:"echo \"EFIarchgrubx64.efi\" \u003E \u002Fboot\u002Fefi\u002Fstartup.nsh\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:j},children:[{type:b,value:L}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\"EFIarchgrubx64.efi\""}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:q},children:[{type:b,value:aa}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:bJ}]}]}]}]}]},{type:a,tag:v,props:{id:X},children:[{type:b,value:bK}]},{type:a,tag:l,props:{},children:[{type:b,value:"Раскомментируем строки и приведем их к такому виду."}]},{type:a,tag:k,props:{code:"nano \u002Fetc\u002Fssh\u002Fsshd_config\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:K}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\u002Fetc\u002Fssh\u002Fsshd_config"}]}]}]}]}]},{type:a,tag:k,props:{code:"PermitRootLogin yes\nPubkeyAuthentication yes\nPasswordAuthentication yes\nUseDNS no\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:"PermitRootLogin"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:aq}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:"PubkeyAuthentication"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:aq}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:"PasswordAuthentication"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:aq}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:"UseDNS"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"no"}]}]}]}]}]},{type:a,tag:l,props:{},children:[{type:b,value:"Включаем сервис."}]},{type:a,tag:k,props:{code:"systemctl enable sshd\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:D}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:W}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"sshd"}]}]}]}]}]},{type:a,tag:l,props:{},children:[{type:b,value:"Выходим из chroot раздела(sda2) "},{type:a,tag:I,props:{},children:[{type:b,value:ar}]},{type:b,value:". Отмантируем разделы."}]},{type:a,tag:k,props:{code:"umount -R \u002Fmnt\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:U}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:as}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:A}]}]}]}]}]},{type:a,tag:l,props:{},children:[{type:b,value:"И еще раз exit выходим из archlinux-bootstrap(\u002Froot.x86_64)."}]},{type:a,tag:$,props:{},children:[{type:a,tag:l,props:{},children:[{type:b,value:"Следующий шаг важен, он мне сильно помог в отладке, так как доступ получаем выше самой машины, очень удобно."}]}]},{type:a,tag:l,props:{},children:[{type:b,value:"Перейдите в нужный instance и создайте на вкладке Console Connection подключение ssh, импортируйте открытый ключid_rsa.pub. После активации подключения в меню(3 точки справа) скопируйте Copy Serial Console Connection for Linux\u002FMac данные, вставьте данные из буфера в новый терминал."}]},{type:a,tag:k,props:{code:"ssh -o ProxyCommand='ssh -W %h:%p -p 443 ocid1.instnection.oc1.eu-frankfurt-1.antheljtuhavnyqwertyrey@instance-console.eu-frankfurt-1.oraclecloud.com' ocid1.instance.oc1.eu-frankfurt-1.qwretfhjczsdfetrydfgdfsfd\n\n# прожать Enter\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:X}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:F}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"ProxyCommand='ssh -W %h:%p -p 443 ocid1.instnection.oc1.eu-frankfurt-1.antheljtuhavnyqwertyrey@instance-console.eu-frankfurt-1.oraclecloud.com'"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"ocid1.instance.oc1.eu-frankfurt-1.qwretfhjczsdfetrydfgdfsfd"}]}]},{type:a,tag:g,props:{class:h},children:[]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:r},children:[{type:b,value:"# прожать Enter"}]}]}]}]}]},{type:a,tag:l,props:{},children:[{type:b,value:"В исходном терминале, перезагружаем машину."}]},{type:a,tag:k,props:{code:"systemctl reboot\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:D}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:at}]}]}]}]}]},{type:a,tag:l,props:{},children:[{type:b,value:"В терминале с "},{type:a,tag:I,props:{},children:[{type:b,value:bL}]},{type:b,value:" должны увидеть efi меню, которое выполнит скрипт "},{type:a,tag:I,props:{},children:[{type:b,value:bJ}]},{type:b,value:"(5 секунд) и запустит grub, grub не увидим, так как он выставлен в 0."}]},{type:a,tag:Y,props:{id:bM},children:[{type:b,value:bN}]},{type:a,tag:l,props:{},children:[{type:b,value:"Если что-то выполнили не так увидите "},{type:a,tag:I,props:{},children:[{type:b,value:"efishell\u003E"}]},{type:b,value:", некоторые команды."}]},{type:a,tag:k,props:{code:"# карта\nmap\n# меню\nbcfg boot dump\n# переход в раздел\nFS0:\n# посмотреть созданный efi файл\nls EFIarch\n# запустить\nEFIarchgrubx64.efi\n# выход в псевдографику\nexit\n# добавляет пунк, работает до ребута\nbcfg boot add 0 FS0:EFIarchgrubx64.efi \"Arch lts\"\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:r},children:[{type:b,value:"# карта"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:"map"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:r},children:[{type:b,value:"# меню"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:bO}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:bP}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"dump"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:r},children:[{type:b,value:"# переход в раздел"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:"FS0:"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:r},children:[{type:b,value:"# посмотреть созданный efi файл"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:aO}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"EFIarch"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:r},children:[{type:b,value:"# запустить"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:"EFIarchgrubx64.efi"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:r},children:[{type:b,value:"# выход в псевдографику"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:j},children:[{type:b,value:ar}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:r},children:[{type:b,value:"# добавляет пунк, работает до ребута"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:bO}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:bP}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"add"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:x}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"FS0:EFIarchgrubx64.efi"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\"Arch lts\""}]}]}]}]}]},{type:a,tag:$,props:{},children:[{type:a,tag:l,props:{},children:[{type:b,value:"Именно по причине того, что загрузчик слетает и используется \u002Fboot\u002Fefi\u002Fstartup.nsh, именно поэтому и не стартовал мой custom image о котором я говорил в начале."}]}]},{type:a,tag:v,props:{id:bQ},children:[{type:b,value:bR}]},{type:a,tag:l,props:{},children:[{type:b,value:"Если все нормально, копируем ключ в root-а и юзера, в моем случае creio."}]},{type:a,tag:k,props:{code:"cat .ssh\u002Fid_rsa.pub | ssh root@192.168.1.35 'mkdir -p ~\u002F.ssh && cat \u003E\u003E .ssh\u002Fauthorized_keys'\ncat .ssh\u002Fid_rsa.pub | ssh creio@192.168.1.35 'mkdir -p ~\u002F.ssh && cat \u003E\u003E .ssh\u002Fauthorized_keys'\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:ab}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:bS}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:q},children:[{type:b,value:bT}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:X}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"root@192.168.1.35"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:bU}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:ab}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:bS}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:q},children:[{type:b,value:bT}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:X}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:bV}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:bU}]}]}]}]}]},{type:a,tag:l,props:{},children:[{type:b,value:"Выполняем вход."}]},{type:a,tag:k,props:{code:"ssh creio@192.168.1.35\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:X}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:bV}]}]}]}]}]},{type:a,tag:l,props:{},children:[{type:b,value:"Должны увидеть меню zsh, нажать 0."}]},{type:a,tag:v,props:{id:bW},children:[{type:b,value:bX}]},{type:a,tag:l,props:{},children:[{type:b,value:"Форматируем и монтируем sda3. Создаем снапшоты."}]},{type:a,tag:k,props:{code:"lsblk -f\nmkfs.btrfs -f -L \"root\" \u002Fdev\u002Fsda3\nmount \u002Fdev\u002Fsda3 \u002Fmnt\n\nbtrfs subvolume create \u002Fmnt\u002F@\nbtrfs subvolume create \u002Fmnt\u002F@home\nbtrfs subvolume create \u002Fmnt\u002F@snapshots\n\numount \u002Fmnt\n\nmount -o subvol=@,compress=lzo,relatime,space_cache,autodefrag \u002Fdev\u002Fsda3 \u002Fmnt\nmkdir -p \u002Fmnt\u002F{boot\u002Fefi,home,snapshots}\nmount -o subvol=@home,compress=lzo,relatime,space_cache,autodefrag \u002Fdev\u002Fsda3 \u002Fmnt\u002Fhome\nmount -o subvol=@snapshots,compress=lzo,relatime,space_cache,autodefrag \u002Fdev\u002Fsda3 \u002Fmnt\u002Fsnapshots\n\numount \u002Fdev\u002Fsda1\nmount \u002Fdev\u002Fsda1 \u002Fmnt\u002Fboot\u002Fefi\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:P}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:E}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:aV}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:E}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:al}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:aW}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:ac}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:C}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:ac}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:A}]}]},{type:a,tag:g,props:{class:h},children:[]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:R}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:S}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:T}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:aX}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:R}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:S}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:T}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:aY}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:R}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:S}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:T}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:aZ}]}]},{type:a,tag:g,props:{class:h},children:[]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:U}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:A}]}]},{type:a,tag:g,props:{class:h},children:[]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:C}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:F}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:a_}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:ac}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:A}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:am}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:V}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:a$}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:C}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:F}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:ba}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:ac}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:bb}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:C}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:F}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:bc}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:ac}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:bd}]}]},{type:a,tag:g,props:{class:h},children:[]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:U}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:ag}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:C}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:ag}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:be}]}]}]}]}]},{type:a,tag:l,props:{},children:[{type:b,value:"Копируем текущий корень в \u002Fmnt."}]},{type:a,tag:k,props:{code:"rsync -cauv --info=stats2 --exclude={\"\u002Fdev\u002F*\",\"\u002Fproc\u002F*\",\"\u002Fsys\u002F*\",\"\u002Ftmp\u002F*\",\"\u002Frun\u002F*\",\"\u002Fmnt\u002F*\",\"\u002Fmedia\u002F*\",\"\u002Flost+found\",\"\u002Fvar\u002Flib\u002Fpacman\u002Fsync\u002F*\",\"\u002Fvar\u002Fcache\u002F*\",\"\u002Fvar\u002Ftmp\u002F*\"} \u002F* \u002Fmnt\u002F\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:bh}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"-cauv"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"--info=stats2"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"--exclude="}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:"{"}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\"\u002Fdev\u002F*\""}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:G}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\"\u002Fproc\u002F*\""}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:G}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\"\u002Fsys\u002F*\""}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:G}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\"\u002Ftmp\u002F*\""}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:G}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\"\u002Frun\u002F*\""}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:G}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\"\u002Fmnt\u002F*\""}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:G}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\"\u002Fmedia\u002F*\""}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:G}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\"\u002Flost+found\""}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:G}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\"\u002Fvar\u002Flib\u002Fpacman\u002Fsync\u002F*\""}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:G}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\"\u002Fvar\u002Fcache\u002F*\""}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:G}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\"\u002Fvar\u002Ftmp\u002F*\""}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:"} \u002F"}]},{type:a,tag:c,props:{class:q},children:[{type:b,value:aN}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:" \u002Fmnt\u002F"}]}]}]}]}]},{type:a,tag:v,props:{id:bY},children:[{type:b,value:bZ}]},{type:a,tag:l,props:{},children:[{type:b,value:"Узнаем UUID разделов."}]},{type:a,tag:k,props:{code:b_,language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:P}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:E}]}]}]}]}]},{type:a,tag:l,props:{},children:[{type:b,value:"Изменить fstab, nano \u002Fmnt\u002Fetc\u002Ffstab. Загрузчик не изменился, только UUID субволумов."}]},{type:a,tag:k,props:{code:"# \u002Fdev\u002Fsda1\nUUID=2138-EC84                               \u002Fboot\u002Fefi      vfat    defaults  0 0\n\n# \u002Fdev\u002Fsda3\nUUID=39b2a28d-3890-425b-8152-fed18a73fdcd    \u002F              btrfs   subvol=@,defaults,noatime,space_cache,autodefrag 0 0\n\n# \u002Fdev\u002Fsda3\nUUID=39b2a28d-3890-425b-8152-fed18a73fdcd    \u002Fhome          btrfs   subvol=@home,defaults,noatime,space_cache,autodefrag 0 0\n\n# \u002Fdev\u002Fsda3\nUUID=39b2a28d-3890-425b-8152-fed18a73fdcd    \u002Fsnapshots     btrfs   subvol=@snapshots,defaults,noatime,space_cache,autodefrag 0 0\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:r},children:[{type:b,value:"# \u002Fdev\u002Fsda1"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:Z}]},{type:a,tag:c,props:{class:q},children:[{type:b,value:w}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"2138"}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"-EC84"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:"                               \u002Fboot\u002Fefi      vfat    defaults  "}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:x}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:x}]}]},{type:a,tag:g,props:{class:h},children:[]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:r},children:[{type:b,value:au}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:Z}]},{type:a,tag:c,props:{class:q},children:[{type:b,value:w}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:av}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:aw}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:ax}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:ay}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:az}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:"    \u002F              btrfs   subvol"}]},{type:a,tag:c,props:{class:q},children:[{type:b,value:w}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"@,defaults,noatime,space_cache,autodefrag"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:x}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:x}]}]},{type:a,tag:g,props:{class:h},children:[]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:r},children:[{type:b,value:au}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:Z}]},{type:a,tag:c,props:{class:q},children:[{type:b,value:w}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:av}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:aw}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:ax}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:ay}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:az}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:"    \u002Fhome          btrfs   subvol"}]},{type:a,tag:c,props:{class:q},children:[{type:b,value:w}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"@home,defaults,noatime,space_cache,autodefrag"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:x}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:x}]}]},{type:a,tag:g,props:{class:h},children:[]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:r},children:[{type:b,value:au}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:Z}]},{type:a,tag:c,props:{class:q},children:[{type:b,value:w}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:av}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:aw}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:ax}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:ay}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:az}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:"    \u002Fsnapshots     btrfs   subvol"}]},{type:a,tag:c,props:{class:q},children:[{type:b,value:w}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"@snapshots,defaults,noatime,space_cache,autodefrag"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:x}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:x}]}]}]}]}]},{type:a,tag:v,props:{id:b$},children:[{type:b,value:ca}]},{type:a,tag:k,props:{code:"arch-chroot \u002Fmnt\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:bi}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:A}]}]}]}]}]},{type:a,tag:l,props:{},children:[{type:b,value:"Переустановим и сконфигурируем grub."}]},{type:a,tag:k,props:{code:"grub-install --target=x86_64-efi --efi-directory=\u002Fboot\u002Fefi\n\ngrub-mkconfig -o \u002Fboot\u002Fgrub\u002Fgrub.cfg\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:bF}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:bG}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:bH}]}]},{type:a,tag:g,props:{class:h},children:[]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:bI}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:F}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:ap}]}]}]}]}]},{type:a,tag:l,props:{},children:[{type:b,value:"Посмотрим на правильность UUID. Везде должен быть id sda3."}]},{type:a,tag:k,props:{code:"cat \u002Fboot\u002Fgrub\u002Fgrub.cfg\n\nlsblk -f\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:ab}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:ap}]}]},{type:a,tag:g,props:{class:h},children:[]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:P}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:E}]}]}]}]}]},{type:a,tag:l,props:{},children:[{type:b,value:"Выходим из chroot, отмонтируем, ребут."}]},{type:a,tag:k,props:{code:"exit\numount -R \u002Fmnt\nsystemctl reboot\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:j},children:[{type:b,value:ar}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:U}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:as}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:A}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:D}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:at}]}]}]}]}]},{type:a,tag:l,props:{},children:[{type:b,value:"Опять, можем запустить "},{type:a,tag:I,props:{},children:[{type:b,value:bL}]},{type:b,value:"(прожать Enter) и наблюдать за работой efi, если все ровно, выполняем вход. Теперь можно отформатировать sda2 в swap и подключить его в fstab."}]},{type:a,tag:k,props:{code:"mkswap \u002Fdev\u002Fsda2\nswapon \u002Fdev\u002Fsda2\nswapon --show\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:cb}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:Q}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:aA}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:Q}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:aA}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"--show"}]}]}]}]}]},{type:a,tag:k,props:{code:"lsblk -f\n\nnano \u002Fetc\u002Ffstab\n\n# добавить в конец с новой строки\n# \u002Fdev\u002Fsda2\nUUID=6a1059e2-6fd0-4894-bb14-53ff59754145    none           swap    defaults    0 0\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:P}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:E}]}]},{type:a,tag:g,props:{class:h},children:[]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:K}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:aB}]}]},{type:a,tag:g,props:{class:h},children:[]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:r},children:[{type:b,value:"# добавить в конец с новой строки"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:r},children:[{type:b,value:"# \u002Fdev\u002Fsda2"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:Z}]},{type:a,tag:c,props:{class:q},children:[{type:b,value:w}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"6a1059e2-6fd0-"}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"4894"}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"-bb14-53ff59754145"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:"    none           swap    defaults    "}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:x}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:x}]}]}]}]}]},{type:a,tag:v,props:{id:cc},children:[{type:b,value:cd}]},{type:a,tag:l,props:{},children:[{type:b,value:"Отредактируйте файл "},{type:a,tag:I,props:{},children:[{type:b,value:"\u002Fetc\u002Fiscsi\u002Fiscsid.conf"}]},{type:b,value:", как указано в help "},{type:a,tag:z,props:{href:"https:\u002F\u002Fdocs.oracle.com\u002Fen-us\u002Fiaas\u002FContent\u002FBlock\u002FConcepts\u002Fiscsiinformation.htm",rel:[B]},children:[{type:b,value:"iscsiinformation.htm"}]},{type:b,value:". На вкладке boot volumes можно создать дополнительный диск, клонировать существующий. После этого добавить на машине в автостарт и запустить сервис."}]},{type:a,tag:k,props:{code:"sudo systemctl enable --now iscsid\n# включаем авторизацию\nsudo systemctl enable iscsi\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:y}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:D}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:W}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"--now"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"iscsid"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:r},children:[{type:b,value:"# включаем авторизацию"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:y}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:D}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:W}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"iscsi"}]}]}]}]}]},{type:a,tag:l,props:{},children:[{type:b,value:"Зайти в свой Instances и в левом меню на вкладку Attached Block Volumes, присоединить клонированный диск, когда он перейдет в состояние Attached в правом меню открыть пункт iSCSI Commands & Information. Скопировать 3 команды(iscsiadm) на подключение и выполнить их на своей машине(по строчно) от пользователя."}]},{type:a,tag:l,props:{},children:[{type:b,value:"В поле ниже, соответственно команды на отключение."}]},{type:a,tag:k,props:{code:b_,language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:P}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:E}]}]}]}]}]},{type:a,tag:l,props:{},children:[{type:b,value:"Форматируем данный диск на свое усмотрение и прописываем, если нужно в fstab."}]},{type:a,tag:k,props:{code:"# создаем таблицу и раздел\u002Fразделы\nsudo cfdisk -z \u002Fdev\u002Fsdb\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:r},children:[{type:b,value:"# создаем таблицу и раздел\u002Fразделы"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:y}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"cfdisk"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"-z"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\u002Fdev\u002Fsdb"}]}]}]}]}]},{type:a,tag:l,props:{},children:[{type:b,value:"Я выбрал gpt, затем создал раздел по умолчанию на все пространство(46,6G), enter - enter - enter, курсор вправо(записать) - yes - enter, курсор влево(выход). Форматируем в ext4 с меткой files."}]},{type:a,tag:k,props:{code:"sudo mkfs.ext4 \u002Fdev\u002Fsdb1 -L files\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:y}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"mkfs.ext4"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\u002Fdev\u002Fsdb1"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:al}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"files"}]}]}]}]}]},{type:a,tag:l,props:{},children:[{type:b,value:"Добавляю в fstab."}]},{type:a,tag:k,props:{code:"sudo mkdir -p \u002Fmedia\u002Ffiles\nlsblk -f\nsudo nano \u002Fetc\u002Ffstab\n\n# \u002Fdev\u002Fsdb1\nUUID=702c830e-efb9-403d-bdfc-b3a969d44b1f    \u002Fmedia\u002Ffiles   ext4    defaults,_netdev,x-systemd.requires=iscsid.service  0 1\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:y}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:am}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:V}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:aC}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:P}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:E}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:y}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:K}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:aB}]}]},{type:a,tag:g,props:{class:h},children:[]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:r},children:[{type:b,value:"# \u002Fdev\u002Fsdb1"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:Z}]},{type:a,tag:c,props:{class:q},children:[{type:b,value:w}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"702c830e-efb9-403d-bdfc-b3a969d44b1f"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:"    \u002Fmedia\u002Ffiles   ext4    defaults,_netdev,x-systemd.requires"}]},{type:a,tag:c,props:{class:q},children:[{type:b,value:w}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"iscsid.service"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:"  "}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:x}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"1"}]}]}]}]}]},{type:a,tag:l,props:{},children:[{type:b,value:"Перезагружаюсь и вижу по пути "},{type:a,tag:I,props:{},children:[{type:b,value:aC}]},{type:b,value:" чистый раздел, под любые нужды."}]},{type:a,tag:k,props:{code:"sudo systemctl reboot\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:y}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:D}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:at}]}]}]}]}]},{type:a,tag:l,props:{},children:[{type:b,value:"Дадим полные права в директорию для юзера."}]},{type:a,tag:k,props:{code:"sudo chown -R $(whoami):users \u002Fmedia\u002Ffiles\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:y}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"chown"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:as}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"$("}]},{type:a,tag:c,props:{class:i},children:[{type:b,value:"whoami"}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"):users"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:aC}]}]}]}]}]},{type:a,tag:$,props:{},children:[{type:a,tag:l,props:{},children:[{type:b,value:"Вы наверно догадались, что можно было сразу подключить второй диск и развернуть на него, тем самым опустить момент с переносом раздела(rsync), я это специально сделал, чтобы показать больше."}]}]},{type:a,tag:v,props:{id:ce},children:[{type:b,value:cf}]},{type:a,tag:Y,props:{id:cg},children:[{type:b,value:ch}]},{type:a,tag:k,props:{code:"sudo nano \u002Fetc\u002Fsystemd\u002Fjournald.conf\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:y}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:K}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\u002Fetc\u002Fsystemd\u002Fjournald.conf"}]}]}]}]}]},{type:a,tag:l,props:{},children:[{type:b,value:"Раскомментировать и изменить строку."}]},{type:a,tag:k,props:{code:"SystemMaxUse=100M\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:"SystemMaxUse"}]},{type:a,tag:c,props:{class:q},children:[{type:b,value:w}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"100M"}]}]}]}]}]},{type:a,tag:l,props:{},children:[{type:b,value:"Перезапустите сервис."}]},{type:a,tag:k,props:{code:"sudo systemctl restart systemd-journald.service\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:y}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:D}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"restart"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"systemd-journald.service"}]}]}]}]}]},{type:a,tag:Y,props:{id:ci},children:[{type:b,value:cj}]},{type:a,tag:k,props:{code:"df -h \u002Ftmp\n\nsudo mount -o remount,size=2G \u002Ftmp\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:"df"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:ck}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:cl}]}]},{type:a,tag:g,props:{class:h},children:[]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:y}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:C}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:F}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"remount,size=2G"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:cl}]}]}]}]}]},{type:a,tag:Y,props:{id:ad},children:[{type:b,value:cm}]},{type:a,tag:l,props:{},children:[{type:b,value:"Это полезно при обновлении ядра, можно очень быстро перезагрузить его, не дожидаясь завершения всего процесса загрузки BIOS. Наглядно видно, при доступном обновление ядра "},{type:a,tag:z,props:{href:"https:\u002F\u002Fwiki.archlinux.org\u002Findex.php\u002FKexec",rel:[B]},children:[{type:b,value:"wiki.archlinux.org\u002Findex.php\u002FKexec"}]},{type:b,value:O}]},{type:a,tag:k,props:{code:"yay -S kexec-tools\n# версия ядра\nuname -a\n# полное обновление\nyay -Syyuu\n# загрузка нового ядра\nsudo kexec -l \u002Fboot\u002Fvmlinuz-linux-lts --initrd=\u002Fboot\u002Finitramfs-linux-lts.img --reuse-cmdline\n# частичный ребут\nsudo systemctl kexec\n# справка\nsudo kexec -h\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:cn}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"-S"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"kexec-tools"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:r},children:[{type:b,value:"# версия ядра"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:"uname"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:ak}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:r},children:[{type:b,value:"# полное обновление"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:cn}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"-Syyuu"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:r},children:[{type:b,value:"# загрузка нового ядра"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:y}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:ad}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:bl}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"\u002Fboot\u002Fvmlinuz-linux-lts"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"--initrd=\u002Fboot\u002Finitramfs-linux-lts.img"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"--reuse-cmdline"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:r},children:[{type:b,value:"# частичный ребут"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:y}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:D}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:ad}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:r},children:[{type:b,value:"# справка"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:y}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:ad}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:ck}]}]}]}]}]},{type:a,tag:Y,props:{id:co},children:[{type:b,value:cp}]},{type:a,tag:l,props:{},children:[{type:b,value:"Можно отключить раздел swap и использовать файл на 4G в btrfs."}]},{type:a,tag:k,props:{code:"truncate -s 0 \u002Fswapfile\nchattr +C \u002Fswapfile\nbtrfs property set \u002Fswapfile compression none\nfallocate \u002Fswapfile -l4g\nchmod 600 \u002Fswapfile\nmkswap \u002Fswapfile\nlsattr \u002Fswapfile\nswapon \u002Fswapfile\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:"truncate"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:an}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:x}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:J}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:"chattr"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"+C"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:J}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:R}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"property"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"set"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:J}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"compression"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:cq}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:"fallocate"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:J}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"-l4g"}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:"chmod"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:"600"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:J}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:cb}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:J}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:"lsattr"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:J}]}]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:aA}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:J}]}]}]}]}]},{type:a,tag:l,props:{},children:[{type:b,value:"Закомментировать раздел swap и добавить строку с файлом."}]},{type:a,tag:k,props:{code:"sudo nano \u002Fetc\u002Ffstab\n\n\u002Fswapfile      none      swap      defaults    0 0\n",language:n,meta:o},children:[{type:a,tag:p,props:{},children:[{type:a,tag:k,props:{__ignoreMap:m},children:[{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:y}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:K}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:aB}]}]},{type:a,tag:g,props:{class:h},children:[]},{type:a,tag:g,props:{class:h},children:[{type:a,tag:c,props:{class:i},children:[{type:b,value:J}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:aD}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:cq}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:aD}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"swap"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:aD}]},{type:a,tag:c,props:{class:f},children:[{type:b,value:"defaults"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:"    "}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:x}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:e}]},{type:a,tag:c,props:{class:j},children:[{type:b,value:x}]}]}]}]}]},{type:a,tag:Y,props:{id:cr},children:[{type:b,value:cs}]},{type:a,tag:ae,props:{},children:[{type:a,tag:H,props:{},children:[{type:a,tag:z,props:{href:"\u002Fposts\u002Fzsh-config"},children:[{type:b,value:"Настройка zsh"}]}]},{type:a,tag:H,props:{},children:[{type:a,tag:z,props:{href:"https:\u002F\u002Fgithub.com\u002Fcreio\u002Fdots",rel:[B]},children:[{type:b,value:"Еще некоторые конфиги и скрипты в моем репозитории"}]}]},{type:a,tag:H,props:{},children:[{type:a,tag:z,props:{href:"\u002Fposts\u002Fvpn"},children:[{type:b,value:"VPN сервер в Linux"}]}]}]},{type:a,tag:v,props:{id:ct},children:[{type:b,value:cu}]},{type:a,tag:l,props:{},children:[{type:b,value:"Таким способом можно переделать любую систему и практически на любом облачном решении, главное знать детали загрузки и хорошо бы иметь ssh подключение выше, как тут (Console connection), или некий режим восстановления. Если Вам понравился мой бред:) по этому поводу, то поблагодарить меня можно тут."}]},{type:a,tag:ae,props:{},children:[{type:a,tag:H,props:{},children:[{type:a,tag:z,props:{href:"https:\u002F\u002Fctlos.github.io\u002Fdonat\u002F",rel:[B]},children:[{type:b,value:"ctlos.github.io\u002Fdonat"}]}]},{type:a,tag:H,props:{},children:[{type:b,value:"Вступай в чат "},{type:a,tag:z,props:{href:"https:\u002F\u002Ftelegram.me\u002Fctlos",rel:[B]},children:[{type:b,value:"@ctlos"}]}]}]},{type:a,tag:l,props:{},children:[{type:b,value:"Всем Добра."}]},{type:a,tag:"style",children:[{type:b,value:".ct-3d5b48{color:#FF7B72}\n.ct-667c91{color:#8B949E}\n.ct-8a2173{color:#A5D6FF}\n.ct-4ee302{color:#79C0FF}\n.ct-402795{color:#C9D1D9}\n.ct-068da8{color:#FFA657}"}]}],toc:{title:m,searchDepth:u,depth:u,links:[{id:aG,depth:u,text:aH},{id:aI,depth:u,text:aJ},{id:aK,depth:u,text:aL},{id:aT,depth:u,text:aU},{id:bj,depth:u,text:bk},{id:bn,depth:u,text:bo},{id:br,depth:u,text:bs},{id:ao,depth:u,text:bw},{id:bx,depth:u,text:by},{id:bB,depth:u,text:bC},{id:bD,depth:u,text:bE},{id:X,depth:u,text:bK,children:[{id:bM,depth:_,text:bN}]},{id:bQ,depth:u,text:bR},{id:bW,depth:u,text:bX},{id:bY,depth:u,text:bZ},{id:b$,depth:u,text:ca},{id:cc,depth:u,text:cd},{id:ce,depth:u,text:cf,children:[{id:cg,depth:_,text:ch},{id:ci,depth:_,text:cj},{id:ad,depth:_,text:cm},{id:co,depth:_,text:cp},{id:cr,depth:_,text:cs}]},{id:ct,depth:u,text:cu}]}},_type:cv,_id:"content:posts:oci.md",_source:"content",_file:"posts\u002Foci.md",_extension:"md"}},state:{$sicons:{"ri:moon-clear-fill":{left:s,top:s,width:M,height:M,rotate:s,vFlip:t,hFlip:t,body:"\u003Cpath fill=\"currentColor\" d=\"M9.822 2.238a9 9 0 0 0 11.94 11.94C20.768 18.654 16.775 22 12 22C6.477 22 2 17.523 2 12c0-4.775 3.346-8.768 7.822-9.762Zm8.342.053L19 2.5v1l-.836.209a2 2 0 0 0-1.455 1.455L16.5 6h-1l-.209-.836a2 2 0 0 0-1.455-1.455L13 3.5v-1l.836-.209A2 2 0 0 0 15.29.836L15.5 0h1l.209.836a2 2 0 0 0 1.455 1.455Zm5 5L24 7.5v1l-.836.209a2 2 0 0 0-1.455 1.455L21.5 11h-1l-.209-.836a2 2 0 0 0-1.455-1.455L18 8.5v-1l.836-.209a2 2 0 0 0 1.455-1.455L20.5 5h1l.209.836a2 2 0 0 0 1.455 1.455Z\"\u002F\u003E"},"ph:github-logo-bold":{left:s,top:s,width:N,height:N,rotate:s,vFlip:t,hFlip:t,body:"\u003Cpath fill=\"currentColor\" d=\"M212.62 75.17A63.7 63.7 0 0 0 206.39 26A12 12 0 0 0 196 20a63.71 63.71 0 0 0-50 24h-20a63.71 63.71 0 0 0-50-24a12 12 0 0 0-10.39 6a63.7 63.7 0 0 0-6.23 49.17A61.5 61.5 0 0 0 52 104v8a60.1 60.1 0 0 0 45.76 58.28A43.66 43.66 0 0 0 92 192v4H76a20 20 0 0 1-20-20a44.05 44.05 0 0 0-44-44a12 12 0 0 0 0 24a20 20 0 0 1 20 20a44.05 44.05 0 0 0 44 44h16v12a12 12 0 0 0 24 0v-40a20 20 0 0 1 40 0v40a12 12 0 0 0 24 0v-40a43.66 43.66 0 0 0-5.76-21.72A60.1 60.1 0 0 0 220 112v-8a61.5 61.5 0 0 0-7.38-28.83ZM196 112a36 36 0 0 1-36 36h-48a36 36 0 0 1-36-36v-8a37.87 37.87 0 0 1 6.13-20.12a11.65 11.65 0 0 0 1.58-11.49a39.9 39.9 0 0 1-.4-27.72a39.87 39.87 0 0 1 26.41 17.8a12 12 0 0 0 10.1 5.53h32.35a12 12 0 0 0 10.11-5.53a39.84 39.84 0 0 1 26.41-17.8a39.9 39.9 0 0 1-.4 27.72a12 12 0 0 0 1.61 11.53A37.85 37.85 0 0 1 196 104Z\"\u002F\u003E"},"ph:telegram-logo-bold":{left:s,top:s,width:N,height:N,rotate:s,vFlip:t,hFlip:t,body:"\u003Cpath fill=\"currentColor\" d=\"M239.49 23.16a13 13 0 0 0-13.23-2.26L23.6 100.21a18.22 18.22 0 0 0 3.12 34.86L76 144.74V200a20 20 0 0 0 34.4 13.88l22.67-23.51L170.35 223a20 20 0 0 0 32.7-10.54l40.62-176.55a13 13 0 0 0-4.18-12.75Zm-92.08 54.36l-62.19 44.57l-34.43-6.75ZM100 190.06v-28.71l15 13.15Zm81.16 10.52l-73.88-64.77l106.31-76.18Z\"\u002F\u003E"},"ph:youtube-logo-bold":{left:s,top:s,width:N,height:N,rotate:s,vFlip:t,hFlip:t,body:"\u003Cpath fill=\"currentColor\" d=\"m170.49 117.91l-56-36A12 12 0 0 0 96 92v72a12 12 0 0 0 18.49 10.09l56-36a12 12 0 0 0 0-20.18ZM120 142v-28l21.81 14Zm118.21-73.5a28.05 28.05 0 0 0-16.93-19.14C186.4 35.91 131.29 36 128 36s-58.4-.09-93.28 13.38a28.05 28.05 0 0 0-16.93 19.14C15.15 78.72 12 97.32 12 128s3.15 49.28 5.79 59.48a28.05 28.05 0 0 0 16.93 19.14C68.21 219.55 120.36 220 127.37 220h1.26c7 0 59.16-.45 92.65-13.38a28.05 28.05 0 0 0 16.93-19.14c2.64-10.2 5.79-28.8 5.79-59.48s-3.15-49.28-5.79-59.48ZM215 181.46a4 4 0 0 1-2.34 2.77C182.78 195.76 132.27 196 128.32 196h-.39c-.53 0-53.64.17-84.56-11.77a4 4 0 0 1-2.37-2.77c-1.88-7.24-5-23.82-5-53.46s3.15-46.22 5-53.46a4 4 0 0 1 2.34-2.77C74.29 59.83 127.39 60 127.92 60h.15c.54 0 53.64-.17 84.56 11.77a4 4 0 0 1 2.37 2.77c1.88 7.24 5 23.82 5 53.46s-3.15 46.22-5 53.46Z\"\u002F\u003E"},"akar-icons:vk-fill":{left:s,top:s,width:M,height:M,rotate:s,vFlip:t,hFlip:t,body:"\u003Cpath fill=\"currentColor\" fill-rule=\"evenodd\" d=\"M23.45 5.948c.166-.546 0-.948-.795-.948H20.03c-.668 0-.976.347-1.143.73c0 0-1.335 3.196-3.226 5.272c-.612.602-.89.793-1.224.793c-.167 0-.418-.191-.418-.738V5.948c0-.656-.184-.948-.74-.948H9.151c-.417 0-.668.304-.668.593c0 .621.946.765 1.043 2.513v3.798c0 .833-.153.984-.487.984c-.89 0-3.055-3.211-4.34-6.885C4.45 5.288 4.198 5 3.527 5H.9c-.75 0-.9.347-.9.73c0 .682.89 4.07 4.145 8.551C6.315 17.341 9.37 19 12.153 19c1.669 0 1.875-.368 1.875-1.003v-2.313c0-.737.158-.884.687-.884c.39 0 1.057.192 2.615 1.667C19.11 18.216 19.403 19 20.405 19h2.625c.75 0 1.126-.368.91-1.096c-.238-.724-1.088-1.775-2.215-3.022c-.612-.71-1.53-1.475-1.809-1.858c-.389-.491-.278-.71 0-1.147c0 0 3.2-4.426 3.533-5.929Z\" clip-rule=\"evenodd\"\u002F\u003E"},"ph:arrow-up":{left:s,top:s,width:N,height:N,rotate:s,vFlip:t,hFlip:t,body:"\u003Cpath fill=\"currentColor\" d=\"M205.66 117.66a8 8 0 0 1-11.32 0L136 59.31V216a8 8 0 0 1-16 0V59.31l-58.34 58.35a8 8 0 0 1-11.32-11.32l72-72a8 8 0 0 1 11.32 0l72 72a8 8 0 0 1 0 11.32Z\"\u002F\u003E"},"ri:arrow-left-line":{left:s,top:s,width:M,height:M,rotate:s,vFlip:t,hFlip:t,body:"\u003Cpath fill=\"currentColor\" d=\"M7.828 11H20v2H7.828l5.364 5.364l-1.414 1.414L4 12l7.778-7.778l1.414 1.414L7.828 11Z\"\u002F\u003E"},"ri:arrow-right-line":{left:s,top:s,width:M,height:M,rotate:s,vFlip:t,hFlip:t,body:"\u003Cpath fill=\"currentColor\" d=\"m16.172 11l-5.364-5.364l1.414-1.414L20 12l-7.778 7.778l-1.414-1.414L16.172 13H4v-2h12.172Z\"\u002F\u003E"}}},_errors:{"content-/posts/oci":o},serverRendered:aE,prerenderedAt:1682086370188,config:{public:{siteHost:"creio.github.io",siteUrl:"https:\u002F\u002Fcreio.github.io",siteTitle:"Alex Creio",siteDesc:"Personal website & blog. Web developer & linux enthusiast.",profileImage:"\u002Fimages\u002Fprofile.png",cover:"\u002Fcover.png",themeSwitcher:aE,socials:{github:ai,telegram:"cretm",youtube:"creioyt",vk:ai},content:{locales:[],defaultLocale:m,integrity:1682086344496,experimental:{stripQueryParameters:t,clientDB:t},api:{baseURL:"\u002Fapi\u002F_content"},navigation:{fields:[]},tags:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"prose-code",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"},highlight:{theme:"github-dark",preload:["json","js","ts","html","css","vue","diff","shell",cv,"yaml",n,"ini"]},wsUrl:m,documentDriven:t,host:m,trailingSlash:t,anchorLinks:aE}},app:{baseURL:aj,buildAssetsDir:"\u002F_nuxt\u002F",cdnURL:m}}}}("element","text","span","ct-402795"," ","ct-8a2173","div","line","ct-068da8","ct-4ee302","code","p","","bash",null,"pre","ct-3d5b48","ct-667c91",0,false,2,"h2","=","0","sudo","a","\u002Fmnt","nofollow","mount","systemctl","-f","-o",",","li","code-inline","\u002Fswapfile","nano","echo",24,256,".","lsblk","\u002Fdev\u002Fsda2","btrfs","subvolume","create","umount","-p","enable","ssh","h3","UUID",3,"blockquote","\u003E","cat","\u002Fdev\u002Fsda3","kexec","ul","pacman-key","\u002Fdev\u002Fsda1","\u003E\u003E","creio","\u002F","-a","-L","mkdir","-s","mkinitcpio","\u002Fboot\u002Fgrub\u002Fgrub.cfg","yes","exit","-R","reboot","# \u002Fdev\u002Fsda3","39b2a28d-","3890","-425b-","8152","-fed18a73fdcd","swapon","\u002Fetc\u002Ffstab","\u002Fmedia\u002Ffiles","      ",true,"root","генерация-ключей","Генерация ключей","oracle-cloud","Oracle Cloud","arch-bootstrap","Arch bootstrap","wget","*","ls","--init","--populate","pacman","-Syy","монтирование-pacstrap","Монтирование pacstrap","mkfs.btrfs","\"root\"","\u002Fmnt\u002F@","\u002Fmnt\u002F@home","\u002Fmnt\u002F@snapshots","subvol=@,compress=lzo,relatime,space_cache,autodefrag","\u002Fmnt\u002F{boot\u002Fefi,home,snapshots}","subvol=@home,compress=lzo,relatime,space_cache,autodefrag","\u002Fmnt\u002Fhome","subvol=@snapshots,compress=lzo,relatime,space_cache,autodefrag","\u002Fmnt\u002Fsnapshots","\u002Fmnt\u002Fboot\u002Fefi","base","reflector","rsync","arch-chroot","init-pacman","Init pacman","-l","30","добавление-пользователя","Добавление пользователя","usermod","123","системные-настройки","Системные настройки","ln","\u002Fetc\u002Flocale.gen","\u002Fetc\u002Fvconsole.conf","Mkinitcpio","создаем-hosts","Создаем hosts","\u003C\u003C","EOF","включаем-интернет","Включаем интернет","устанавливаем-grub","Устанавливаем grub","grub-install","--target=x86_64-efi","--efi-directory=\u002Fboot\u002Fefi","grub-mkconfig","\u002Fboot\u002Fefi\u002Fstartup.nsh","Ssh","ssh -o ProxyCommand","efishell","Efishell","bcfg","boot","авторизация","Авторизация",".ssh\u002Fid_rsa.pub","|","'mkdir -p ~\u002F.ssh && cat \u003E\u003E .ssh\u002Fauthorized_keys'","creio@192.168.1.35","перенос","Перенос","fstab","Fstab","lsblk -f\n","chroot","Chroot","mkswap","дополнительный-диск","Дополнительный диск","рекомендации","Рекомендации","уменьшение-журнала-systemd","Уменьшение журнала Systemd","увеличить-tmp","Увеличить \u002Ftmp","-h","\u002Ftmp","Kexec","yay","swapfile","Swapfile","none","ссылки","Ссылки","итог","Итог","markdown"))</script><script type="module" src="/_nuxt/entry.2032ada5.js" crossorigin></script></body>
</html>